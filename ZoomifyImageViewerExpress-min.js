/*
 Zoomify Image Viewer, version on line 25 below. Copyright Zoomify, Inc., 1999-2018. All rights reserved. You may
use this file on private and public websites, for personal and commercial purposes, with or without modifications, so long as this
notice is included. Redistribution via other means is not permitted without prior permission. Additional terms apply. For complete
license terms please see the Zoomify License Agreement in this product and on the Zoomify website at www.zoomify.com.
::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
*/
(function(){(function(){return this}).call().Z={}})();Z.version="5.23 Express";Z.setCallback=function(a,b){"undefined"===typeof Z.callbacks&&(Z.callbacks=[]);var c=Z.Utils.arrayIndexOfObjectTwoValues(Z.callbacks,"callbackName",a,null,"callbackFunction",b);-1==c&&(c=Z.callbacks.length);Z.callbacks[c]={callbackName:a,callbackFunction:b}};
Z.showImage=function(a,b,c){if(Z.showImage.done)Z.Utils.declareGlobals(),Z.pageContainerID=a,"undefined"!==typeof b&&Z.Utils.stringValidate(b)?Z.imagePath=Z.Utils.stringRemoveTrailingSlash(b):Z.imagePath=null,"undefined"!==typeof c&&(Z.parameters=Z.Utils.parseParameters(c)),Z.initialize();else{Z.showImage.done=!0;Z.Utils.addCrossBrowserMethods();Z.Utils.addCrossBrowserEvents();Z.Utils.declareGlobals();Z.pageContainerID=a;Z.setEditPermissionFunction=function(a){Z.externalEditPermissionFunction=a};
Z.clearCallback=function(a,b){var c=Z.Utils.arrayIndexOfObjectTwoValues(Z.callbacks,"callbackName",a,null,"callbackFunction",b);-1!=c&&(Z.callbacks=Z.Utils.arraySplice(Z.callbacks,c,1))};a="undefined"!==typeof b&&Z.Utils.stringValidate(b);var d="undefined"!==typeof c&&("string"===typeof c&&-1!=c.indexOf("zIIIFServer")||"object"===typeof c&&"undefined"!==typeof c.zIIIFServer);a&&-1!=b.indexOf("zXMLParametersPath")?(b=b.substring(19,b.length),Z.xmlParametersPath=Z.Utils.stringRemoveTrailingSlash(b)):
Z.imagePath=d?"IIIFImageServer":a?Z.Utils.stringRemoveTrailingSlash(b):null;"undefined"!==typeof c&&("string"===typeof c&&(c=unescape(c),c=Z.Utils.stringUnescapeAmpersandCharacters(c)),Z.parameters=Z.Utils.parseParameters(c));"complete"!=document.readyState?(Z.Utils.addEventListener(document,"DOMContentLoaded",Z.initialize),Z.Utils.addEventListener(window,"load",Z.initialize)):Z.initialize()}};
Z.initialize=function(){Z.Utils.removeEventListener(document,"DOMContentLoaded",Z.initialize);Z.Utils.removeEventListener(window,"load",Z.initialize);Z.Utils.detectBrowserFeatures();Z.pageContainer=document.getElementById(Z.pageContainerID);Z.xmlParametersPath&&!Z.parameters?Z.loadParametersXML():null!==Z.parameters&&"undefined"!==typeof Z.parameters.zXMLParametersPath?Z.Utils.setParameters(Z.parameters):(Z.Utils.setParameters(Z.parameters),(!Z.localUse||"ZoomifyZIFFile"!=Z.tileSource&&"ZoomifyPFFFile"!=
Z.tileSource)&&Z.createViewer(),1!=Z.debug&&2!=Z.debug&&3!=Z.debug||Z.Utils.trace(Z.Utils.getResource("z445"),!1,!0))};Z.createViewer=function(){Z.Viewer=new Z.ZoomifyImageViewer;Z.Viewer.configureViewer()};Z.loadParametersXML=function(){Z.xmlParametersParsing=!0;var a=new Z.NetConnector,b=Z.Utils.cacheProofPath(Z.xmlParametersPath);a.loadXML(b,null,"loadingParametersXML")};
Z.ZoomifyImageViewer=function(){function a(a,b){"undefined"!==typeof a&&Z.Utils.stringValidate(a)||(a=Z.helpPath);"undefined"!==typeof b&&Z.Utils.stringValidate(b)||(b="helpCustom");(new Z.NetConnector).loadHTML(a,t.receiveHelpHTML,null,"loadingHelpHTML-"+b)}function b(a){if(a=Z.Utils.event(a)){var b=null;if(null!==Z.editing&&Z.Viewport.verifyEditsUnsaved())return b=Z.Utils.getResource("ALERT_UNSAVEDEDITSEXIST-BROWSER"),a.returnValue=b}}function c(){document.getElementsByTagName("body")?document.getElementsByTagName("body")[0].onorientationchange=
d:window.setTimeout(c,100)}function d(a){Z.interactive&&Z.fullView&&(Z.Toolbar&&(Z.toolbarAutoShowHide&&Z.Toolbar.show(!1),!Z.annotations||2!=Z.annotationPanelVisible&&3!=Z.annotationPanelVisible||Z.Toolbar.setVisibilityAnnotationPanel(!1),!Z.tracking||2!=Z.trackingPanelVisible&&3!=Z.trackingPanelVisible||Z.Toolbar.setVisibilityTrackingPanel(!1),2!=Z.userPanelVisible&&3!=Z.userPanelVisible||Z.Toolbar.setVisibilityUserPanel(!1)),Z.Navigator&&1<Z.navigatorVisible&&(Z.Navigator.setVisibility(!1),Z.comparison&&
Z.Navigator2&&Z.Navigator2.setVisibility(!1)),Z.Gallery&&Z.galleryAutoShowHide&&Z.Gallery.setVisibility(!1),Z.Viewport&&1<Z.magnifierVisible&&Z.Viewport.setVisibilityMagnifier(!1),Z.Viewport&&(Z.Viewport.toggleFullViewMode(!1),Z.Viewport.toggleFullViewMode(!0)),Z.Viewport&&1<Z.magnifierVisible&&Z.Viewport.setVisibilityMagnifier(!0),Z.Gallery&&Z.galleryAutoShowHide&&Z.Gallery.setVisibility(!0),Z.Navigator&&1<Z.navigatorVisible&&(Z.Navigator.setVisibility(!0),Z.comparison&&Z.Navigator2&&Z.Navigator2.setVisibility(!0)),
Z.Toolbar&&(!Z.annotations||2!=Z.annotationPanelVisible&&3!=Z.annotationPanelVisible||Z.Toolbar.setVisibilityAnnotationPanel(!0),!Z.tracking||2!=Z.trackingPanelVisible&&3!=Z.trackingPanelVisible||Z.Toolbar.setVisibilityTrackingPanel(!0),2!=Z.userPanelVisible&&3!=Z.userPanelVisible||Z.Toolbar.setVisibilityUserPanel(!0),Z.toolbarAutoShowHide&&Z.Toolbar.show(!0)))}function e(a){if(Z.interactive&&Z.keys&&"INPUT"!=document.activeElement.tagName&&"TEXTAREA"!=document.activeElement.tagName){a=Z.Utils.event(a);
var b=a.altKey;18==a.keyCode||a.altKey||(Z.viewportCurrent.zoomAndPanAllStop(!0,!0),Z.maskingSelection&&Z.viewportCurrent.clearMask());if(a){var c=a.type,d=a.keyCode;if("keydown"==c){Z.keyIsDown=!0;switch(d){case 90:Z.viewportCurrent.zoom("out");break;case 17:"macintosh"!=Z.platform&&Z.viewportCurrent.zoom("out");break;case 65:Z.viewportCurrent.zoom("in");break;case 16:"macintosh"!=Z.platform&&Z.viewportCurrent.zoom("in");break;case 37:!Z.tracking&&!Z.animation||Z.viewportCurrent.getZoom()!=Z.minZ?
Z.viewportCurrent.pan("left"):Z.imageSet&&t.viewportPrior();break;case 38:!Z.tracking&&!Z.animation||Z.viewportCurrent.getZoom()!=Z.minZ?Z.viewportCurrent.pan("up"):Z.imageSet&&t.viewportNext();break;case 40:!Z.tracking&&!Z.animation||Z.viewportCurrent.getZoom()!=Z.minZ?Z.viewportCurrent.pan("down"):Z.imageSet&&t.viewportPrior();break;case 39:!Z.tracking&&!Z.animation||Z.viewportCurrent.getZoom()!=Z.minZ?Z.viewportCurrent.pan("right"):Z.imageSet&&t.viewportNext();break;case 27:Z.fullView?Z.viewportCurrent.toggleFullViewMode(!1):
Z.viewportCurrent.reset();break;case 190:Z.rotationVisible&&Z.viewportCurrent.rotate("clockwise",b);break;case 188:Z.rotationVisible&&Z.viewportCurrent.rotate("counterwise",b);break;case 33:Z.imageSet&&!Z.overlays&&t.viewportNext();break;case 34:Z.imageSet&&!Z.overlays&&t.viewportPrior();break;case 76:b&&(Z.hotspots||Z.annotations)&&Z.viewportCurrent.setHotspotsVisibility(!Z.viewportCurrent.getHotspotsVisibility())}!Z.imageSet||33!=d&&34!=d||(a.preventDefault?a.preventDefault():a.returnValue=!1)}else"keyup"==
c&&(Z.keyIsDown=!1,90==d||17==d||65==d||16==d?Z.viewportCurrent.zoom("stop"):37==d||39==d||38==d||40==d?Z.tracking?37==d?Z.viewportCurrent.goToNextCell("left"):39==d?Z.viewportCurrent.goToNextCell("right"):38==d?Z.viewportCurrent.goToNextCell("up"):40==d&&Z.viewportCurrent.goToNextCell("down"):37==d||39==d?Z.viewportCurrent.pan("horizontalStop"):38!=d&&40!=d||Z.viewportCurrent.pan("verticalStop"):!Z.rotationVisible||190!=d&&188!=d?!Z.imageSet||33!=d&&34!=d?32==d?(Z.fullViewVisible||Z.fullScreenVisible||
Z.fullPageVisible)&&Z.viewportCurrent.toggleFullViewMode():46==d&&null!==Z.editMode&&(Z.annotations||Z.tracking)&&Z.viewportCurrent.deleteCurrentLabel():(Z.imageSet&&Z.viewportCurrent.updateView(!0),a.preventDefault?a.preventDefault():a.returnValue=!1):Z.viewportCurrent.rotate("stop"))}}}function f(a){a=Z.Utils.event(a);var b=a.type;if(a&&b){var c=Z.Utils.isRightMouseButton(a),d=a.altKey;if(!("mouseover"!=b&&"mouseout"!=b&&!Z.interactive||"mousedown"==b&&(!Z.interactive||Z.coordinatesVisible&&d)||
c)){Z.touchSupport&&!Z.clickZoomAndPanBlock&&"touchmove"!=b&&"gesturechange"!=b&&a.preventDefault();switch(b){case "mouseover":Z.fullView||"TEXTAREA"==document.activeElement.tagName||"narrativeTextBox"===document.activeElement.id||Z.Viewer.initializeViewerKeyDefaultListeners(!0);break;case "mouseout":Z.tracking||Z.Viewer.initializeViewerKeyDefaultListeners(!1)}var e;e=Z.Utils.event(a);var f=e.type;if(e&&f){var A;a=Z.Utils.target(e);c=Z.Utils.relatedTarget(e);"resize"!=f&&(A=Z.Utils.getMousePosition(e));
d=e.altKey;"DOMMouseScroll"==f&&(f="mousewheel");switch(f){case "mouseover":d=Z.Utils.nodeIsInViewer(a);e=Z.Utils.nodeIsInViewer(c);d&&e||"[object HTMLSelectElement]"==a||"[object HTMLOptionElement]"==a||"[object HTMLSelectElement]"==c||"[object HTMLOptionElement]"==c||(!Z.viewportCurrent||Z.narrative&&!Z.narrativeMode||Z.viewportCurrent.showLists(!0),Z.ToolbarDisplay&&Z.Toolbar&&Z.toolbarAutoShowHide&&Z.Toolbar.show(!0),Z.Navigator&&1<Z.navigatorVisible&&(Z.Navigator.setVisibility(!0),Z.comparison&&
Z.Navigator2&&Z.Navigator2.setVisibility(!0)),Z.Gallery&&Z.galleryAutoShowHide&&Z.Gallery.setVisibility(!0),Z.Ruler&&1<Z.rulerVisible&&Z.Ruler.setVisibility(!0),Z.Toolbar&&(!Z.annotations||2!=Z.annotationPanelVisible&&3!=Z.annotationPanelVisible||Z.Toolbar.setVisibilityAnnotationPanel(!0),!Z.tracking||2!=Z.trackingPanelVisible&&3!=Z.trackingPanelVisible||Z.Toolbar.setVisibilityTrackingPanel(!0),2!=Z.userPanelVisible&&3!=Z.userPanelVisible||Z.Toolbar.setVisibilityUserPanel(!0)),Z.viewportCurrent&&
1<Z.magnifierVisible&&Z.viewportCurrent.setVisibilityMagnifier(!0),Z.mouseOutDownPoint=null);break;case "mouseout":d=Z.Utils.nodeIsInViewer(a);e=Z.Utils.nodeIsInViewer(c);a="[object HTMLSelectElement]"==a||"[object HTMLOptionElement]"==a||"[object HTMLSelectElement]"==c||"[object HTMLOptionElement]"==c;Z.Utils.pointIsInViewer(A)||d&&e||a||(Z.mouseIsDown?Z.mouseOutDownPoint=new Z.Utils.Point(A.x,A.y):(Z.viewportCurrent&&Z.viewportCurrent.showLists(!1),Z.ToolbarDisplay&&Z.Toolbar&&Z.toolbarAutoShowHide&&
Z.Toolbar.show(!1),Z.Navigator&&1<Z.navigatorVisible&&(Z.Navigator.setVisibility(!1),Z.comparison&&Z.Navigator2&&Z.Navigator2.setVisibility(!1)),Z.Gallery&&Z.galleryAutoShowHide&&Z.Gallery.setVisibility(!1),Z.Ruler&&1<Z.rulerVisible&&Z.Ruler.setVisibility(!1),Z.Toolbar&&(!Z.annotations||2!=Z.annotationPanelVisible&&3!=Z.annotationPanelVisible||Z.Toolbar.setVisibilityAnnotationPanel(!1),!Z.tracking||2!=Z.trackingPanelVisible&&3!=Z.trackingPanelVisible||Z.Toolbar.setVisibilityTrackingPanel(!1),2!=Z.userPanelVisible&&
3!=Z.userPanelVisible||Z.Toolbar.setVisibilityUserPanel(!1)),Z.viewportCurrent&&1<Z.magnifierVisible&&Z.viewportCurrent.setVisibilityMagnifier(!1)));break;case "resize":p||(p=window.setTimeout(m,x));break;case "mousewheel":0<Z.mouseWheel&&(A=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail)),Z.viewportCurrent.mouseWheelHandler(A,d))}}if("mousedown"==b||"mousemove"==b)return!1}}}function m(){p&&(window.clearTimeout(p),p=null,u())}function u(){if(!Z.fullScreenEntering){var a=document.getElementById(Z.pageContainerID);
Z.viewerW=a.offsetWidth;Z.viewerH=a.offsetHeight;var a=Z.Utils.getContainerSize(Z.pageContainer,Z.ViewerDisplay),b=Z.viewportCurrent.calculateZoomForResize(Z.viewportCurrent.getZoom(),Z.viewerW,Z.viewerH,a.x,a.y);t.resizeViewer(a.x,a.y,b)}}var t=this,B=[];Z.ViewerDisplay=Z.Utils.createContainerElement("div","ViewerDisplay","inline-block","relative","hidden","100%","100%","0px","0px","none","0px","transparent","0px","0px","normal","pointer");Z.pageContainer=document.getElementById(Z.pageContainerID);
Z.Utils.getElementStyle(Z.pageContainer);Z.ViewerDisplay.style["-webkit-touch-callout"]="none";Z.ViewerDisplay.style["-moz-user-select"]="none";Z.ViewerDisplay.style["-khtml-user-select"]="none";Z.ViewerDisplay.style["-webkit-user-select"]="none";Z.ViewerDisplay.style["-ms-user-select"]="none";Z.ViewerDisplay.style["-o-user-select"]="none";Z.ViewerDisplay.style["user-select"]="none";var C=Z.Utils.getContainerSize(Z.pageContainer,Z.ViewerDisplay);Z.viewerW=C.x;Z.viewerH=C.y;Z.pageContainer.innerHTML=
"";Z.pageContainer.appendChild(Z.ViewerDisplay);Z.autoResize=Z.autoResize||Z.Utils.isElementFluid(Z.pageContainer);var x=parseInt(Z.Utils.getResource("DEFAULT_AUTORESIZESKIPDURATION"),10),p;Z.mouseWheelCompleteDuration=parseInt(Z.Utils.getResource("z165"),10);this.configureViewer=function(){if(!Z.Viewer.getStatus("configureCalled")){var a=function(){Z.clearCallback("readyViewer",a);Z.Utils.getMessage()!=Z.Utils.getResource("ALERT_LOADINGIMAGESET")&&Z.Utils.getMessage()!=Z.Utils.getResource("ALERT_LOADINGANNOTATIONS")||
Z.Utils.hideMessage();Z.imageSet&&!Z.comparison&&z619Delayed()},b=function(){Z.clearCallback(d,b);t.initializeViewerKeyEventListeners(!0);Z.Utils.addEventListener(Z.ViewerDisplay,"mouseover",f);Z.Utils.addEventListener(Z.ViewerDisplay,"mouseout",f);Z.Utils.addEventListener(Z.ViewerDisplay,"mousemove",Z.Utils.preventDefault);Z.Utils.addEventListener(Z.ViewerDisplay,"mousewheel",f);0<Z.mouseWheel&&Z.Utils.addEventListener(Z.ViewerDisplay,"mousewheel",Z.Utils.preventDefault);c();Z.autoResize&&Z.Utils.addEventListener(window,
"resize",Z.Viewer.viewerEventsHandler);Z.tracking&&Z.Viewer.initializeViewerKeyDefaultListeners(!0);var a=Z["Viewport"+(Z.imageSetLength-1).toString()];t.configureComponents(Z.overlays?a:Z.viewportCurrent)};Z.Viewer.setStatus("configureCalled",!0);var d=Z.imageSet?"initializedViewer":"initializedViewport";Z.setCallback(d,b);Z.setCallback("readyViewer",a);Z.imageSet||(Z.Viewport=new Z.ZoomifyViewport,Z.viewportCurrent=Z.Viewport)}};this.validateComponents=function(a){"undefined"!==typeof Z.parameters&&
null!==Z.parameters&&(Object.keys(Z.parameters),Z.Utils.clearComponent(Z.Navigator),Z.Utils.clearComponent(Z.Toolbar))};this.configureComponents=function(b){0<Z.toolbarVisible&&!Z.Toolbar&&(Z.Toolbar=new Z.ZoomifyToolbar(b));0<Z.navigatorVisible&&(Z.Navigator||(Z.Navigator=new Z.ZoomifyNavigator(b)),Z.Navigator&&Z.Navigator.z682(),Z.comparison&&!Z.Navigator2&&(Z.Navigator2=new Z.ZoomifyNavigator(Z.Viewport1)),Z.Navigator2&&Z.Navigator2.z682());0<Z.galleryVisible&&(Z.Gallery||(Z.Gallery=new Z.ZoomifyGallery(b)),
Z.Gallery&&Z.Gallery.validateGalleryGlobals());0<Z.rulerVisible&&!Z.Ruler&&(Z.Ruler=new Z.ZoomifyRuler(b));Z.helpCustom&&a()};this.loadHelp=function(b,c){a(b,c)};this.receiveHelpHTML=function(a){4==a.readyState&&200==a.status&&Z.Utils.stringValidate(a.responseText)&&a.zType&&(-1!=a.zType.indexOf("helpCustom")?(Z.helpContent=a.responseText,Z.Utils.validateCallback("helpLoadedCustom")):-1!=a.zType.indexOf("helpNarrative")&&(Z.narrativeHelpContent=a.responseText,Z.Utils.validateCallback("helpLoadedNarrative")))};
this.getVersion=function(){return Z.version};this.setSizeAndPosition=function(a,b,c,d,e){Z.viewerW=a;Z.viewerH=b;Z.ViewerDisplay.style.width=a+"px";Z.ViewerDisplay.style.height=b+"px";Z.Viewport&&Z.Viewport.getStatus("initializedViewport")&&Z.Viewport.setSizeAndPosition(a,b,0,0);var f=Z.toolbarBackgroundVisible?0:parseInt(Z.Utils.getResource("DEFAULT_TOOLBARBACKGROUNDVISIBLEADJUST"),10),f=1==Z.toolbarPosition?b-Z.toolbarH-f:0+f;Z.Toolbar&&Z.ToolbarDisplay&&Z.Toolbar.getInitialized()&&(Z.Toolbar.setSizeAndPosition(a,
null,null,f),0!=Z.toolbarVisible&&8!=Z.toolbarVisible&&Z.Toolbar.show(!0));Z.Navigator&&Z.Navigator.getInitialized()&&(Z.Navigator.setSizeAndPosition(null,null,0==Z.navigatorL?c:Z.navigatorL+Z.navigatorW>a?a-Z.navigatorW:Z.navigatorL,0!=Z.navigatorT?Z.navigatorT:d,Z.navigatorFit),1<Z.navigatorVisible&&(Z.Navigator.setVisibility(!0),Z.narrative?c=a+Z.navigatorW:Z.comparison&&Z.Navigator2&&(Z.Navigator2.setSizeAndPosition(null,null,a-Z.navigatorW,d,Z.navigatorFit),Z.Navigator2.setVisibility(!0))));
Z.imageList&&Z.Viewport.getStatus("initializedImageList")&&Z.Viewport.setSizeAndPositionImageList();Z.annotationFileList&&Z.Viewport.getStatus("initializedAnnotationFileList")&&Z.Viewport.setSizeAndPositionAnnotationFileList();Z.slideList&&"undefined"!==typeof slideList&&null!==slideList&&(f=Z.Viewport.calculateSlideListCoords(Z.viewerW,Z.viewerH),slideList.style.left=f.x+"px",slideList.style.top=f.y+"px");Z.Gallery&&Z.Gallery.getInitialized()&&(Z.Gallery.setSizeAndPosition(a,b,c,d),Z.galleryAutoShowHide&&
Z.Gallery.setVisibility(!0));0<Z.magnifierVisible&&t.getStatus("magnifierInitializedViewport")&&t.sizeAndPositionMagnifier(null,null,null,null);e&&Z.Viewport.updateView(!0)};this.getImagePath=function(){return t.getImage()};this.getImage=function(){return Z.imagePath};this.setImagePath=function(a,b){"undefined"!==typeof b&&Z.Utils.stringValidate(b)&&(Z.imageProperties=b);t.setImage(a)};this.setImage=function(a,b,c,d){Z.narrative&&null===Z.imagePath&&(Z.imagePath=Z.Utils.stringRemoveTrailingSlash(a),
Z.Utils.validateImagePath());if(Z.Viewport&&(Z.Viewport.getStatus("initializedViewport")||c)){Z.Viewport.zoomAndPanAllStop(!0);var e=!0;null!==Z.editing&&(e=!0,null!==Z.editing&&Z.Viewport.verifyEditsUnsaved()&&(e=confirm(Z.Utils.getResource("ALERT_UNSAVEDEDITSEXIST-CUSTOM"))));e&&(Z.maskingSelection&&t.clearMask(),Z.overlays||Z.Utils.clearImageParameters(),Z.imagePath=Z.Utils.stringRemoveTrailingSlash(a),Z.Utils.validateImagePath(),e="undefined"===typeof d||null===d||0==d?Z.Viewport:Z["Viewport"+
d.toString()],e.setImagePath(Z.imagePath),"undefined"!==typeof b&&null!==b&&(Z.parameters=Z.Utils.parseParameters(b)),(c||Z.narrative)&&Z.Utils.setParameters(Z.parameters),"unconverted"==Z.tileSource?e.loadUnconvertedImage(a):Z.imageProperties?(a=Z.Utils.xmlConvertTextToDoc(Z.imageProperties),e.z602(a)):(a=new Z.NetConnector,e.loadImageProperties(Z.imagePath,a,d)))}else d=b?b.substring(b.indexOf("zAnnotationPath=")+16,b.length):null,Z.Viewport=new Z.ZoomifyViewport(0,a,d),Z.viewportCurrent=Z.Viewport,
Z.Toolbar&&Z.Toolbar.setViewport(Z.viewportCurrent)};this.setImageWithFade=function(a,b,c,d){if(Z.Viewport&&(Z.Viewport.getStatus("initializedViewport")||c)){if("undefined"===typeof d||null===d)d=50;Z.slideTransitionTimeout=window.setTimeout(function(){Z.Viewport.slideTransitionTimeoutHandler("out",a,b,c)},1)}};this.setTourPath=function(a,b){Z.Viewport&&Z.Viewport.getStatus("initializedViewport")&&Z.Viewport.setHotspotPath(a,b)};this.setHotspotPath=function(a,b){Z.Viewport&&Z.Viewport.getStatus("initializedViewport")&&
Z.Viewport.setHotspotPath(a,b)};this.setAnnotationPath=function(a,b){Z.Viewport&&Z.Viewport.getStatus("initializedViewport")&&Z.Viewport.setAnnotationPath(a,b)};this.setTrackingPath=function(a,b){Z.Viewport&&Z.Viewport.getStatus("initializedViewport")&&Z.Viewport.setTrackingPath(a,b)};this.initializePageExitEventHandler=function(){Z.Utils.addEventListener(window,"beforeunload",b)};this.disablePageExitEventHandler=function(){Z.Utils.removeEventListener(window,"beforeunload",b)};this.getStatus=function(a){a=
Z.Utils.arrayIndexOfObjectValue(B,"state",a);return-1==a?!1:B[a].status};this.setStatus=function(a,b){var c=!1,d=Z.Utils.arrayIndexOfObjectValue(B,"state",a);-1==d?(c=b,B[B.length]={state:a,status:b}):(!B[d].status&&b&&(c=!0),B[d].status=b);c&&(Z.Utils.validateCallback(a),t.validateViewerReady(a))};this.validateViewerStatus=function(a){var b=!0;if(Z.imageSet)for(var c=0,d=Z.imageSetLength;c<d;c++)if(!Z["Viewport"+c.toString()].getStatus(a)){b=!1;break}b&&(b=a.indexOf("Viewport"),-1!=b&&(a=a.substring(0,
b)),t.setStatus(a+"Viewer",!0))};this.validateViewerReady=function(a){a=Z.Viewport&&Z.Viewport.getStatus("initializedViewport")&&("unconverted"==Z.tileSource||Z.Viewport.getStatus("precacheLoadedViewport")&&Z.Viewport.getStatus("backfillLoadedViewport")&&Z.Viewport.getStatus("backfillDrawnViewport"))&&Z.Viewport.getStatus("displayLoadedViewport")&&Z.Viewport.getStatus("displayDrawnViewport");var b=!Z.hotspots||Z.Viewport&&Z.Viewport.getStatus("hotspotsLoadedViewport"),c=!Z.annotations||Z.Viewport&&
Z.Viewport.getStatus("annotationsLoadedViewport")&&(!Z.annotationPanelVisible||Z.Viewport.getStatus("annotationPanelInitializedViewport")),d=0==Z.toolbarVisible||Z.Toolbar&&Z.Toolbar.getInitialized(),e=!Z.navigatorVisible||Z.Navigator&&Z.Navigator.getInitialized(),f=!Z.galleryVisible||Z.Gallery&&Z.Gallery.getInitialized(),m=!Z.rulerVisible||Z.Ruler&&Z.Ruler.getInitialized(),l=!Z.imageSet||Z.Viewer&&Z.Viewer.getStatus("initializedViewer")&&("unconverted"==Z.tileSource||Z.Viewer.getStatus("precacheLoadedViewer")&&
Z.Viewer.getStatus("backfillLoadedViewer")&&Z.Viewer.getStatus("backfillDrawnViewer"))&&Z.Viewer.getStatus("displayLoadedViewer")&&Z.Viewer.getStatus("displayDrawnViewer"),v=!Z.imageSet||!Z.hotspots||Z.Viewer&&Z.Viewer.getStatus("hotspotsLoadedViewer"),p=!Z.imageSet||!Z.annotations||Z.Viewer&&Z.Viewer.getStatus("annotationsLoadedViewer")&&(!Z.annotationPanelVisible||Z.Viewer.getStatus("annotationPanelInitializedViewer"));(a=a&&b&&c&&d&&e&&f&&m&&l&&v&&p)&&Z.Viewer.setStatus("readyViewer",!0);return a};
this.initializeViewerKeyEventListeners=function(a){a?(Z.Utils.addEventListener(document,"keydown",e),Z.Utils.addEventListener(document,"keyup",e)):(Z.Utils.removeEventListener(document,"keydown",e),Z.Utils.removeEventListener(document,"keyup",e))};this.initializeViewerKeyDefaultListeners=function(a){a?(Z.Utils.addEventListener(document,"keydown",Z.Utils.preventDefault),Z.Utils.addEventListener(document,"keyup",Z.Utils.preventDefault)):(Z.Utils.removeEventListener(document,"keydown",Z.Utils.preventDefault),
Z.Utils.removeEventListener(document,"keyup",Z.Utils.preventDefault))};this.viewerEventsHandler=function(a){f(a)};this.autoResizeViewer=function(){u()};this.resizeViewer=function(a,b,c){t.setSizeAndPosition(a,b,0,0,!1);Z.viewportCurrent.resizeViewport(Z.imageX,Z.imageY,c,Z.imageR);if(Z.comparison)(a=0==Z.viewportCurrent.getViewportID()?Z.Viewport1:Z.Viewport0)&&a.syncViewportResize(Z.imageX,Z.imageY,Z.imageZ,Z.imageR);else if(Z.overlays)for(a=0,b=Z.imageSetLength-1;a<b;a++)Z["Viewport"+a.toString()].syncViewportResize(Z.imageX,
Z.imageY,Z.imageZ,Z.imageR);else Z.narrative&&(Z.Narrative.drawLayoutNarrativePanel(),Z.narrativeMode&&Z.Narrative.drawLayoutFileManagerPanel())};this.z586=function(a){Z.mouseWheelIsDown=!1;Z.mouseWheelCompleteTimer&&(window.clearTimeout(Z.mouseWheelCompleteTimer),Z.mouseWheelCompleteTimer=null,Z.zooming="stop",Z.viewportCurrent.updateView(!0))};this.magnifierMouseMoveHandler=function(a){Z.interactive&&Z.viewportCurrent.updateViewMagnifier(a)}};
Z.ZoomifyViewport=function(a,b,c,d,e,f){function m(){var b=Z.Utils.getResource("DEFAULT_IMAGELISTXMLFILE");".xml"!=Z.imageListPath.toLowerCase().substring(Z.imageListPath.length-4,Z.imageListPath.length)&&(Z.imageListPath=Z.imageListPath+"/"+b);XMLPath=Z.Utils.cacheProofPath(Z.imageListPath);"undefined"!==typeof XMLPath&&Z.Utils.stringValidate(XMLPath)&&(new Z.NetConnector).loadXML(XMLPath,a,"loadingImageListXML")}function u(a){a=Z.Utils.getResource("z209");".xml"!=Z.slidePath.toLowerCase().substring(Z.slidePath.length-
4,Z.slidePath.length)&&(Z.slidePath=Z.slidePath+"/"+a);XMLPath=Z.Utils.cacheProofPath(Z.slidePath);"undefined"!==typeof XMLPath&&Z.Utils.stringValidate(XMLPath)&&(a=new Z.NetConnector,a.loadXML(XMLPath,null,"loadingSlidesXML"))}function t(a,b,c,d,e,g,f,n,l,y,k){p();"ZoomifyPFFFile"==Z.tileSource&&Z.pffJPEGHeadersSeparate||(Z.imageW=a,Z.imageH=b,Z.imageCtrX=Z.imageW/2,Z.imageCtrY=Z.imageH/2,Z.imageD=Math.round(Math.sqrt(a*a+b*b)),ia=g,Ed=f,pc=n,Rc=e,xa=c,Fa=d);null!==l&&null!==y&&null!==k&&(Z.sourceMagnification=
l,Z.focal=y,Z.quality=k);L();R(N,P,Fd,Gd);h.validateXYZDefaults();ta>Wd?(Ga=ua(db,Z.initialZ),S&&ya.scale(Ga,Ga)):Aa&&(Aa.width="0px",Aa.height="0px");lb=ua(na,Z.initialZ);rb=W=ua(Q,Z.initialZ);if(Z.useCanvas)try{Ba.scale(W,W)}catch(O){Z.Utils.showMessage(Z.Utils.getResource("ERROR_SCALINGCANVASFORUNCONVERTEDIMAGE"),!1,Z.messageDurationStandard,"center"),console.log("In function initializeViewportContinue scaling canvas:  "+O)}"unconverted"!=Z.tileSource&&h.z619();ba(Z.initialX,Z.initialY,Z.initialZ,
Z.initialR,null,!0);Z.initialFullPage&&h.toggleFullViewMode(!0);Z.Utils.addEventListener(fa,"mousedown",Eb);Z.Utils.addEventListener(fa,"mousemove",Z.Utils.preventDefault);Z.Utils.addEventListener(fa,"touchstart",Eb);Z.Utils.addEventListener(fa,"touchmove",Eb);Z.Utils.addEventListener(fa,"touchend",Eb);Z.Utils.addEventListener(fa,"touchcancel",Eb);Z.Utils.addEventListener(fa,"gesturestart",Eb);Z.Utils.addEventListener(fa,"gesturechange",Eb);Z.Utils.addEventListener(fa,"gestureend",Eb);Z.Utils.addEventListener(ca,
"contextmenu",Z.Utils.preventDefault);Z.Utils.addEventListener(ga,"contextmenu",Z.Utils.preventDefault);Ha&&Z.Utils.addEventListener(Ha,"contextmenu",Z.Utils.preventDefault);Wa&&Z.Utils.addEventListener(Wa,"contextmenu",Z.Utils.preventDefault);h.setStatus("initializedViewport",!0);h.syncViewportRelated();Z.setCallback("imageChanged",Z.Viewport.updateImageComponents);Z.slideshow&&(a=Z.Utils.stringValidate(Z.slideListTitle)&&"none"!=Z.slideListTitle?1:0,"undefined"!==typeof Ce&&(Ce.selectedIndex=a),
qf&&!Z.slideshowPlaying?h.slideshowStart():Z.slideshowPlaying&&h.nextSlide());"multiple"==Z.imagePath&&(a=Z.hotspots?"hotspotsLoadedViewer":Z.annotations?"annotationsLoadedViewer":null,null!==a&&Z.setCallback(a,function(){window.setTimeout(function(){Z.viewportCurrent.z623()},1500)}))}function B(b,c,Tb,d,e,g,f,n,l,y,k){h.setStatus("initializedViewport",!1);h.clearAll(!0,!1,!0,!0);"ZoomifyPFFFile"==Z.tileSource&&Z.pffJPEGHeadersSeparate||(Z.imageW=b,Z.imageH=c,Z.imageCtrX=Z.imageW/2,Z.imageCtrY=Z.imageH/
2,Z.imageD=Math.round(Math.sqrt(b*b+c*c)),ia=g,Ed=f,pc=n,Rc=e,xa=Tb,Fa=d);Z.narrative||Z.slideshow||Z.Viewer.validateComponents(O);Z.Utils.setParameters(Z.parameters);Z.imageList&&(Z.tileW!=Tb&&(xa=Z.tileW),Z.tileH!=d&&(Fa=Z.tileH));L();null!==Z.hotspotPath&&(jd=Z.hotspotPath,ec=Z.hotspotFolder);null!==Z.annotationPath&&(fc=Z.annotationPath,Ub=Z.annotationFolder);x();p();h.validateXYZDefaults();ta>Wd?(Ga=ua(db,Z.initialZ),S&&(ya.restore(),ya.scale(Ga,Ga))):Aa&&(Aa.width="0px",Aa.height="0px");lb=
ua(na,Z.initialZ);rb=W=ua(Q,Z.initialZ);Z.useCanvas&&(Ba.restore(),Ba.scale(W,W));Ha&&z582();Wa&&(h.setDrawingColor("buttonColor0"+Oa,!0),Z.hotspots||Z.tour?loadHotspotsXML(Oa):(Z.annotations||Z.narrative)&&loadAnnotationsXML(Oa));Z.virtualPointerVisible&&Z.Viewer.createVirtualPointer();"unconverted"!=Z.tileSource&&h.z619();if(Z.narrative||Z.comparison)N=Z.viewerW;h.setSizeAndPosition(N,P,Fd,Gd);b="undefined"!==typeof Z.parameters&&null!==Z.parameters&&("undefined"!==typeof Z.parameters.zInitialX||
"undefined"!==typeof Z.parameters.zInitialY||"undefined"!==typeof Z.parameters.zInitialZoom);!Z.comparison&&!Z.overlays||b?ba(Z.initialX,Z.initialY,Z.initialZ,Z.initialR,null,!0):ba(Z.priorX,Z.priorY,Z.priorZ,Z.priorR,null,!0);Z.Utils.validateCallback("imageChanged");h.setStatus("initializedViewport",!0);(b=0==a?Z.Navigator:Z.Navigator2)&&b.setImage(h.getImagePath());Z.tracking&&loadTrackingXML(Oa);Z.comparison&&(b=(0==h.getViewportID()?Z.Viewport1:Z.Viewport0).getCoordinatesFull(!0),h.setView(b.x,
b.y,b.z,b.r,null,null));b=Z["Viewport"+(Z.imageSetLength-1).toString()];var O=Z.overlays?b:Z.viewportCurrent;Z.Viewer.configureComponents(O);h.syncViewportRelated();Z.Utils.validateCallback("reinitializedViewport");Z.slideshowPlaying&&h.nextSlide()}function C(){ta=1;na=Q=0;Xd=Yd=Zd=za=!1;"undefined"!==typeof Ca&&Z.Utils.arrayClear(Ca);"undefined"!==typeof La&&Z.Utils.arrayClear(La);"undefined"!==typeof oa&&Z.Utils.arrayClear(oa);"undefined"!==typeof Ma&&Z.Utils.arrayClear(Ma);"undefined"!==typeof Na&&
Z.Utils.arrayClear(Na);"undefined"!==typeof Rb&&Z.Utils.arrayClear(Rb);"undefined"!==typeof gc&&Z.Utils.arrayClear(gc);"undefined"!==typeof sb&&Z.Utils.arrayClear(sb);"undefined"!==typeof Sc&&Z.Utils.arrayClear(Sc);"undefined"!==typeof Fb&&Z.Utils.arrayClear(Fb);"undefined"!==typeof hc&&Z.Utils.arrayClear(hc);"undefined"!==typeof tb&&Z.Utils.arrayClear(tb);"undefined"!==typeof kd&&Z.Utils.arrayClear(kd);"undefined"!==typeof qc&&Z.Utils.arrayClear(qc);"undefined"!==typeof pa&&Z.Utils.arrayClear(pa);
"undefined"!==typeof rc&&Z.Utils.arrayClear(rc)}function x(a){if("undefined"===typeof a||null===a)a=0;var b=a.toString();Z.useCanvas&&!S&&(Gb=Z.Utils.createContainerElement("canvas","oversizeDisplay"+b,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),Z.ViewerDisplay.appendChild(Gb),S=Gb,Aa=S.style);!Z.comparison&&!Z.narrative||Hb||(zc=Z.Utils.createContainerElement("div","comparisonMaskContainer"+b,"inline-block","absolute","hidden","1px",
"1px","0px","0px","none","0px","transparent","0px","0px","normal"),Z.ViewerDisplay.appendChild(zc),Hb=zc,ic=Hb.style);fa||(la=Z.Utils.createContainerElement("div","viewportContainer"+b,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),Z.comparison||Z.narrative?zc.appendChild(la):Z.ViewerDisplay.appendChild(la),fa=la,E=fa.style);ca||(Tc=Z.Utils.createContainerElement(Z.useCanvas?"canvas":"div","viewportBackfillDisplay"+b,"inline-block","absolute",
"visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),la.appendChild(Tc),ca=Tc,J=ca.style,Z.hideOverlayBackfill&&0!=a&&(J.display="none"));ga||(sc=Z.Utils.createContainerElement(Z.useCanvas?"canvas":"div","viewportDisplay"+b,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),la.appendChild(sc),ga=sc,X=ga.style);Z.useCanvas&&!eb&&(Uc=Z.Utils.createContainerElement("canvas","transitionCanvas","none","absolute","visible",
"1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),la.appendChild(Uc),eb=Uc,Sb=eb.style);Z.watermarks&&!Ha&&(Vc=Z.Utils.createContainerElement("div","watermarkDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),la.appendChild(Vc),Ha=Vc,Ib=Ha.style);Z.maskVisible&&!Xa&&(Wc=Z.Utils.createContainerElement("canvas","maskCanvas","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent",
"0px","0px","normal"),la.appendChild(Wc),Xa=Wc,mb=Xa.style,mb.display="none");a=Z.zoomRectangle||Z.measureVisible||Z.tour&&!Z.screensaver||Z.hotspots||Z.annotations;var b=Z.useCanvas&&(a||Z.hotspots&&Z.labelShapesInternal),c=Z.useCanvas&&(Z.zoomRectangle||Z.measureVisible||null!==Z.editMode),d=b&&Z.saveImageHandlerProvided;b&&!Pa&&(Ac=Z.Utils.createContainerElement("canvas","drawingDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),
la.appendChild(Ac),Pa=Ac,Qa=Pa.style);c&&!Ra&&(Bc=Z.Utils.createContainerElement("canvas","editingDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),la.appendChild(Bc),Ra=Bc,Sa=Ra.style);a&&!Wa&&(Vb=Z.Utils.createContainerElement("div","hotspotDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),la.appendChild(Vb),Wa=Vb,Jb=Wa.style,Z.Utils.addEventListener(Vb,"mousedown",
Z.Utils.preventDefault));d&&!jc&&(Xc=Z.Utils.createContainerElement("canvas","savingDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),la.appendChild(Xc),jc=Xc,Cc=jc.style,Cc.display="none");Z.useCanvas||(ca.innerHTML="",ga.innerHTML="");Ha&&(Ha.innerHTML="");Wa&&(Wa.innerHTML="")}function p(){Z.useCanvas&&(S&&(ya=S.getContext("2d")),Kb=ca.getContext("2d"),Ba=ga.getContext("2d"),Wb=eb.getContext("2d"),Pa&&(Dc=Pa.getContext("2d")),
Ra&&(Ec=Ra.getContext("2d")),Xa&&(Fc=Xa.getContext("2d")),jc&&jc.getContext("2d"))}function R(b,c,Tb,d){if("undefined"===typeof Tb||null===Tb)Tb=0;if("undefined"===typeof d||null===d)d=0;N=Z.narrative?b-Z.narrativeW:Z.comparison?b/2:b;b=1==Z.toolbarVisible&&Z.toolbarBackgroundVisible?null!==Z.toolbarH?Z.toolbarH:parseInt(Z.Utils.getResource("DEFAULT_TOOLBARHEIGHT"),10):0;P=Z.viewerH-b;Fd=0;Gd=0==Z.toolbarPosition?b:0;b=1;if(Z.rotationVisible||0!=Z.imageR)b=Math.sqrt(N*N+P*P)/((N+P)/2);Y=N*De*b;da=
P*De*b;b=Z.imageSet?rf:"unconverted"==Z.tileSource&&Z.mobileDevice?sf:"unconverted"==Z.tileSource&&Z.browser==Z.browsers.FIREFOX?tf:uf;c=Z.constrainPanStrict?Z.imageW:2*Z.imageW;var e=Z.constrainPanStrict?Z.imageH:2*Z.imageH;Y>b&&(Y=b);da>b&&(da=b);Y>c&&(Y=c);da>e&&(da=e);Y<N&&(Y=N);da<P&&(da=P);ub=Z.Utils.roundToFixed(Y/2,4);vb=Z.Utils.roundToFixed(da/2,4);Ta=Z.Utils.roundToFixed(-((Y-N)/2)+Tb,4);Z.Utils.roundToFixed((Y-N)/2+Tb,4);Ua=Z.Utils.roundToFixed(-((da-P)/2)+d,4);Z.Utils.roundToFixed((da-
P)/2+d,4);S&&(S.width=N,S.height=P,Aa.width=N+"px",Aa.height=P+"px",Aa.left="0px",Aa.top="0px");if(Z.narrative||Z.comparison)Hb.width=N,Hb.height=P,ic.width=N+"px",ic.height=P+"px",ic.left=Z.narrative?Z.narrativeW+"px":0==a?"0px":N+"px",ic.top="0px";fa.width=Y;fa.height=da;E.width=Y+"px";E.height=da+"px";E.left=Ta+"px";E.top=Ua+"px";ga.width=Y;ga.height=da;X.width=Y+"px";X.height=da+"px";Ha&&(Ha.width=Y,Ha.height=da,Ib.width=Y+"px",Ib.height=da+"px",Ib.zIndex=(Z.baseZIndex+2).toString());Xa&&(Xa.width=
Y,Xa.height=da,mb.width=Y+"px",mb.height=da+"px");Wa&&(Wa.width=Y,Wa.height=da,Jb.width=Y+"px",Jb.height=da+"px",ld&&(Tb=parseInt(Z.Utils.getResource("z133"),10),calculateHotspotListCoords(vf,Tb,N,P)));Pa&&(Pa.width=Y,Pa.height=da,Qa.width=Y+"px",Qa.height=da+"px");Ra&&(Ra.width=Y,Ra.height=da,Sa.width=Y+"px",Sa.height=da+"px");if(Z.useCanvas){S&&(ya.translate(N/2,P/2),ya.save());try{Ba.translate(ub,vb)}catch(g){Z.Utils.showMessage(Z.Utils.getResource("ERROR_TRANSLATINGCANVASFORUNCONVERTEDIMAGE"),
!1,Z.messageDurationStandard,"center")}Ba.save();Xa&&(Fc.translate(ub,vb),Fc.save());Pa&&(Dc.translate(ub,vb),Dc.save());Ra&&(Ec.translate(ub,vb),Ec.save())}}function ma(a,b,c){if("ZoomifyZIFFile"==Z.tileSource){var d=parseFloat(Z.Utils.getResource("z125")),e=parseFloat(Z.Utils.getResource("z124"));b.loadByteRange(a,d,e,"loadingZIFFileBytes","header",null,null,c)}else"ZoomifyImageFolder"==Z.tileSource?(a=Z.Utils.cacheProofPath(a+"/ImageProperties.xml"),b.loadXML(a,c,"loadingImagePropertiesXML")):
"ZoomifyPFFFile"==Z.tileSource?null===Z.tileHandlerPathFull?(d=parseFloat(Z.Utils.getResource("z125")),e=parseFloat(Z.Utils.getResource("z123")),b.loadByteRange(a,d,e,"loadingPFFFileBytes","header",null,null,c)):(d=Z.Utils.getResource("z125"),e=Z.Utils.getResource("z123"),a=a.replace(".","%2E"),b.loadXML(Z.tileHandlerPathFull+"?file="+a+"&requestType=1&begin="+d+"&end="+e,c,"loadingPFFPropertiesServletXML")):"DZIFolder"==Z.tileSource?(a=w(a,"properties"),b.loadXML(a,c,"loadingDZIPropertiesXML")):
"IIIFImageServer"==Z.tileSource&&b.loadJSON(a+"/info.json",c,"loadingIIIFJSON")}function ea(a,b,c,d,e,g,f,n,l,y,k){"ZoomifyPFFFile"==Z.tileSource&&Z.pffJPEGHeadersSeparate||!isNaN(a)&&0<a&&!isNaN(b)&&0<b&&!isNaN(c)&&0<c&&!isNaN(d)&&0<d&&0<e?h.getStatus("initializedViewport")?B(a,b,c,d,e,g,f,n,l,y,k):t(a,b,c,d,e,g,f,n,l,y,k):Z.Utils.showMessage(Z.Utils.getResource("z250"),!1,Z.messageDurationStandard,"center")}function K(a,b){C();if("undefined"===typeof h.getStatus)window.setTimeout(function(){K(a,
b)},100);else{var c=null,d=null,e=null,g=null,f=null,n=null,l=null,y=null,k=null,O=null,q=null;"ZoomifyImageFolder"==Z.tileSource?(c=parseInt(a.documentElement.getAttribute("WIDTH"),10),d=parseInt(a.documentElement.getAttribute("HEIGHT"),10),f=parseInt(a.documentElement.getAttribute("NUMTILES"),10),parseInt(a.documentElement.getAttribute("NUMIMAGES"),10),n=parseInt(a.documentElement.getAttribute("VERSION"),10),e=g=parseInt(a.documentElement.getAttribute("TILESIZE"),10)):"DZIFolder"==Z.tileSource?
(n=f=1,c=a.getElementsByTagName("Image")[0],e=g=parseInt(c.getAttribute("TileSize"),10),parseInt(c.getAttribute("Overlap"),10),Z.tileType=c.getAttribute("Format"),d=c.getElementsByTagName("Size")[0],c=parseInt(d.getAttribute("Width"),10),d=parseInt(d.getAttribute("Height"),10)):"ZoomifyPFFFile"==Z.tileSource?(c=parseInt(a.documentElement.getAttribute("WIDTH"),10),d=parseInt(a.documentElement.getAttribute("HEIGHT"),10),e=g=parseInt(a.documentElement.getAttribute("TILESIZE"),10),f=parseInt(a.documentElement.getAttribute("NUMTILES"),
10),parseInt(a.documentElement.getAttribute("NUMIMAGES"),10),n=parseInt(a.documentElement.getAttribute("VERSION"),10),l=parseInt(a.documentElement.getAttribute("HEADERSIZE"),10),y=1060+l):"IIIFImageServer"==Z.tileSource?(c=parseInt(a.documentElement.getAttribute("WIDTH"),10),d=parseInt(a.documentElement.getAttribute("HEIGHT"),10),f=n=e=g=null):"ImageServer"==Z.tileSource&&(c=parseInt(a.documentElement.getAttribute("WIDTH"),10),d=parseInt(a.documentElement.getAttribute("HEIGHT"),10),g=a.documentElement.getAttribute("TILESIZE"),
e=Z.Utils.stringValidate(g)?parseInt(g,10):xa,g=Z.Utils.stringValidate(g)?parseInt(g,10):Fa,k=a.documentElement.getAttribute("MAGNIFICATION"),k=Z.Utils.stringValidate(k)?parseInt(k,10):Z.sourceMagnification,O=a.documentElement.getAttribute("FOCAL"),O=Z.Utils.stringValidate(O)?parseInt(O,10):Z.focal,q=a.documentElement.getAttribute("QUALITY"),q=Z.Utils.stringValidate(q)?parseInt(q,10):Z.quality);null!==Z.tileW&&(e=Z.tileW);null!==Z.tileH&&(g=Z.tileH);if("ZoomifyImageFolder"==Z.tileSource||"IIIFImageServer"==
Z.tileSource||"ImageServer"==Z.tileSource){if(null===e||isNaN(e))e=xa;if(null===g||isNaN(g))g=Fa;if(null===f||isNaN(f))f=1}!isNaN(c)&&0<c&&!isNaN(d)&&0<d&&!isNaN(e)&&0<e&&!isNaN(g)&&0<g&&0<f?h.getStatus("initializedViewport")?B(c,d,e,g,f,n,l,y,k,O,q,b):t(c,d,e,g,f,n,l,y,k,O,q,b):"ZoomifyImageFolder"==Z.tileSource?Z.Utils.showMessage(Z.Utils.getResource("z252"),!1,Z.messageDurationStandard,"center"):Z.Utils.showMessage(Z.Utils.getResource("z250"),!1,Z.messageDurationStandard,"center")}}function L(){if("unconverted"==
Z.tileSource)Ca[0]=Z.imageW,La[0]=Z.imageH,oa[0]=1,Ma[0]=1,nb=ta=Na[0]=1;else if("ZoomifyZIFFile"==Z.tileSource){for(var a=ta-1;0<=a;a--)oa[a]=Math.ceil(Ca[a]/xa),Ma[a]=Math.ceil(La[a]/Fa),Na[a]=oa[a]*Ma[a];Gc=oa[nb]-1;tc=Ma[nb]-1}else{for(var b=Z.imageW,c=Z.imageH;b>xa||c>Fa;)b/=2,c/=2,ta++;for(var b=Z.imageW,c=Z.imageH,a=0,d=ta-1;0<=d;d--)Ca[d]=b,La[d]=c,oa[d]=Math.ceil(Ca[d]/xa),Ma[d]=Math.ceil(La[d]/Fa),Na[d]=oa[d]*Ma[d],b/=2,c/=2,a+=Na[d];nb=ta-1;Gc=oa[nb]-1;tc=Ma[nb]-1;if("DZIFolder"==Z.tileSource){b=
Ca[0];c=La[0];for(d=0;1<b||1<c;)b/=2,c/=2,d++;Z.dziSubfoldersToSkip=d-1}if(a!=Rc&&("ZoomifyImageFolder"==Z.tileSource||"ZoomifyZIFFile"==Z.tileSource||"ZoomifyPFFFile"==Z.tileSource)){Ca=[];La=[];oa=[];Ma=[];ta=1;a=Z.imageW;b=Z.imageH;for(c=2;a>xa||b>Fa;)a=Math.floor(Z.imageW/c),b=Math.floor(Z.imageH/c),c*=2,a%2&&a++,b%2&&b++,ta++;nb=ta-1;Gc=oa[nb]-1;tc=Ma[nb]-1;a=Z.imageW;b=Z.imageH;c=2;tileCounter=0;for(d=ta-1;0<=d;d--)oa[d]=Math.floor(a/xa),a%xa&&oa[d]++,Ma[d]=Math.floor(b/Fa),b%Fa&&Ma[d]++,Na[d]=
oa[d]*Ma[d],tileCounter+=Na[d],Ca[d]=a,La[d]=b,a=Math.floor(Z.imageW/c),b=Math.floor(Z.imageH/c),c*=2,a%2&&a++,b%2&&b++;a=tileCounter;a!=Rc&&Z.Utils.showMessage(Z.Utils.getResource("z254"),!1,Z.messageDurationStandard,"center")}}}function n(a,b){for(var c=oa[a]-1,d=Ma[a]-1,e=0;e<=c;e++)for(var g=0;g<=d;g++)b[b.length]=a+"-"+e+"-"+g}function A(){za=!1;na=0;Q>Wd?(na=Q-wf,za=!0):na=Q>Ee?md:Q>Fe?Hd:Id;for(var a=na.toString(),b=0,c=qa.length;b<c;b++)qa[b].substring(0,1)==a&&(gb[gb.length]=qa[b]);tierBackfillScalePrior=
lb=ua(na,Z.imageZ);var a=Ca[na],b=La[na],c=Z.imageX*Z.imageZ,d=Z.imageY*Z.imageZ;za?(a=Ge,Xb=Y*a,Yb=da*a,zb=-(Y/a),Ab=-(da/a),$d=ub*a,ae=vb*a,ca.width=Xb,ca.height=Yb,J.width=ca.width+"px",J.height=ca.height+"px",J.left=zb+"px",J.top=Ab+"px",Z.useCanvas&&(S&&(Ga=ua(db,Z.imageZ),ya.restore(),ya.save(),ya.scale(Ga,Ga),0!=Z.imageR&&ya.rotate(Z.imageR*Math.PI/180)),Kb.restore(),Kb.translate($d,ae),Kb.save(),Kb.scale(lb,lb))):(Xb=a*lb,Yb=b*lb,zb=ub-c,Ab=vb-d,ca.width=a,ca.height=b,Z.useCanvas&&(J.width=
Xb+"px",J.height=Yb+"px"),J.left=zb+"px",J.top=Ab+"px")}function l(a){if(a){a=h.z542(na);Z.Utils.arrayClear(qa);Z.Utils.arrayClear(gb);b=a.l;for(c=a.r;b<=c;b++)for(d=a.t,e=a.b;d<=e;d++)g=na+"-"+b+"-"+d,gb[gb.length]=g,qa[qa.length]=g;G(qa,ha,"simple","image-backfill");Lb=V.length;h.traceDebugValues("tilesBackfillToDisplay",null,gb.length,gb);h.traceDebugValues("tilesBackfillInCache",null,qa.length,qa)}else{Z.Utils.arrayClear(kc);Z.Utils.arrayClear(lc);Z.Utils.arrayClear(Zb);Z.Utils.arrayClear(V);
a=h.z542();for(var b=a.l,c=a.r;b<=c;b++)for(var d=a.t,e=a.b;d<=e;d++){var g=Q+"-"+b+"-"+d;kc[kc.length]=g;V[V.length]=g}if(h.getStatus("initializedViewport")&&0<Da.length&&(Q==Id||Q==Hd||Q==md))for(b=0,c=Da.length;b<c;b++)(d=Da[b])&&d.t==Q&&d.c>=a.l&&d.c<=a.r&&d.r>=a.t&&d.r<=a.b&&(Zb[Zb.length]=d.name,lc[lc.length]=d,e=Z.Utils.arrayIndexOf(V,d.name),-1!=e&&(V=Z.Utils.arraySplice(V,e,1)));b=0;for(c=hb.length;b<c;b++)(d=hb[b])&&d.t==Q&&d.c>=a.l&&d.c<=a.r&&d.r>=a.t&&d.r<=a.b&&(e=Z.Utils.arrayIndexOf(Zb,
d.name),-1==e&&(Zb[Zb.length]=d.name,lc[lc.length]=d),d=Z.Utils.arrayIndexOf(V,d.name),-1!=d&&(V=Z.Utils.arraySplice(V,d,1)));if(0!=$b){b=0;for(c=ib.length;b<c;b++)d=ib[b],d.alpha=1;Z.Utils.arrayClear(ib);Z.Utils.arrayClear(ob)}Lb=V.length;h.traceDebugValues("tilesToDisplay",null,kc.length,kc);h.traceDebugValues("tilesInCache",null,Zb.length,Zb);h.traceDebugValues("tilesToLoad",null,V.length,V)}}function v(a,b,c,d,e,g){e||Z.Utils.clearDisplay(a);if("canvasCopy"==d)Z.Utils.clearDisplay(ga),Ba.restore(),
Ba.save(),Ba.scale(1,1),Ba.drawImage(eb,-ub,-vb),Ba.restore(),Ba.save(),Ba.scale(W,W);else{e=h.z542(b);g=[];if(null===c)for(var f=0,n=lc.length;f<n;f++)g[f]=lc[f];else if(0<c.length)for(f=0,n=c.length;f<n;f++){var l=c[f];l&&l.t==b&&(b==na&&!za||l.c>=e.l&&l.c<=e.r&&l.r>=e.t&&l.r<=e.b)&&(g[g.length]=c[f])}if(0<g.length)if(h.traceDebugValues("z622-"+a.id,null,null,g),"centerOut"==d)for(f=Math.floor(g.length/2),n=g.length;f<n;f++)Ia(a,b,g[f]),g.length-f-1!=f&&Ia(a,b,g[g.length-f-1]);else for(f=0,n=g.length;f<
n;f++)Ia(a,b,g[f]);else h.traceDebugValues("No cached tiles in view");h.traceDebugValues("blankLine")}}function aa(a,b){var c=h.z542();syncTransitionCanvas();for(var d=0,e=b.length;d<e;d++){var g=b[d];g&&g.t==a&&(a==na||g.c>=c.l&&g.c<=c.r&&g.r>=c.t&&g.r<=c.b)&&Ia(eb,a,g)}}function G(a,b,c,d){var e="undefined"!==typeof d&&null!==d?"-"+d:"";if(0<a.length){h.traceDebugValues("z577"+e,null,null,a);e=(new Date).getTime();if("centerOut"==c&&4<a.length){var g=[],f=0,n=0,l=0,y=0;for(c=0;c<a.length;c++){var k=
a[c];k&&(k=new I(k,d),g[g.length]=k,0==c?(f=n=k.c,l=y=k.r):(k.c<f?f=k.c:k.c>n&&(n=k.c),k.r<l?l=k.r:k.r>y&&(y=k.r)))}a=f+(n-f)/2;d=l+(y-l)/2;for(c=0;c<g.length;c++)g[c].r-=d,g[c].c-=a;g.sort(function(a,b){return a.r*a.r+a.c*a.c-(b.r*b.r+b.c*b.c)});for(c=0;c<g.length;c++)g[c].r+=d,g[c].c+=a,U(g[c],e,b)}else for(c=0,g=a.length;c<g;c++)if(k=a[c])k=new I(k,d),U(k,e,b);h.traceDebugValues("blankLine")}else h.traceDebugValues("z577"+e,"No new tiles requested")}function I(a,b){this.imagePath=Z.imagePath;this.name=
a;var c=new T(a);this.t=c.t;this.c=c.c;this.r=c.r;this.x=Math.floor(this.c*xa);this.y=Math.floor(this.r*Fa);this.image=null;this.alpha=0;this.url=h.formatTilePath(this.t,this.c,this.r,b);this.style=this.elmt=this.loadTime=null}function T(a){this.t=parseInt(a.substring(0,a.indexOf("-")),10);this.c=parseInt(a.substring(a.indexOf("-")+1,a.lastIndexOf("-")),10);this.r=parseInt(a.substring(a.lastIndexOf("-")+1),10)}function ja(a,b,c){c=b+c*oa[a];b=8*c+Rb[a];c=Math.floor(c/Ja);var d=c*Ja,d=d+Ja>Na[a]?8*
(Na[a]-d):He;this.chunkStart=Rb[a]+c*He;this.chunkEnd=this.chunkStart+d;this.offsetStartInChunk=b-this.chunkStart;this.chunkID=a.toString()+"-"+c.toString()}function Mb(a,b,c){c=b+c*oa[a];b=4*c+Fb[a];c=Math.floor(c/Ja);var d=c*Ja,d=d+Ja>Na[a]?4*(Na[a]-d):Ie;this.chunkStart=Fb[a]+c*Ie;this.chunkEnd=this.chunkStart+d;this.bcStartInChunk=b-this.chunkStart;this.chunkID=a.toString()+"-"+c.toString()}function w(a,b,c,d,e){"tile"==a?(a=(parseInt(b,10)+Z.dziSubfoldersToSkip+1).toString(),c=Z.imagePath+"/"+
Z.dziImageSubfolder+"/"+a+"/"+c+"_"+d+"."+Z.tileType):c=Z.imagePath+"/"+Z.dziImagePropertiesFilename;if(Z.browser==Z.browsers.IE&&9>Z.browserVersion||0==uc)c=Z.Utils.cacheProofPath(c);return c}function Ya(a,b,c){var d=h.getViewportID();rc[a]=c;var e=new Z.NetConnector;null===Z.tileHandlerPathFull?e.loadByteRange(Z.imagePath,a,b,"loadingPFFFileBytes","offset",null,c,d):(c=wb.replace(".","%2E"),e.loadXML(Z.tileHandlerPathFull+"?filePath="+c+"&requestType=2&begin="+a+"&end="+b,"loadingPFFChunkServletXML"))}
function ra(a,b){for(var c=0,d=sa.length;c<d;c++){var e=sa[c].split(",");e[0]==a&&e[5]==b&&("undefined"!==typeof e[4]&&("image-display"==e[4]?Bb[Bb.length]=e[1]+"-"+e[2]+"-"+e[3]:"image-backfill"==e[4]?Nb[Nb.length]=e[1]+"-"+e[2]+"-"+e[3]:"image-magnifier"==e[4]&&(ac[ac.length]=e[1]+"-"+e[2]+"-"+e[3])),sa=Z.Utils.arraySplice(sa,c,1),c--,d--)}0<Bb.length&&(Bb.sort(),Bb=Z.Utils.arrayUnique(Bb),h.traceDebugValues("selectTilesRetry",Bb),c=h.getStatus("imageSaving")?onTileLoadToSave:F,D(Bb,c,"simple",
"image-display"));0<Nb.length&&(Nb.sort(),Nb=Z.Utils.arrayUnique(Nb),c=h.getStatus("imageSaving")?z599ToSave:ha,D(Nb,c,"simple","image-backfill"));ac&&0<ac.length&&(ac.sort(),ac=Z.Utils.arrayUnique(ac),c=onTileLoadMagnifier,D(ac,c,"simple","image-magnifier"))}function D(a,b,c,d){c=(new Date).getTime();for(var e=0,g=a.length;e<g;e++){var f=null;if(f=a[e])a=Z.Utils.arraySplice(a,e,1),e--,g--,index=Z.Utils.arrayIndexOfObjectValue(mc,"name",f),-1!=index?(f=mc[index],mc=Z.Utils.arraySplice(mc,index,1),
f.url=h.formatTilePath(f.t,f.c,f.r,d)):f=new I(f,d),null!=f&&-1==f.url.indexOf("NaN")?(h.traceDebugValues("z577Retry",f.name+"  "+f.url),U(f,c,b)):-1==f.url.indexOf("NaN")&&Z.Utils.showMessage(Z.Utils.getResource("z280-ZIF")+f.name+".jpg",!1,Z.messageDurationShort,"center",!1)}}function U(a,b,c){var d=a.name;if("z647"==a.url.substr(0,8)){nd(a);c=a.name;var e=Z.Utils.arrayIndexOf(V,c);-1!=e&&(V=Z.Utils.arraySplice(V,e,1));if("ZoomifyZIFFile"==Z.tileSource||"ZoomifyPFFFile"==Z.tileSource)e=Z.Utils.arrayIndexOf(Bb,
c),-1!=e&&(Bb=Z.Utils.arraySplice(Bb,e,1));ib[ib.length]=a;ob[ob.length]=c}else if("offsetLoading"==a.url)-1==Z.Utils.arrayIndexOfObjectValue(mc,"name",d)&&(mc[mc.length]=a),h.traceDebugValues("z581DelayForOffset",d);else if("offsetLoading"!=a.url){c==F||Z.enterpriseParamsEnabled&&c==onTileLoadToSave?e="image-display":c==ha||c==z599ToSave?e="image-backfill":c==onTileLoadMagnifier&&(e="image-magnifier");var g=a.t==Id&&Zd||a.t==Hd&&Yd||a.t==md&&Xd;"image-display"==e&&g||(a.loadTime=b,h.traceDebugValues("z581-"+
e,d),b=h.getViewportID(),xf.loadImage(a.url,Z.Utils.createCallback(null,c,a),"loadingImageTile",e,a,b))}}function F(a,b){if(a&&b&&a.imagePath==Z.imagePath){a.image=b;var c=a.name,d=Z.Utils.arrayIndexOf(V,c);if(-1!=d){V=Z.Utils.arraySplice(V,d,1);nd(a);if(Z.preloadVisible&&!Z.imageSet&&a.t!=Q){Z.Utils.showMessage(Z.Utils.getResource("ALERT_PRELOADING-STORINGORDRAWINGTILES")+"   Tile: "+c,!1,Z.messageDurationShort/10,"center");a.alpha=1;return}-1==Z.Utils.arrayIndexOf(ob,c)&&(ob[ob.length]=c,ib[ib.length]=
a);Z.preloadVisible&&Z.imageSet&&h.getViewportID()!=Z.viewportCurrentID&&(c=(h.getViewportID()+1).toString()+" of "+Z.imageSetLength.toString()+"   Tile: "+c,Z.Utils.showMessage(Z.Utils.getResource("ALERT_PRELOADING-STORINGORDRAWINGTILES")+c,!1,Z.messageDurationShort/10,"center"));Jd||(Jd=window.setInterval(xb,50));$b=V.length;if(0==$b){Z.useCanvas&&0<uc&&(Yc?(aa(Q,hb),v(ga,Q,hb,"canvasCopy",!1,"4. Updating view: all new tiles loaded"),window.setTimeout(function(){Z.Utils.clearDisplay(eb)},200),Yc=
!1):v(ga,Q,hb,"centerOut",!1,"4. Updating view: all new tiles loaded"));for(;bc.length>uc&&hb.length>uc;)bc=Z.Utils.arraySplice(bc,0,1),hb=Z.Utils.arraySplice(hb,0,1);Lb=0}h.traceDebugValues("onTileLoad",a.name,a.loadTime);h.updateProgress(Lb,$b)}Kd==Ld+vc&&h.setStatus("displayLoadedViewport",!0)}else"undefined"!==typeof b&&null!==b||console.log(Z.Utils.getResource("z280")+a.name+".jpg")}function ha(a,b){if(a&&b&&a.imagePath==Z.imagePath){a.image=b;var c=a.name;Da[Da.length]=a;var d=Z.Utils.arrayIndexOf(qa,
c);-1!=d&&(qa=Z.Utils.arraySplice(qa,d,1));if("ZoomifyZIFFile"==Z.tileSource||"ZoomifyPFFFile"==Z.tileSource)c=Z.Utils.arrayIndexOf(Nb,c),-1!=c&&(Nb=Z.Utils.arraySplice(Nb,c,1));a.alpha=1;a.t==na&&Ia(ca,na,a);h.traceDebugValues("onTileBackfillPrecache",a.name);od==yb&&(h.setStatus("precacheLoadedViewport",!0),0<Z.navigatorVisible&&Z.Utils.validateCallback(Z.comparison&&0!=Oa?"navigator2TileLoaded":"navigatorTileLoaded"));h.traceDebugValues("onTileLoadBackfill",a.name);be<=0+ce&&h.setStatus("backfillLoadedViewport",
!0);a.t==Q&&F(a,b)}else if("undefined"===typeof b||null===b)Z.mobileDevice?console.log(Z.Utils.getResource("z280")+a.name+".jpg"):Z.Utils.showMessage(Z.Utils.getResource("z280")+a.name+".jpg")}function xb(){for(var a=0,b=0,c=ib.length;b<c;b++){var d=ib[b];d.t==Q?(Z.fadeIn&&0!=de&&1>d.alpha+de?d.alpha+=de:(d.alpha=1,a++),Ia(ga,Q,d),a>=c&&(window.clearInterval(Jd),Jd=null,b=c)):(ib=Z.Utils.arraySplice(ib,b,1),ob=Z.Utils.arraySplice(ob,b,1),d=Z.Utils.arrayIndexOf(V,d.name),-1!=d&&(V=Z.Utils.arraySplice(V,
d,1)),c--)}}function Ia(a,b,c){if("z647"!=c.url.substr(0,8)&&0!=c.image.width&&0!=c.image.height){var d=c.x,e=c.y;b=ka(b,1);Ga=ua(db,h.getZoom());var g=8<Ga;Z.useCanvas?(a==ga||a==eb||a==ca&&za?(d-=Z.imageX*b,e-=Z.imageY*b):a==S&&(za||g)&&(g=h.calculateCurrentCenterCoordinates(),d-=g.x*b,e-=g.y*b),b=a.getContext("2d"),Z.alphaSupported&&1>c.alpha&&"transitionCanvas"!=a.id&&-1==a.id.indexOf("oversizeDisplay")&&"savingDisplay"!=a.id&&!Je&&(b.globalAlpha=c.alpha),b.drawImage(c.image,d,e),Z.alphaSupported&&
1>c.alpha&&"transitionCanvas"!=a.id&&-1==a.id.indexOf("oversizeDisplay")&&"savingDisplay"!=a.id&&!Je&&(b.globalAlpha=1),2!=Z.debug&&4!=Z.debug||Za(a,c.name,d,e,W)):(a==ga?(d-=Z.imageX*b-ub/W,e-=Z.imageY*b-vb/W,b=W):b=lb,c.elmt||(c.elmt=Z.Utils.createContainerElement("img"),c.elmt.onmousedown=Z.Utils.preventDefault,Z.Utils.addEventListener(c.elmt,"contextmenu",Z.Utils.preventDefault),c.elmt.src=c.url,c.style=c.elmt.style,c.style.position="absolute",Z.Utils.renderQuality(c,Z.renderQuality),Z.cssTransformsSupported&&
(c.style[Z.cssTransformProperty+"Origin"]="0px 0px")),c.elmt.parentNode!=a&&a.appendChild(c.elmt),g=c.style,g.display="none",Z.cssTransformsSupported?g[Z.cssTransformProperty]=["matrix(",(c.image.width/c.elmt.width*b).toFixed(8),",0,0,",(c.image.height/c.elmt.height*b).toFixed(8),",",(d*b).toFixed(8),Z.cssTransformNoUnits?",":"px,",(e*b).toFixed(8),Z.cssTransformNoUnits?")":"px)"].join(""):(g.width=c.image.width*b+"px",g.height=c.image.height*b+"px",g.left=d*b+"px",g.top=e*b+"px"),g.display="inline-block",
Z.Utils.setOpacity(c,c.alpha),2!=Z.debug&&4!=Z.debug||Za(a,c.name,d,e,b));a==ga?(h.traceDebugValues("z507",c.name),Kd==pd&&h.setStatus("displayDrawnViewport",!0)):(h.traceDebugValues("z507Backfill",c.name),be<=ee&&h.setStatus("backfillDrawnViewport",!0))}}function Za(a,b,c,d,e){if(Z.useCanvas){var g=parseInt(Z.Utils.getResource("z129"),10),f=parseInt(Z.Utils.getResource("z160"),10),n=parseInt(Z.Utils.getResource("z151"),10),g=Math.round(g*e),f=2*(g<f?f:g>n?n:g);a=a.getContext("2d");a.font=f+"px verdana";
a.textAlign="left";a.textBaseline="top";f=xa*e/2;e=Fa*e/2;a.fillStyle="#FFFFFF";a.fillText(b,c+f,d+e);a.fillStyle="#000000";a.fillText(b,c+f+1,d+e+1)}else{var g=parseInt(Z.Utils.getResource("z129"),10),f=parseInt(Z.Utils.getResource("z160"),10),n=parseInt(Z.Utils.getResource("z151"),10),g=Math.round(g*e),l=2*(g<f?f:g>n?n:g),f=parseInt(Z.Utils.getResource("z130"),10)*e,n=Z.Utils.createContainerElement("div","tileNameTextBox","inline-block","absolute","hidden","auto","auto","1px","1px","none","0px",
"transparent","0px",f+"px","nowrap"),g=document.createTextNode(b);n.appendChild(g);a.appendChild(n);Z.Utils.setTextNodeStyle(g,"white","verdana",l+"px","none","normal","normal","normal","normal","1em","center","none");var k=Z.Utils.createContainerElement("div","tileNameTextBox2","inline-block","absolute","hidden","auto","auto","1px","1px","none","0px","transparent","0px",f+"px","nowrap"),h=document.createTextNode(b);k.appendChild(h);a.appendChild(k);Z.Utils.setTextNodeStyle(h,"black","verdana",l+
"px","none","normal","normal","normal","normal","1em","center","none");f=parseFloat(n.style.padding);a=parseFloat(Z.Utils.getElementStyleProperty(n,"width"));isNaN(a)&&(a=parseFloat(Z.Utils.getResource("z115")),a=parseFloat(n.style.fontSize)/a,a=Math.round(parseFloat(b.length*a)));b=xa*e/2;l=Fa*e/2;n.style.left=c*e+(b-a/2-f)+"px";n.style.top=d*e+l+"px";k.style.left=1+c*e+(b-a/2-f)+"px";k.style.top=1+d*e+l+"px";Z.Utils.addEventListener(n,"contextmenu",Z.Utils.preventDefault);Z.Utils.disableTextInteraction(g);
Z.Utils.addEventListener(k,"contextmenu",Z.Utils.preventDefault);Z.Utils.disableTextInteraction(h)}}function $a(a,b){var c=ka(b,1),d=Math.floor(a.l*c/xa),e=Math.floor(a.r*c/xa),g=Math.floor(a.t*c/Fa),c=Math.floor(a.b*c/Fa);0>d&&(d=0);e>oa[b]-1&&(e=oa[b]-1);0>g&&(g=0);c>Ma[b]-1&&(c=Ma[b]-1);this.l=d;this.r=e;this.t=g;this.b=c}function ab(a,b,c,d,e,g,f,n,l){"undefined"===typeof n||null===n?(this.l=a+c/f,this.r=a+d/f,this.t=b+e/f,this.b=b+g/f):(f=N/Ca[n],n=P/La[n],this.l=a+c*f,this.r=a+d*f,this.t=b+
e*n,this.b=b+g*n);l&&(this.l-=256-this.l%256,this.r+=256-this.r%256,this.t-=256-this.t%256,this.b+=256-this.b%256)}function ka(a,b){return Ca[a]/Z.imageW*b}function ua(a,b){return b/(Ca[a]/Z.imageW)}function jb(a,b,c,d,e){if(Z.constrainPan&&0==d){c="undefined"!==typeof c&&null!==c?c:Z.imageZ;d="undefined"!==typeof d&&null!==d?Math.round(d):Math.round(Z.imageR);0>d&&(d+=360);var g=a,f=b;"image"==e&&(b=h.convertImageCoordsToViewportEdgeCoords(a,b,c,d),a=b.x,b=b.y);var n=Z.imageW,l=Z.imageH,k=Math.round(n*
c),y=Math.round(l*c);Math.round(n*c/2);Math.round(l*c/2);var n=N,l=P,O=Math.round(.1*N),q=Math.round(.1*P),v=Math.round(.5*N),m=Math.round(.5*P),A,r;A=v-Ta+(Z.imageCtrX-Z.imageX)*c+a;r=m-Ua+(Z.imageCtrY-Z.imageY)*c+b;var p=A+k/2,t=r-y/2,cc=A+k/2,u=r+y/2,H=A-k/2,Ea=r+y/2,w=Z.Utils.getPositionRotated(A-k/2,r-y/2,A,r,d),p=Z.Utils.getPositionRotated(p,t,A,r,d),cc=Z.Utils.getPositionRotated(cc,u,A,r,d),Ea=Z.Utils.getPositionRotated(H,Ea,A,r,d);A=Math.min(w.x,p.x,cc.x,Ea.x);r=Math.min(w.y,p.y,cc.y,Ea.y);
H=Math.max(w.x,p.x,cc.x,Ea.x);w=Math.max(w.y,p.y,cc.y,Ea.y);H-A>n||!Z.constrainPanStrict?3==Z.constrainPanLimit?a=0<A?a-A:H<n?a-(H-n):a:2==Z.constrainPanLimit?a=A>v?a-(A-v):H<v?a-(H-v):a:1==Z.constrainPanLimit&&(a=A>9*O?a-(A-9*O):H<O?a-(H-O):a):a=A>v-k/2?a-(A-(v-k/2)):H<v+k/2?a-(H-(v+k/2)):a;w-r>l||!Z.constrainPanStrict?3==Z.constrainPanLimit?b=0<r?b-r:w<l?b-(w-l):b:2==Z.constrainPanLimit?b=r>m?b-(r-m):w<m?b-(w-m):b:1==Z.constrainPanLimit&&(b=r>9*q?b-(r-9*q):w<q?b-(w-q):b):b=r>m-y/2?b-(r-(m-y/2)):
w<m+y/2?b-(w-(m+y/2)):b;"image"==e&&(b=h.convertViewportEdgeCoordsToImageCoords(a,b,c,d),a=b.x,b=b.y);if(a!=g||b!=f)a=Math.round(a),b=Math.round(b),Z.Utils.validateCallback("panConstrained")}return new Z.Utils.Point(a,b)}function q(a){a>Z.maxZ?(a=Z.maxZ,Z.Utils.validateCallback("zoomConstrainedMax")):a<Z.minZ&&(a=Z.minZ,Z.Utils.validateCallback("zoomConstrainedMin"));return a}function H(a){Z.rotationFree||(a=90*Math.round(Math.abs(a)/90)*Z.Utils.getSign(a));-360>=a?a+=360:360<=a&&(a-=360);return a}
function Ea(){Z.comparison&&0!=Oa?Z.Navigator2&&Z.Navigator2.syncToViewport():Z.Navigator&&Z.Navigator.syncToViewport()}function nd(a){if(0<uc){var b=Z.Utils.arrayIndexOf(bc,a.name);-1!=b&&(bc=Z.Utils.arraySplice(bc,b,1),hb=Z.Utils.arraySplice(hb,b,1));bc[bc.length]=a.name;hb[hb.length]=a}}function Ob(){window.clearTimeout(Zc);Zc=null;Hc=((new Date).getTime()-tilesTimeStart)/1E3;var a=Md*Hc,a=wc&&vc<a,b=wc&&vc>=qd;if(2==Z.debug||3==Z.debug)Z.Utils.trace("View validation-time elapsed: "+Hc),0<wc&&
(a?Z.Utils.trace("Loading delay - re-calling updateView"):b?Z.Utils.trace("Display delay - re-calling updateView"):Z.Utils.trace("Progress slow, resetting timer")),Z.Utils.trace(""),Z.traces.scrollTop=Z.traces.scrollHeight,Z.Utils.traceTileSpeed(Hc,Md);0<wc?Nd<yf?a||b?(Nd+=1,h.updateView(!0)):Zc=window.setTimeout(Ob,Ke):console.log(Z.Utils.getResource("ERROR_VALIDATEVIEW")):(Nd=0,Z.Utils.validateCallback("viewUpdateComplete"),Z.Utils.validateCallback("viewUpdateCompleteGetLabelIDs"))}function Pb(){var a=
Z.imageX!=Z.priorX||Z.imageY!=Z.priorY||Z.imageZ!=Z.priorZ||Z.imageR!=Z.priorR;!Z.preventDupCall&&a&&(Z.priorX=Z.imageX,Z.priorY=Z.imageY,Z.priorZ=Z.imageZ,Z.priorR=Z.imageR);Z.preventDupCall="undefined"!==typeof called&&null!==called}function ba(a,b,c,d,e,g){g||h.zoomAndPanAllStop();Z.maskingSelection&&Z.maskClearOnUserAction&&h.clearMask();if("undefined"===typeof a||null===a)a=Z.imageX;if("undefined"===typeof b||null===b)b=Z.imageY;if("undefined"===typeof c||null===c)c=Z.imageZ;if("undefined"===
typeof d||null===d)d=Z.imageR;if("center"==a||isNaN(parseFloat(a)))a=Z.imageCtrX;if("center"==b||isNaN(parseFloat(b)))b=Z.imageCtrY;if(-1==c||isNaN(parseFloat(c)))c=Z.fitZ;"undefined"===typeof c||null===c?c=Z.fitZ:1<c&&c>Z.maxZ&&(c/=100);if("undefined"===typeof d||null===d)d=Z.imageR;c=q(c);d=H(d);a=jb(a,b,c,d,"image");Z.imageX=fe=a.x;Z.imageY=ge=a.y;Z.imageZ=c;d!=Z.imageR&&Z.Utils.rotateElement(E,d);Z.imageR=d;h.updateView(!0);"function"===typeof e&&e()}function g(){if(nc&&(0!=pb||0!=qb||0!=kb))if(Z.tracking&&
0==kb)h.zoomAndPanToView(h.getX()+pb,h.getY()+qb);else{var a=pb,b=qb,c=kb,d=h.getZoom();0!=c&&(d=ka(Q,W*(1+c)),d=q(d),d!=Z.imageZ&&cc(d));if(0!=a||0!=b)a=parseFloat(E.left)+a,b=parseFloat(E.top)+b,d=jb(a,b,d,Z.imageR,"container"),E.left=Math.round(d.x)+"px",E.top=Math.round(d.y)+"px",b=d.x-Ta,d=d.y-Ua,S&&za&&(Z.mobileDevice||Math.abs(b)>N/2||Math.abs(d)>P/2)&&v(S,db,Da,"simple",!1,"Updating backfill oversize display");M&&30<M.length?0==he%2&&h.syncViewportRelated():h.syncViewportRelated();he++;nc=
window.setTimeout(g,ie)}}function O(a,b,c,d,e,g,f){if(Z.zoomAndPanInProgressID==a.toString()+"-"+b.toString()+"-"+c.toString()+"-"+d.toString()){$c++;var n=e/g,l=$c*n,k=Z.Utils.easing(Z.imageX,a,l,e),q=Z.Utils.easing(Z.imageY,b,l,e),m=Z.Utils.easing(Z.imageZ,c,l,e),l=Z.Utils.easing(Z.imageR,d,l,e),q=h.convertImageCoordsToViewportEdgeCoords(k,q,m),k=q.x,q=q.y,A=!1,r=syncOversize=!1;if(parseFloat(E.left)!=k||parseFloat(E.top)!=q)E.left=k+"px",E.top=q+"px",r=!0,S&&za&&(syncOversize=!0);m!=Z.imageZ&&
(cc(m,!1),A=r=!0,S&&za&&(ya.restore(),ya.save(),ya.scale(Ga,Ga),syncOversize=!0));l!=Z.imageR&&(Z.Utils.rotateElement(E,l),S&&za&&(ya.rotate((l-Z.imageR)*Math.PI/180),syncOversize=!0),Z.imageR=l,r=!0);syncOversize&&v(S,db,Da,"simple",!1,"Updating backfill oversize display");h.syncViewportRelated(!1,M&&40>M.length,!1,!1,!1);0==$c%2&&h.syncViewportRelated(!1,!1,A,r,A);m=Z.tour&&Z.tourStop&&0==Math.round(Z.imageR%90);$c<g+1&&!m?rd=window.setTimeout(function(){O(a,b,c,d,e,g,f)},n):(m&&(Z.tourPlaying=
!1),Z.interactive=!0,y(),h.updateView(),h.toggleWatermarks(!0),M&&39<M.length&&h.setHotspotsVisibility(!0),"function"===typeof f&&f())}}function k(){he=kb=qb=pb=0;nc&&(window.clearTimeout(nc),nc=null)}function y(){if(null!==Z.zoomAndPanInProgressID||rd)Z.zoomAndPanInProgressID=null,$c=Od,window.clearTimeout(rd),rd=null}function cc(a,b){var c=!1,d=ua(Q,a);if(d!=W){W=d;var c=d/rb,e=Y*c,g=da*c,f=(Y-e)/2,n=(da-g)/2;d<rb&&(d=jb(parseFloat(E.left),parseFloat(E.top),a,Z.imageR,"container"),E.left=d.x+"px",
E.top=d.y+"px");if(Z.useCanvas)if(X.width=e+"px",X.height=g+"px",X.left=f+"px",X.top=n+"px",Xa&&(mb.width=e+"px",mb.height=g+"px",mb.left=f+"px",mb.top=n+"px"),Pa&&(Qa.width=e+"px",Qa.height=g+"px",Qa.left=f+"px",Qa.top=n+"px"),Ra&&(Sa.width=e+"px",Sa.height=g+"px",Sa.left=f+"px",Sa.top=n+"px"),Ga=ua(db,h.getZoom()),d=8<Ga,za||d){if(null!==ya&&"undefined"===typeof b||null===b||b&&S&&("in"!=Z.zooming||e>Z.scaleThreshold||g>Z.scaleThreshold))ya.restore(),ya.save(),ya.scale(Ga,Ga),ya.rotate(Z.imageR*
Math.PI/180),v(S,db,Da,"simple",!1,"Updating backfill oversize display");lb=c=ua(na,a);e=c/tierBackfillScalePrior;c=Xb*e;e*=Yb;g=zb+(Xb-c)/2;d=Ab+(Yb-e)/2;J.width=c+"px";J.height=e+"px";J.left=g+"px";J.top=d+"px"}else S&&Z.Utils.clearDisplay(S),e=Xb*c,g=Yb*c,f=zb+Z.imageX*(1-c)*Z.imageZ,n=Ab+Z.imageY*(1-c)*Z.imageZ,J.width=e+"px",J.height=g+"px",J.left=f+"px",J.top=n+"px";else v(ga,Q,hb,"centerOut",!1,"Scaling: non-canvas zoom"),za?(c=Ge,Xb=Y*c,Yb=da*c,zb=-(Y/c),Ab=-(da/c),$d=ub*c,ae=vb*c,ca.width=
Xb,ca.height=Yb,J.width=ca.width+"px",J.height=ca.height+"px"):(c=La[na],ca.width=Ca[na],ca.height=c,c=Z.imageY*a,zb=ub-Z.imageX*a,Ab=vb-c),J.left=zb+"px",J.top=Ab+"px",v(ca,na,Da,"simple",!1,"Scaling: non-canvas zoom - backfill");c=!0}return c}function Le(){if(Ic&&0!=Qb){var a=Z.Utils.arrayIndexOfObjectValue(M,"internalID",va);if(-1!=a){var a=M[a],b=a.yScale*(1+Qb);h.modifyLabel(va,"xScale",a.xScale*(1+Qb),!0,!0);h.modifyLabel(va,"yScale",b,!1,!0);Ic=window.setTimeout(Le,Me)}}}function zf(){h.toggleFullViewMode(!1)}
function Ne(){Jc&&0!=Kc&&(h.rotateStep(Kc,!1),Jc=window.setTimeout(Ne,Oe),h.syncViewportRelated(!1,M&&40>M.length,!1,!0,!1))}function Eb(a){a=Z.Utils.event(a);var b=a.type;if(a&&b){var c=!xc&&("polygon"==Z.labelMode||"measure"==Z.labelMode),d=Z.Utils.isRightMouseButton(a),e=a.altKey;if("mouseover"!=b&&"mouseout"!=b&&!Z.interactive||"mousedown"==b&&(!Z.interactive||Z.coordinatesVisible&&e)||d&&!c)Z.tourStop=!0;else{if("mousedown"==b||"touchstart"==b||Z.tourPlaying&&Z.tourStop)h.zoomAndPanAllStop(),
Z.tour&&h.tourStop(),Z.tourStop=!0,Z.interactive=!0;Z.touchSupport&&!Z.clickZoomAndPanBlock&&"touchmove"!=b&&"gesturechange"!=b&&a.preventDefault();if("mousedown"==b)window.setTimeout(function(){h.zoomAndPanAllStop(!1,!0)},1),Z.maskingSelection&&Z.maskClearOnUserAction&&h.clearMask();else if("touchstart"==b||"gesturestart"==b)c=!1,fb=Z.Utils.getFirstTouch(a),"undefined"!==typeof fb&&null!==fb&&(d=sd(fb.target),null===d?c=!0:(d=d.id.substring(3,d.id.length),d=Z.Utils.arrayIndexOfObjectValue(M,"internalID",
d),-1!=d&&(d=M[d],null!==d&&"function"==d.clickURL&&(c=!0)))),c&&a.preventDefault(),h.zoomAndPanAllStop(!1,!0),Z.maskingSelection&&Z.maskClearOnUserAction&&h.clearMask();switch(b){case "mouseover":Z.fullView||"TEXTAREA"==document.activeElement.tagName||Z.Viewer.initializeViewerKeyDefaultListeners(!0);break;case "mousedown":!Z.fullView&&document.activeElement&&document.activeElement.blur();Z.Viewer.initializeViewerKeyEventListeners(!0);Z.Utils.addEventListener(document,"mousemove",Eb);Z.Utils.addEventListener(document,
"mouseup",Eb);break;case "mouseup":("undefined"===typeof xc||xc)&&Z.Utils.removeEventListener(document,"mousemove",Eb),Z.Utils.removeEventListener(document,"mouseup",Eb)}Af(a);if("mousedown"==b||"mousemove"==b)return!1}}}function Af(b){var c=Oa.toString();Z.annotations&&resetAnnotationPanel();b=Z.Utils.event(b);var d=b.type,e=b.altKey;if(b&&d){var g;if("touchstart"==d||"touchmove"==d||"touchend"==d||"touchcancel"==d){if(fb=Z.Utils.getFirstTouch(b))g=fb.target,Va=new Z.Utils.Point(fb.pageX,fb.pageY);
Z.gestureSupport||(Lc=Z.Utils.getSecondTouch(b))&&(je=new Z.Utils.Point(Lc.pageX,Lc.pageY))}else g=Z.Utils.target(b),Z.Utils.relatedTarget(b),Z.Utils.isRightMouseButton(b),"resize"!=d&&(Va=Z.Utils.getMousePosition(b));Z.smoothPan&&Va&&(dc=Va);var f=h.getZoom(),n=(100*f).toString(),d=Va?h.getClickCoordsInImage(b,f,Va):null;je&&!Z.gestureSupport&&h.getClickCoordsInImage(b,f,je);var l=b.type,k=b.touches&&1<b.touches.length,y=null;if("gesturestart"==l||"gesturechange"==l||"gestureend"==l)y=l;else if(!ad)if(("mousedown"==
l||"touchstart"==l)&&!yc)y=k?"pinchstart":"start";else if("mousemove"==l||"touchmove"==l)k||Pd||yc||Qd?k&&(y="pinchchange"):y="move";else if("mouseup"==l||"touchend"==l||"touchcancel"==l)y=k||Pd||yc||Qd?"pinchend":"end";td=y;switch(td){case "start":y=g;f=null;if(Z.interactive)if(!M&&(Z.clickZoom||Z.clickPan||Z.mousePan))f="navigateImage";else{var l="function"!==typeof Z.externalEditPermissionFunction||Z.externalEditPermissionFunction(),k=null!==Z.editMode||"measure"==Z.labelMode,O=!e&&("addLabel"==
Z.editing||"editLabel"==Z.editing),k=l&&k&&O,O=sd(y),y=ke(d,Z.labelMode);if(null!==O&&null===y&&xc)y=h.getLabelEditable(O.internalID),k&&y?f="editLabel":l&&Z.labelClickSelect&&(f="selectLabel");else if(null!==y&&(k||!k&&"measure"==Z.labelMode))l=Z.Utils.arrayIndexOfObjectValue(M,"internalID",va),-1!=l&&(f=M[l],f=f.polyClosed||0!=y||2>=f.polygonPts.length||xc?"editControlPoint":"completeLabelPolygon");else if(0==le)"fieldofview"==Z.labelMode||"text"==Z.labelMode||"counter"==Z.labelMode?f="createLabelSimple":
"shape"==Z.labelMode?f="createLabelShape":!xc||"editLabel"==Z.editing||"freehand"!=Z.labelMode&&"polygon"!=Z.labelMode&&"measure"!=Z.labelMode||(f="createLabelAndControlPoint"),"counter"!=Z.labelMode&&(le=1);else if(0!=le&&!xc)f=e?"completeLabelPolygon":"z489";else if("view"==Z.labelMode&&e&&Z.zoomRectangle)f="zoomRectangleImage";else if(Z.clickZoom||Z.clickPan||Z.mousePan)e||"view"==Z.labelMode||h.setEditModeLabel("view",null,null,null,!1,null),f="navigateImage"}ud=f;bd=new Z.Utils.Point(Va.x,Va.y);
Pe=(new Date).getTime();Z.mouseIsDown=!0;Z.altKeyIsDown=e;f=Z.captionPosition?Z.captionPosition:"8";Pd=Qd=!1;switch(ud){case "navigateImage":Z.comparison&&-1!=g.id.indexOf("viewportDisplay")&&Z.Viewer.viewportSelect(parseInt(g.id.substring(g.id.indexOf("viewportDisplay")+15,g.id.length)));Z.smoothPan?1<Z.smoothPanEasing&&(vd(void 0),wd=bd,null===Mc&&(Mc=new Z.Utils.Point(parseFloat(E.left),parseFloat(E.top))),null===Nc&&(Nc=window.setInterval(Bf,50))):(fa.mouseXPrior=Va.x,fa.mouseYPrior=Va.y);break;
case "zoomRectangleImage":me=!0;b=(100*h.getZoom()).toString();Qe=va;va=M.length.toString();h.createHotspotFromParameters("zoomRectangle",null,"polygon","polygon",null,d.x.toString(),d.y.toString(),b,null,null,null,null,null,"0","0",null,null,null,null,null,null,xd,null,ne,null,null,null,null,null,null,"8","0",va,"0",null,null,"1",[{x:d.x,y:d.y},{x:d.x+1,y:d.y},{x:d.x+1,y:d.y+1},{x:d.x,y:d.y+1}],null,null,null,null,"1",null,null,null,null,null,null,null);Oc=2;if("none"==Jb.display||"none"==Sa.display||
"none"==Qa.display)Jb.display=Sa.display=Qa.display="inline-block",Z.Utils.addEventListener(Vb,"mousedown",Z.Utils.preventDefault);break;case "createLabelSimple":"fieldofview"==Z.labelMode?h.createLabelFromParameters(null,null,Z.labelMode,null,null,Z.imageX.toString(),Z.imageY.toString(),n,N,P,null,null,null,"0","0",null,null,null,"FOV",null,null,xd,null,null,null,null,null,null,null,null,"5","0",null,null):"counter"==Z.labelMode?h.createLabelCounter(d):h.createLabelFromParameters(null,null,Z.labelMode,
null,null,d.x.toString(),d.y.toString(),n,null,null,null,null,null,"0","0",null,null,null,null,null,null,xd,null,null,null,null,null,null,null,null,"5","0",null,null);"counter"!=Z.labelMode&&h.updateAnnotationPanelForNewLabel();break;case "createLabelShape":if(b=document.getElementById("labelShapeList"+c))h.createLabelFromParameters(null,null,Z.labelMode,b[b.selectedIndex].value,null,d.x.toString(),d.y.toString(),n,null,null,null,null,null,"0","0",null,null,null,null,null,null,xd,null,ne,Cf,null,
null,null,null,null,f,"0",null,null),h.updateAnnotationPanelForNewLabel(),updateShapeSize(va);break;case "createLabelAndControlPoint":b=[];b[0]={x:d.x,y:d.y};xc=polygonClosed=!1;"freehand"==Z.labelMode?ud="z489":null===Z.editMode&&"measure"==Z.labelMode&&0<M.length&&h.deleteAllMeasureHotspots();h.createLabelFromParameters(null,null,Z.labelMode,"polygon",null,d.x.toString(),d.y.toString(),n,null,null,null,null,null,"0","0",null,null,null,null,null,null,xd,null,ne,null,null,null,null,null,null,f,"0",
null,null,null,null,"0",b,null,null,null,null,null,"1");h.updateAnnotationPanelForNewLabel();break;case "z489":z489(va,!1,d,!0);break;case "selectLabel":(wa=sd(g))&&Re(wa.id.substring(3,wa.id.length));break;case "completeLabelPolygon":e&&z489(va,!1,d,!0);case "editLabel":if(wa=sd(g))d=("shape"==Z.labelMode||"polygon"==Z.labelMode||"measure"==Z.labelMode)&&null!==va||"shape"==Z.labelMode&&null===va?ke(d,Z.labelMode):null,"addLabel"==Z.editing&&("shape"==Z.labelMode&&null===d||"freehand"==Z.labelMode)&&
h.saveEditsLabel(!0,!1,!1),oe(b,bd,td),Re(wa.id.substring(3,wa.id.length),!1);break;case "editControlPoint":Oc=ke(d,Z.labelMode)}break;case "move":new Z.Utils.Point(Va.x,Va.y);n=(d.x-Z.imageX)*f;c=(d.y-Z.imageY)*f;switch(ud){case "navigateImage":Nc?dc=Va:(b=Va,Z.animation&&h.getZoom()==Z.minZ||(n=b.x-fa.mouseXPrior,d=b.y-fa.mouseYPrior,isNaN(n)||isNaN(d)?(b.x>fa.mouseXPrior?Z.Viewer.viewportNext():b.x<fa.mouseXPrior&&Z.Viewer.viewportPrior(),fa.mouseXPrior=b.x,fa.mouseYPrior=b.y):(n=parseFloat(E.left)+
n,d=parseFloat(E.top)+d,c=jb(n,d,Z.imageZ,Z.imageR,"container"),E.left=c.x+"px",E.top=c.y+"px",fa.mouseXPrior=b.x,fa.mouseYPrior=b.y,n=c.x-Ta,d=c.y-Ua,S&&za&&(Z.mobileDevice||Math.abs(n)>N/2||Math.abs(d)>P/2)&&v(S,db,Da,"simple",!1,"Updating backfill oversize display"),b=h.calculateCurrentCenterCoordinates(c,Z.imageZ,Z.imageR),Z.Navigator&&Z.Navigator.z658(b),Z.Utils.setBookmarksURL(),Z.Viewer.syncComparisonViewport(),Z.Viewer.syncOverlayViewports(null,a),Z.tracking&&h.syncTrackingToViewport())));
break;case "zoomRectangleImage":pe(va,Oc,d);break;case "createLabelAndControlPoint":z516(n,c,d);break;case "z489":"freehand"==Z.labelMode?Z.mouseIsDown&&z511(yd,cd,n,c,d):z516(n,c,d);break;case "editLabel":oe(b,Va,td);updateLabelPositionOnCanvas(b,wa,Va);break;case "editControlPoint":updateShapeOrPolygon(va,Oc,d)}break;case "end":Z.mouseIsDown=!1;switch(ud){case "navigateImage":Se(b,Va,f,e);break;case "zoomRectangleImage":Se(b,Va,f,e);break;case "createLabelSimple":"fieldofview"==Z.labelMode&&h.setEditModeLabel("view");
break;case "z489":"freehand"==Z.labelMode&&(h.setEditModeLabel("freehand"),z474(va,!1),yd=cd=null);break;case "completeLabelPolygon":z474(va,!e);break;case "editLabel":oe(b,Va,td);break;case "editControlPoint":updateShapeOrPolygon(va,Oc,d)}break;case "gesturestart":b=Z.Utils.event(b);b.preventDefault();qe=Math.round(100*b.scale)/100;ad||(ad=window.setInterval(Te,Df));break;case "gesturechange":qe=Math.round(100*b.scale)/100;Te(b);break;case "gestureend":ad&&(window.clearInterval(ad),Pd=!0,ad=null);
Z.mousePan&&h.updateView();break;case "pinchstart":re=Z.Utils.calculatePointsDistance(fb.clientX,fb.clientY,Lc.clientX,Lc.clientY);if(d=Z.Utils.event(b))d.preventDefault(),b=Z.Utils.getFirstTouch(d),d=Z.Utils.getSecondTouch(d),"undefined"!==typeof b&&"undefined"!==typeof d&&(b=Z.Utils.calculatePointsDistance(b.clientX,b.clientY,d.clientX,d.clientY),se=Math.round(re/b*100)/100);yc||(yc=window.setInterval(Ue,Ef));break;case "pinchchange":d=Z.Utils.calculatePointsDistance(fb.clientX,fb.clientY,Lc.clientX,
Lc.clientY);se=Math.round(d/re*100)/100;Ue(b);break;case "pinchend":yc&&(window.clearInterval(yc),Qd=!0,yc=null),Z.mousePan&&h.updateView()}}}function sd(a){if("undefined"===typeof a||null===a)a=document.getElementById("progressTextBox");var b=null;-1!=a.id.indexOf("hot")&&-1==a.id.indexOf("hotspotDisplay")?b=a:a.parentNode&&-1!=a.parentNode.id.indexOf("hot")&&-1==a.parentNode.id.indexOf("hotspotDisplay")?b=a.parentNode:a.parentNode.parentNode&&-1!=a.parentNode.parentNode.id.indexOf("hot")&&-1==a.parentNode.parentNode.id.indexOf("hotspotDisplay")?
b=a.parentNode.parentNode:a.parentNode.parentNode.parentNode&&-1!=a.parentNode.parentNode.parentNode.id.indexOf("hot")&&-1==a.parentNode.parentNode.parentNode.id.indexOf("hotspotDisplay")&&(b=a.parentNode.parentNode.parentNode);return b}function ke(a,b){var c=null;if(M)for(var d=(te+1)/Z.imageZ,e=0,g=M.length;e<g;e++){var f=M[e];if("freehand"!=f.mediaType&&f.internalID==va&&("shape"==f.mediaType||"polygon"==f.media)&&"undefined"!==typeof f.polygonPts&&null!==f.polygonPts)for(var n=f.polygonPts.slice(0),
f=0==f.rotation?a:Z.Utils.rotatePointOffCenter(f.x,f.y,a.x,a.y,-f.rotation),l=0,k=n.length;l<k;l++){var y=n[l];if(Z.Utils.calculatePointsDistance(f.x,f.y,y.x,y.y)<d){c=l;break}}}return c}function pe(a,b,c,d,e){me&&(d?(b=M[a].polygonPts,M.splice(a,1),me=null,va=Qe,Z.measureVisible||Z.tour||Z.hotspots||Z.annotations||(Jb.display=Sa.display=Qa.display="none",Z.Utils.removeEventListener(Vb,"mousedown",Z.Utils.preventDefault)),e||h.zoomAndPanToZoomRectangle(b)):updateShapeOrPolygon(a,b,c))}function oe(a,
b,c){"start"==c?(a=h.z480(a.clientX,a.clientY),wa.mouseXPrior=b.x,wa.mouseYPrior=b.y,wa.mouseXOffset=a.x-parseFloat(wa.style.left),wa.mouseYOffset=a.y-parseFloat(wa.style.top),wa.style.zIndex=M.length+1):"move"==c?(wa.style.left=parseFloat(wa.style.left)+b.x-wa.mouseXPrior+"px",wa.style.top=parseFloat(wa.style.top)+b.y-wa.mouseYPrior+"px",wa.mouseXPrior=b.x,wa.mouseYPrior=b.y):"end"==c&&(wa.style.zIndex=wa.zIndex,wa=null)}function Re(a,b){if(va&&a){var c=Z.Utils.arrayIndexOfObjectValue(M,"internalID",
a);if(-1!=c){var d=M[c];d.editable?Z.labelMode!=d.mediaType&&null!==Z.editMode&&h.setEditModeLabel(d.mediaType,!0,d.media,!0,b):h.setEditModeLabel("view")}va!=a&&(z632("save","labels"),d&&z614(d.poiID,d.internalID),Z.Utils.validateCallback("labelSelectedInViewportGetIDs"))}dd&&(Z.hotspotListTitle||Z.tourListTitle)&&(dd.selectedIndex=0)}function Se(a,b,c,d){document.mousemove=null;document.mouseup=null;var e=(new Date).getTime();b=Z.mouseOutDownPoint?Z.mouseOutDownPoint:new Z.Utils.Point(b.x,b.y);
clickPt=h.getClickCoordsInImage(a,c,Z.mouseOutDownPoint);c=Z.Utils.calculatePointsDistance(bd.x,bd.y,b.x,b.y);e-=Pe;if(c<Ff&&e<oc||!d&&("shape"==Z.labelMode||"freehand"==Z.labelMode)){if(Z.clickZoom||Z.clickPan)var g=h.getClickZoomCoords3D(a,bd,Q,W,ed&&Z.doubleClickZoom?!0:!1);Z.clickZoom?Z.doubleClickZoom?ed?(clearTimeout(ed),ed=null,h.zoomAndPanToView(g.x,g.y,g.z)):ed=setTimeout(function(a){ed=null;h.zoomAndPanToView(g.x,g.y,g.z)},Z.doubleClickDelay):window.setTimeout(function(){h.zoomAndPanToView(g.x,
g.y,g.z)},1):Z.clickPan&&h.zoomAndPanToView(g.x,g.y,Z.imageZ);pe(va,Oc,clickPt,!0,!0)}else"view"==Z.labelMode&&(d||Z.altKeyIsDown)&&Z.zoomRectangle?pe(va,Oc,clickPt,!0):Z.mousePan&&!Z.smoothPan&&h.updateView()}function vd(a){null!==Nc&&a&&(window.clearInterval(Nc),Nc=null);Mc=zd=Ad=Ka=null;bb=cb=Cb=Db=0}function Bf(){if(Z.animation&&h.getZoom()==Z.minZ){Z.animationCount++;null===Bd&&(Bd=parseFloat(E.left));null===Cd&&(Cd=parseFloat(E.top));var b=Bd,c=Cd;if(Z.mouseIsDown||Ka){var d=(Ka?zd:dc.x)-wd.x,
e=(Ka?Ad:dc.y)-wd.y,g=b-Mc.x,f=c-Mc.y;if(!(isNaN(d)||isNaN(e)||isNaN(g)||isNaN(f)||0==d&&0==e&&0==g&&0==f)){var n=Ka?Z.smoothPanGlide:1,l=Ka?1:100;bb=Math.round((d-g)/(Z.smoothPanEasing*n)*l/l);cb=Math.round((e-f)/(Z.smoothPanEasing*n)*l/l);Z.mouseIsDown?(Cb=bb,Db=cb):(Math.abs(bb)>Math.abs(Cb)&&(bb=Cb),Math.abs(cb)>Math.abs(Db)&&(cb=Db));c+=cb;Bd=b+bb;Cd=c;var k,y,O,q;"motion"==Z.animator?(k="horizontal"==Z.animationAxis?bb:cb,dimensionAxis="horizontal"==Z.animationAxis?N:P,y=Math.round(Gf/Z.imageSetLength),
O=k/40,q=0):"position"==Z.animator&&(k="horizontal"==Z.animationAxis?g:f,dimensionAxis="horizontal"==Z.animationAxis?N:P,y=Math.max(0,Math.round((dimensionAxis/2-Math.abs(k))/Hf)),O=0,q="horizontal"==Z.animationAxis?N/10:P/10);0==y&&y++;0==Z.animationCount%y&&(k<-q?Z.Viewer.viewportPrior(O):k>q&&Z.Viewer.viewportNext(O));Ka&&0==Math.round(bb*l)/l&&0==Math.round(cb*l)/l&&(Ka=!1)}}else if(Z.mouseIsDown||null!==Ka||0==bb||0==cb)vd(!0),Cd=Bd=null;else if(0!=Cb||0!=Db)zd=dc.x+Cb,Ad=dc.y+Db,Ka=!0}else if(f=
parseFloat(E.left),g=parseFloat(E.top),Z.mouseIsDown||Ka)l=(Ka?zd:dc.x)-wd.x,k=(Ka?Ad:dc.y)-wd.y,y=f-Mc.x,O=g-Mc.y,isNaN(l)||isNaN(k)||isNaN(y)||isNaN(O)||0==l&&0==k&&0==y&&0==O||(q=Ka?Z.smoothPanGlide:1,b=Ka?1:100,bb=Math.round((l-y)/(Z.smoothPanEasing*q)*b/b),cb=Math.round((k-O)/(Z.smoothPanEasing*q)*b/b),Z.mouseIsDown?(Cb=bb,Db=cb):(Math.abs(bb)>Math.abs(Cb)&&(bb=Cb),Math.abs(cb)>Math.abs(Db)&&(cb=Db)),f+=bb,g+=cb,l=jb(f,g,Z.imageZ,Z.imageR,"container"),E.left=l.x+"px",E.top=l.y+"px",bb-=f-l.x,
cb-=g-l.y,S&&za&&v(S,db,Da,"simple",!1,"Updating backfill oversize display"),Ka&&0==Math.round(bb*b)/b&&0==Math.round(cb*b)/b&&(Ka=!1),b=h.calculateCurrentCenterCoordinates(l,Z.imageZ,Z.imageR),Z.comparison&&0!=Oa?Z.Navigator2&&Z.Navigator2.z658(b):Z.Navigator&&Z.Navigator.z658(b),Z.comparison&&Z.Viewer.syncComparisonViewport(),Z.overlays&&Z.Viewer.syncOverlayViewports(null,a),Z.tracking&&h.syncTrackingToViewport(),Z.Utils.validateCallback("viewChanging"),Z.Utils.validateCallback("viewPanningGetCurrentCoordinates"),
Z.Utils.validateCallback("viewChangingGetCurrentCoordinatesFull"));else if(Z.mouseIsDown||null!==Ka||0==bb||0==cb)vd(!0),h.updateView();else if(l=jb(f+Cb,g+Db,Z.imageZ,Z.imageR,"container"),Cb=l.x-f,Db=l.y-g,0!=Cb||0!=Db)zd=dc.x+Cb,Ad=dc.y+Db,Ka=!0}function Te(a){Z.clickZoom&&(a=ka(Q,rb*qe),a=q(a),a!=Z.imageZ&&h.scaleTierToZoom(a))}function Ue(a){Z.clickZoom&&(a=ka(Q,rb*se),a=q(a),a!=Z.imageZ&&h.scaleTierToZoom(a))}function r(a){if(a=Z.Utils.event(a)){var b;if(Z.geoCoordinatesVisible){if(b="",If&&
Jf&&Kf&&Lf){var c=h.getClickCoordsInImage(a);b=convertPixelsToLatitudeLongitudeString(c)}}else if("IIIFImageServer"==Z.tileSource)c=h.getClickCoordsInImage(a),"mousemove"==a.type?b=h.getViewCoordinatesIIIFString(null,c,"show"):"mousedown"==a.type&&a.altKey&&(b=h.getViewCoordinatesIIIFString(null,c,"save")+"\n");else{c=Z.Utils.event(a);b=h.getZoom();var d=h.getClickCoordsInImage(c,b),c=Math.round(d.x).toString(),d=Math.round(d.y).toString();b=(Math.round(1E3*b)/10).toString();b='X="'+c+'"   Y="'+d+
'"   ZOOM="'+b+'"'}"mousemove"==a.type?Z.Utils.showCoordinates(b):"mousedown"==a.type&&a.altKey&&Z.Utils.saveCoordinates(b)}}var jd,ec,fc,Ub,fe=null,ge=null,Oa=0;"undefined"!==typeof a&&null!==a&&(Oa=a);var wb;wb="undefined"!==typeof b&&null!==b?b:Z.imagePath;"undefined"===typeof d||null===d?ec=jd=Z.hotspotPath:(ec=jd=d,".xml"==ec.toLowerCase().substring(ec.length-4,ec.length)&&(ec=ec.substring(0,ec.lastIndexOf("/"))));"undefined"===typeof c||null===c?(fc=Z.annotationPath,Ub=Z.annotationFolder):(Ub=
fc=c,".xml"==Ub.toLowerCase().substring(Ub.length-4,Ub.length)&&(Ub=Ub.substring(0,Ub.lastIndexOf("/"))));"undefined"===typeof e||null===e?(trackingPath=Z.trackingPath,trackingFolder=Z.trackingFolder):(trackingFolder=trackingPath=e,".xml"==trackingFolder.toLowerCase().substring(trackingFolder.length-4,trackingFolder.length)&&(trackingFolder=trackingFolder.substring(0,trackingFolder.lastIndexOf("/"))));"undefined"===typeof f||null===f?(imageListPath=Z.imageListPath,imageListFolder=Z.imageListFolder):
(imageListFolder=imageListPath=f,".xml"==imageListFolder.toLowerCase().substring(imageListFolder.length-4,imageListFolder.length)&&(imageListFolder=imageListFolder.substring(0,imageListFolder.lastIndexOf("/"))));"undefined"!==typeof jd&&Z.Utils.stringValidate(jd)?(Z.hotspots=!0,Z.annotationPathProvided=!0,Z.imageSet&&(Z.hotspotPath="multiple")):"undefined"!==typeof fc&&Z.Utils.stringValidate(fc)&&(Z.annotationPath=Z.Utils.stringRemoveTrailingSlash(fc),Z.annotationFolder=Z.annotationPath,".xml"==Z.annotationPath.toLowerCase().substring(Z.annotationPath.length-
4,Z.annotationPath.length)&&(Z.annotationFolder=Z.annotationFolder.substring(0,Z.annotationFolder.lastIndexOf("/"))),Z.annotations=!0,Z.annotationPathProvided=!0,Z.imageSet&&(Z.annotationPath="multiple"));"undefined"!==typeof Z.narrativePath&&Z.Utils.stringValidate(Z.narrativePath)&&(Z.narrative=!0,Z.narrativePathProvided=!0);"undefined"!==typeof trackingPath&&Z.Utils.stringValidate(trackingPath)&&(Z.tracking=!0,Z.trackingPathProvided=!0);"undefined"!==typeof imageListPath&&Z.Utils.stringValidate(imageListPath)&&
(Z.imageListPath=imageListPath,Z.imageList=!0);var h=this,Pc=[],ia=-1,Ed=0,pc=0,Ja=parseInt(Z.Utils.getResource("z90"),10),He=8*Ja,Ie=4*Ja,Rc=0,xa=parseInt(Z.Utils.getResource("z221"),10),Fa=parseInt(Z.Utils.getResource("z219"),10),ue=parseFloat(Z.Utils.getResource("z218")),Mf=ue/2,uc=parseInt(Z.Utils.getResource("z220"),10),Ff=parseInt(Z.Utils.getResource("DEFAULT_MOUSECLICKTHRESHOLDVIEWPORT"),10),oc=parseInt(Z.Utils.getResource("DEFAULT_MOUSECLICKTHRESHOLDTIMEVIEWPORT"),10);parseInt(Z.Utils.getResource("DEFAULT_TOUCHTAPTHRESHOLDVIEWPORT"),
10);parseInt(Z.Utils.getResource("DEFAULT_TOUCHTAPTHRESHOLDTIMEVIEWPORT"),10);var Gb,S,Aa,ya,zc,Hb,ic,la,fa,E,Tc,ca,J,Kb,sc,ga,X,Ba,Uc,eb,Sb,Wb,Vc,Ha,Ib,Vb,Wa,Jb,ld,fd,Ac,Pa,Qa,Dc,Bc,Ra,Sa,Ec,yd,cd,Wc,Xa,mb,Fc,Xc,jc,Cc;x(Oa);var Rb=[],gc=[],sb=[],Sc=[],Fb=[],hc=[],tb=[],kd=[],qc=[],pa=[],rc=[],ta=1,Q=0,na=0,nb,Gc,tc,za=!1,db=0,Yc=!1,W,rb,lb,Ga,Ca=[],La=[],oa=[],Ma=[],Na=[],gb=[],Da=[],qa=[],ib=[],ob=[],Lb=0,$b=0,od=0,yb=0,be=0,ce=0,ee=0,Ve,Kd=0,Ld=0,qd=0,vc=0,pd=0,wc=0,Hc=0,Md=0,kc=[],V=[],hb=[],
bc=[],lc=[],Zb=[],Zc=null,Nd=0,yf=parseInt(Z.Utils.getResource("DEFAULT_VALIDATEVIEWRETRYLIMIT"),10),Ke=parseInt(Z.Utils.getResource("DEFAULT_VALIDATEVIEWRETRYDELAY"),10),Bb=[],sa=[],mc=[],Nb=[],xf=new Z.NetConnector,We=[],Xe=[],Ye=[],Ze=[],Wd=parseInt(Z.Utils.getResource("z81"),10),wf=parseInt(Z.Utils.getResource("z78"),10),Ee=parseInt(Z.Utils.getResource("z80"),10),md=parseInt(Z.Utils.getResource("z77"),10),db=md,Fe=parseInt(Z.Utils.getResource("z79"),10),Hd=parseInt(Z.Utils.getResource("z76"),
10),Id=parseInt(Z.Utils.getResource("z75"),10),Zd=null,Yd=null,Xd=null,Nf=parseFloat(Z.Utils.getResource("z173UNCONVERTED"),10),Of=null!==Z.panBuffer?Z.panBuffer:parseFloat(Z.Utils.getResource("z173"),10),De="unconverted"!=Z.tileSource?Of:Nf,Ge=parseFloat(Z.Utils.getResource("z74"),10),uf=parseFloat(Z.Utils.getResource("DEFAULT_z310SIZEMAXBROWSER"),10),tf=parseFloat(Z.Utils.getResource("DEFAULT_z310SIZEMAXFIREFOX"),10),sf=parseFloat(Z.Utils.getResource("DEFAULT_z310SIZEMAXMOBILE"),10),rf=parseFloat(Z.Utils.getResource("DEFAULT_z310SIZEMAXIMAGESET"),
10),N,P,Fd,Gd,Y,da,ub,vb,Ta,Ua,Xb,Yb,$d,ae,zb,Ab,$e=1==Z.toolbarVisible&&Z.toolbarBackgroundVisible?null!==Z.toolbarH?Z.toolbarH:parseInt(Z.Utils.getResource("DEFAULT_TOOLBARHEIGHT"),10):0;N=Z.viewerW;P=Z.viewerH-$e;Fd=0;Gd=0==Z.toolbarPosition?$e:0;var ed=null,bd,Pe,td=null,ud=null,le="counter"!=Z.labelMode?1:0,fb=null,Va=null,ad=null,qe=null,Pd=!1,Df=parseInt(Z.Utils.getResource("z122"),10),Lc=null,je=null,yc=null,re,se=null,Qd=!1,Ef=parseInt(Z.Utils.getResource("DEFAULT_PINCHTESTDURATION"),10),
Rd=Math.round(parseFloat(Z.Utils.getResource("z176"))*Z.panSpeed),pb=0,qb=0,Bd=null,Cd=null,Gf=parseInt(Z.Utils.getResource("DEFAULT_ANIMATIONOPTIMALMOTIONIMAGES"),10),Hf=parseInt(Z.Utils.getResource("DEFAULT_ANIMATIONOPTIMALPOSITIONDELTA"),10),Nc=null,wd=null,Mc=null,dc=null,bb=0,cb=0,Cb=0,Db=0,Ka=null,zd=null,Ad=null,gd=parseFloat(Z.Utils.getResource("z242"))*Z.zoomSpeed;Z.mobileDevice&&(gd/=2);var kb=0,nc=null,he=0,ie=parseInt(Z.Utils.getResource("z238"),10),de=parseFloat(Z.Utils.getResource("z112"))*
Z.fadeInSpeed,Jd=null,af=parseInt(Z.Utils.getResource("DEFAULT_ROTATIONSTEPDEGREES"),10),Oe=parseInt(Z.Utils.getResource("DEFAULT_ROTATIONSTEPDURATION"),10),Kc=0,Jc=null,Pf=parseFloat(Z.Utils.getResource("z239")),Od=parseFloat(Z.Utils.getResource("z240"));Z.mobileDevice&&(Od/=2);var rd=null,$c=0;if(!Z.fullScreenVisible&&!Z.fullPageVisible)var ve,we,bf,cf,xe,df,hd,ye;Z.crosshairsVisible&&Z.Utils.drawCrosshairs(Z.ViewerDisplay,N,P);if(Z.measureVisible||null!==Z.editMode||Z.annotations)parseFloat(Z.Utils.getResource("DEFAULT_CAPTIONBACKALPHA")),
Z.Utils.getResource("z431"),Z.Utils.getResource("z431TOTAL"),Z.Utils.getResource("z433"),Z.Utils.getResource("z430"),Z.Utils.getResource("z434"),parseInt(Z.Utils.getResource("z154"),10),parseInt(Z.Utils.getResource("z156"),10);if(Z.geoCoordinatesVisible)var Kf,Lf,If,Jf;if(Z.imageFilters)var Je=!1;if(Z.watermarks)var ef=[],ff=[];if(0<Z.magnifierVisible)var gf=[],hf=[],ac=[],jf;null!==Z.imagePath&&(-1!=Z.imagePath.indexOf("zComparisonPath")?(Z.imageSetPath=Z.imagePath.substring(16,Z.imagePath.length),
Z.imageSet=!0,Z.comparison=!0):-1!=Z.imagePath.indexOf("zSlidePath")?(Z.slidePath=Z.imagePath.substring(11,Z.imagePath.length),Z.slideshow=!0):-1!=Z.imagePath.indexOf("zAnimationPath")?(Z.imageSetPath=Z.imagePath.substring(15,Z.imagePath.length),Z.imageSet=!0,Z.animation=!0):-1!=Z.imagePath.indexOf("zSlidestackPath")&&(Z.imageSetPath=Z.imagePath.substring(16,Z.imagePath.length),Z.imageSet=!0,Z.slidestack=!0));if(Z.slideshow){var Ce,qf;parseFloat(Z.Utils.getResource("z211"));Z.slideTransitionTimeout=
null;Z.slideOpacity=0}if(Z.zoomRectangle||Z.measureVisible||Z.tour||Z.hotspots||Z.annotations||Z.tracking){var me=null,Qe=null,M=[],kf=[],lf=[],va=null,wa=null;parseInt(Z.Utils.getResource("DEFAULT_MOUSECLICKTHRESHOLDHOTSPOT"),10);var xc=!0,Oc=null;new Z.NetConnector;Z.Utils.getResource("DEFAULT_SHAPELINEWIDTH");Z.Utils.getResource("z177");parseFloat(Z.Utils.getResource("DEFAULT_POLYGONALPHA"));parseInt(Z.Utils.getResource("z180"),10);Z.Utils.getResource("z96");Z.Utils.getResource("z98");Z.Utils.getResource("z113");
Z.Utils.getResource("z216");var te=parseInt(Z.Utils.getResource("z97"),10);Z.Utils.getResource("z177FREEHAND");var xd=Z.captionTextColor?Z.Utils.stringValidateColorValue(Z.captionTextColor):Z.Utils.getResource("z89");Z.captionBackColor?Z.Utils.stringValidateColorValue(Z.captionBackColor):Z.Utils.getResource("DEFAULT_CAPTIONBACKCOLOR");var ne=Z.Utils.getResource("DEFAULT_LABELSTROKECOLOR"),Cf=Z.Utils.getResource("DEFAULT_LABELFILLCOLOR");parseInt(Z.Utils.getResource("z129"),10);parseInt(Z.Utils.getResource("z160"),
10);parseInt(Z.Utils.getResource("z151"),10);parseInt(Z.Utils.getResource("z130"),10);parseInt(Z.Utils.getResource("z161"),10);parseInt(Z.Utils.getResource("z152"),10);Z.mobileDevice&&(te*=2);Z.maskVisible&&(parseFloat(Z.Utils.getResource("DEFAULT_MASKFADESTEP")),Z.setCallback("viewUpdateComplete",function(){Z.maskingSelection&&updateMask()}));if(Z.tour||Z.hotspots){var dd,vf,mf=[];parseFloat(Z.Utils.getResource("DEFAULT_LABELSHAPEWIDTH"));parseFloat(Z.Utils.getResource("DEFAULT_LABELSHAPEHEIGHT"));
var Qc=[],ze=[]}else if(Z.zoomRectangle||Z.measureVisible||Z.annotations||Z.tracking){var Ae,Sd,Td,Ud,nf=[],of=[],pf=[],Qc=[],ze=[];labelLineStyleListDP=[];labelCaptionPositionListDP=[];labelTargetListDP=[];var Qb=0,Ic=null,Vd=parseFloat(Z.Utils.getResource("z147")),Me=parseInt(Z.Utils.getResource("z148"),10);parseFloat(Z.Utils.getResource("DEFAULT_LABELSHAPEWIDTH"));parseFloat(Z.Utils.getResource("DEFAULT_LABELSHAPEHEIGHT"));Z.mobileDevice&&(Vd/=2)}}if(null!==Z.imagePath&&"null"!=Z.imagePath){var Dd=
!Z.localUse;Z.localUse&&("ZoomifyZIFFile"!=Z.tileSource||Z.useLocalFile?"ZoomifyPFFFile"!=Z.tileSource||Z.useLocalFile?Z.browser==Z.browsers.CHROME||Z.browser==Z.browsers.OPERA||Z.browser==Z.browsers.IE&&11==Z.browserVersion||Z.browser==Z.browsers.SAFARI&&7<=Z.browserVersion?Z.Utils.showMessage(Z.Utils.getResource("z288"),!1,Z.messageDurationStandard,"center"):Dd=!0:Z.Utils.showMessage(Z.Utils.getResource("z289"),!1,Z.messageDurationStort,"center"):Z.Utils.showMessage(Z.Utils.getResource("z290"),
!1,Z.messageDurationShort,"center"));if(null!==Z.imageW&&null!==Z.imageH&&null!==Z.sourceMagnification)"undefined"!==typeof h.getStatus?t(Z.imageW,Z.imageH,xa,Fa,null,null,null,null,Z.sourceMagnification,Z.focal,Z.quality):window.setTimeout(function(){t(Z.imageW,Z.imageH,xa,Fa,null,null,null,null,Z.sourceMagnification,Z.focal,Z.quality)},100);else if(null!==Z.imageProperties){var Qf=Z.Utils.xmlConvertTextToDoc(Z.imageProperties),Dd=!1;K(Qf)}else"unconverted"==Z.tileSource?(Dd=!1,loadUnconvertedImage(wb)):
Dd=-1==Z.imagePath.indexOf("zComparisonPath")&&-1==Z.imagePath.indexOf("zSlidePath")&&-1==Z.imagePath.indexOf("zOverlayPath")&&-1==Z.imagePath.indexOf("zAnimationPath")&&-1==Z.imagePath.indexOf("zSlidestackPath")?!0:!1;if(Dd){var Be=new Z.NetConnector;ma(wb,Be,Oa)}}Z.imageList&&m();Z.slideshow&&(Be=new Z.NetConnector,u(Be));this.clearAll=function(a,b,c,d){a&&(yb=$b=Lb=0,"undefined"!==typeof Da&&Z.Utils.arrayClear(Da),"undefined"!==typeof qa&&Z.Utils.arrayClear(qa),"undefined"!==typeof gb&&Z.Utils.arrayClear(gb),
"undefined"!==typeof kc&&Z.Utils.arrayClear(kc),"undefined"!==typeof V&&Z.Utils.arrayClear(V),"undefined"!==typeof hb&&Z.Utils.arrayClear(hb),"undefined"!==typeof bc&&Z.Utils.arrayClear(bc),"undefined"!==typeof lc&&Z.Utils.arrayClear(lc),"undefined"!==typeof Zb&&Z.Utils.arrayClear(Zb),"undefined"!==typeof ib&&Z.Utils.arrayClear(ib),"undefined"!==typeof ob&&Z.Utils.arrayClear(ob),"undefined"!==typeof gf&&Z.Utils.arrayClear(gf),"undefined"!==typeof hf&&Z.Utils.arrayClear(hf),"undefined"!==typeof mc&&
Z.Utils.arrayClear(mc),"undefined"!==typeof sa&&Z.Utils.arrayClear(sa),"undefined"!==typeof Bb&&Z.Utils.arrayClear(Bb),"undefined"!==typeof Nb&&Z.Utils.arrayClear(Nb),"undefined"!==typeof ac&&Z.Utils.arrayClear(ac),"undefined"!==typeof Ze&&Z.Utils.arrayClear(Ze),"undefined"!==typeof Ye&&Z.Utils.arrayClear(Ye),"undefined"!==typeof Xe&&Z.Utils.arrayClear(Xe),"undefined"!==typeof We&&Z.Utils.arrayClear(We),"undefined"!==typeof fullImageTilesAllCachedNames&&Z.Utils.arrayClear(fullImageTilesAllCachedNames));
b&&C();c&&(Ha&&("undefined"!==typeof ef&&Z.Utils.arrayClear(ef),"undefined"!==typeof ff&&Z.Utils.arrayClear(ff)),Wa&&("undefined"!==typeof M&&Z.Utils.arrayClear(M),"undefined"!==typeof kf&&Z.Utils.arrayClear(kf),"undefined"!==typeof lf&&Z.Utils.arrayClear(lf),null!=dd?(dd.parentNode.removeChild(dd),dd=null,"undefined"!==typeof mf&&Z.Utils.arrayClear(mf)):Z.narrative||(null!=Sd&&(Sd.parentNode.removeChild(Sd),Sd=null,"undefined"!==typeof nf&&Z.Utils.arrayClear(nf)),null!=Ud&&(Ud.parentNode.removeChild(Ud),
Ud=null,"undefined"!==typeof Qc&&Z.Utils.arrayClear(Qc),"undefined"!==typeof ze&&Z.Utils.arrayClear(ze)),null!=Td&&(Td.parentNode.removeChild(Td),Td=null,"undefined"!==typeof of&&Z.Utils.arrayClear(of),"undefined"!==typeof pf&&Z.Utils.arrayClear(pf))),fc=null,Ub=Z.annotationPath=null,Z.annotationFolder=null));d&&(S&&Z.Utils.clearDisplay(S),ca&&Z.Utils.clearDisplay(ca),ga&&Z.Utils.clearDisplay(ga),eb&&Z.Utils.clearDisplay(eb),Ha&&Z.Utils.clearDisplay(Ha),Xa&&Z.Utils.clearDisplay(Xa),Wa&&(Z.Utils.clearDisplay(Wa),
Wa=null),jf&&(h.setStatus("magnifierInitializedViewport",!1),jf=null),fd&&!Z.narrative&&(h.clearAnnotationPanel(Oa),h.setStatus("annotationPanelInitializedViewport",!1),fd=null),Pa&&Z.Utils.clearDisplay(Pa),Ra&&Z.Utils.clearDisplay(Ra))};this.setSizeAndPosition=function(a,b,c,d){R(a,b,c,d)};this.syncViewportResize=function(a,b,c,d){h.resizeViewport(a,b,c,d)};this.resizeViewport=function(a,b,c,d){h.validateXYZDefaults();h.setSizeAndPosition(Z.viewerW,P,0,0);h.setView(a,b,c,d)};this.loadImageProperties=
function(a,b,c){ma(a,b,c)};this.parseZIFHeader=function(a){C();if(73==a[0]&&73==a[1]&&43==a[2]&&0==a[3]&&8==a[4]&&0==a[5]&&0==a[6]&&0==a[7]&&16==a[8]&&0==a[9]&&0==a[10]&&0==a[11]&&0==a[12]&&0==a[13]&&0==a[14]&&0==a[15]){for(var b=Z.Utils.longValue(a,8),c=Z.Utils.longValue(a,b),d=1,e=null,g=null,f=null,l=null,n=null,k=null,k=2;0!=b;){for(e=0;e<c;e++)switch(g=b+8+20*e,Z.Utils.shortValue(a,g)){case 256:Ca[d-1]=Z.Utils.intValue(a,g+12);break;case 257:La[d-1]=Z.Utils.intValue(a,g+12);break;case 322:f=
Z.Utils.intValue(a,g+12);break;case 323:l=Z.Utils.intValue(a,g+12);break;case 324:var y=gc[d-1]=Z.Utils.longValue(a,g+4);Rb[d-1]=Z.Utils.longValue(a,g+12);n+=y;break;case 325:y=hc[d-1]=Z.Utils.longValue(a,g+4),Fb[d-1]=1==y?Z.Utils.intValue(a,g+12):2==y?Z.Utils.intValue(a,g+12)+","+Z.Utils.intValue(a,g+16):Z.Utils.longValue(a,g+12)}b=Z.Utils.longValue(a,b+20*c+8);c=Z.Utils.longValue(a,b);d++}e=Ca[0];g=La[0];ta=d-1;nb=ta-1;Ca.reverse();La.reverse();gc.reverse();Rb.reverse();hc.reverse();Fb.reverse();
!isNaN(e)&&0<e&&!isNaN(g)&&0<g&&!isNaN(f)&&0<f&&!isNaN(l)&&0<l&&0<n?h.getStatus("initializedViewport")?B(e,g,f,l,n,k,null,null,null,null,null):t(e,g,f,l,n,k,null,null,null,null,null):Z.Utils.showMessage(Z.Utils.getResource("z250"),!1,Z.messageDurationStandard,"center")}};this.parseZIFOffsetChunk=function(a,b){var c=Z.Utils.arrayIndexOfObjectValue(sb,"chunkID",b);-1!=c&&(sb[c].chunk=a,ra(b,"offset"))};this.parseZIFByteCountChunk=function(a,b){var c=Z.Utils.arrayIndexOfObjectValue(tb,"chunkID",b);-1!=
c&&(tb[c].chunk=a,ra(b,"byteCount"))};this.parseZIFImage=function(a,b,c){a="data:image/jpeg;base64,"+Z.Utils.encodeBase64(a);var d;"image-display"==c?d=h.getStatus("imageSaving")?onTileLoadToSave:F:"image-backfill"==c?d=h.getStatus("imageSaving")?z599ToSave:ha:"image-magnifier"==c?d=onTileLoadMagnifier:"navigator"==c?Z.comparison&&0!=Oa?Z.Navigator2&&(d=Z.Navigator2.z556):Z.Navigator&&(d=Z.Navigator.z556):"gallery"==c&&(d=Z.Gallery.initializeGallery);b=Z.Utils.createCallback(null,d,b);Z.Utils.createImageElementFromBytes(a,
b)};this.parsePFFImage=function(a,b,c){if(Z.pffJPEGHeadersSeparate){var d=Z.Utils.intValue(a,a.length-4,!0);a="data:image/jpeg;base64,"+Z.Utils.encodeBase64(qc[d],0)+Z.Utils.encodeBase64(a,0)}else a="data:image/jpeg;base64,"+Z.Utils.encodeBase64(a);var e;"image-display"==c?e=h.getStatus("imageSaving")?onTileLoadToSave:F:"image-backfill"==c?e=h.getStatus("imageSaving")?z599ToSave:ha:"image-magnifier"==c?e=onTileLoadMagnifier:"navigator"==c?e=Z.Navigator.z556:"gallery"==c&&(e=Z.Gallery.initializeGallery);
b=Z.Utils.createCallback(null,e,b);Z.Utils.createImageElementFromBytes(a,b)};this.parsePFFHeader=function(a){C();if("undefined"!==typeof a&&null!==a){var b=null,c=null,d=null,e=null,g=null,f=null;Z.Utils.intValue(a,8,!0);e=Z.Utils.intValue(a,108,!0);f=1060+Z.Utils.intValue(a,116,!0);g=Z.Utils.intValue(a,124,!0);Z.Utils.intValue(a,136,!0);Z.pffJPEGHeadersSeparate=!0;b=Z.Utils.intValue(a,1052,!0);c=Z.Utils.intValue(a,1056,!0);d=e;Z.pffJPEGHeadersSeparate?(Z.imageW=b,Z.imageH=c,Z.imageCtrX=Z.imageW/
2,Z.imageCtrY=Z.imageH/2,Z.imageD=Math.round(Math.sqrt(b*b+c*c)),Ed=ia=null,pc=f,Rc=g,xa=d,Fa=e,(new Z.NetConnector).loadByteRange(wb,1060,f,"loadingPFFFileBytes","jpegHeaders")):ea(b,c,d,e,g,null,null,f,null,null,null)}};this.parsePFFJPEGHeaders=function(a){if("undefined"!==typeof a&&null!==a){for(var b=Z.Utils.intValue(a,0,!0),c=4,d=0;d<b;d++){var e=Z.Utils.intValue(a,c,!0),c=c+4,g=Z.Utils.dataSlice(a,c,c+e),c=c+e;qc.push(g)}ea()}};this.z602=function(a,b){K(a,b)};this.validateXYZDefaults=function(a){a&&
Z.Utils.resetParametersXYZ(Z.parameters);var b=parseFloat(Z.Utils.getResource("z143")),c=parseFloat(Z.Utils.getResource("z144")),d=parseFloat(Z.Utils.getResource("z145")),e=parseFloat(Z.Utils.getResource("DEFAULT_INITIALR")),g=parseFloat(Z.Utils.getResource("z163"));a=parseFloat(Z.Utils.getResource("z153"));b=isNaN(b)?null:b;c=isNaN(c)?null:c;d=isNaN(d)?null:d;e=isNaN(e)?null:e;g=isNaN(g)?null:g;a=isNaN(a)?null:a;Z.bookmarksGet?(Z.initialX||(Z.initialX=b),Z.initialY||(Z.initialY=c),Z.initialZ||(Z.initialZ=
d),Z.initialR||(Z.initialR=e),Z.minZ||(Z.minZ=g),Z.maxZ||(Z.maxZ=a)):"IIIFImageServer"==Z.tileSource?Z.iiifRegion&&(a=Z.iiifRegion.split(","),b=Z.iiifSize.split(","),Z.initialX=Math.round(parseFloat(a[0])+parseFloat(a[2])/2),Z.initialY=Math.round(parseFloat(a[1])+parseFloat(a[3])/2),Z.initialZ=Math.round(parseFloat(b[0])/parseFloat(a[2])*100)/100,Z.initialR=parseInt(Z.iiifRotation,10)):Z.parameters?(Z.parameters.zInitialX||(Z.initialX=b),Z.parameters.zInitialY||(Z.initialY=c),Z.parameters.zInitialZoom||
(Z.initialZ=d),Z.parameters.zInitialRotation||(Z.initialR=e),Z.parameters.zMinZoom||(Z.minZ=g),Z.parameters.zMaxZoom||(Z.maxZ=a)):(Z.initialX=b,Z.initialY=c,Z.initialZ=d,Z.initialR=e,Z.minZ=g,Z.maxZ=a);null===Z.initialX&&(Z.initialX=Z.imageW/2);null===Z.initialY&&(Z.initialY=Z.imageH/2);Z.fitZ=h.z468(null,null,0);Z.fillZ=h.calculateZoomToFill(null,null,0);b=h.getStatus("initializedViewport")?h.getRotation():Z.initialR;a=h.z468(null,null,b);b=h.calculateZoomToFill(null,null,b);1<Z.fitZ&&(null!==Z.maxZ?
Z.fitZ>Z.maxZ&&(Z.fitZ=Z.maxZ):"unconverted"==Z.tileSource&&(Z.fitZ=1));1<Z.fillZ&&(null!==Z.maxZ?Z.fillZ>Z.maxZ&&(Z.fillZ=Z.maxZ):"unconverted"==Z.tileSource&&(Z.fillZ=1));null===Z.minZ||-1==Z.minZ?Z.minZ=Z.fitZ:0==Z.minZ&&(Z.minZ=Z.fillZ);if(null===Z.maxZ||-1==Z.maxZ)Z.maxZ=1;null===Z.initialZ||-1==Z.initialZ?Z.initialZ=a:0==Z.initialZ&&(Z.initialZ=b);Z.initialZ<Z.minZ&&(Z.initialZ=Z.minZ);Z.initialZ>Z.maxZ&&(Z.initialZ=Z.maxZ)};this.getViewW=function(){return N};this.getViewH=function(){return P};
this.getDisplayW=function(){return Y};this.getDisplayH=function(){return da};this.getImagePath=function(){return wb};this.setImagePath=function(a){wb=a};this.getViewportID=function(){return Oa};this.getTierCount=function(){return ta};this.getTileW=function(){return xa};this.getTileH=function(){return Fa};this.getTierCurrent=function(){return Q};this.getTierBackfill=function(){return na};this.getTierBackfillDynamic=function(){return za};this.getTierBackfillOversize=function(){return db};this.getTierScale=
function(){return W};this.getX=function(a){var b=parseFloat(E.left)-Ta;a=h.getZoom(a);return fe-b/a};this.getY=function(a){var b=parseFloat(E.top)-Ua;a=h.getZoom(a);return ge-b/a};this.getZoom=function(a){var b=W;a&&(b=W*parseFloat(X.width)/Y);return ka(Q,b)};this.getRotation=function(a){return Z.imageR};this.getCoordinates=function(){new Z.Utils.Point(h.getX(),h.getY())};this.getCoordinatesBookmark=function(a,b){var c="";return c=b?"?"+h.getViewCoordinatesIIIFString(a,null,"bookmark"):"?"+h.getViewCoordinatesString(a)};
this.getViewCoordinatesString=function(a){var b="x="+Math.round(h.getX(a)).toString(),c="&y="+Math.round(h.getY(a)).toString(),d="&z="+Math.round(100*h.getZoom(a)).toString();a=Math.round(h.getRotation(a));return b+c+d+(0==a?"":"&r="+a.toString())};this.getCoordinatesFull=function(a){return new Z.Utils.Coordinates(h.getX(a),h.getY(a),h.getZoom(a),h.getRotation(a))};this.getCoordinatesDisplayFull=function(){return new Z.Utils.CoordinatesDisplayStyle(E.left,E.top,X.width,X.height,X.left,X.top,J.width,
J.height,J.left,J.top,Z.imageR)};this.getTiersScaleUpMax=function(){return ue};this.getTiersScaleDownMax=function(){return Mf};this.getTilesCacheMax=function(){return uc};this.getTierWs=function(){return Ca.join(",")};this.getTierHs=function(){return La.join(", ")};this.getTierTileCounts=function(){return Na.join(", ")};this.getTilesToLoad=function(){return Lb};this.getTilesLoadingNames=function(){return""==V.join(", ")?"Current view loading complete":V.join(", ")};this.getTilesToDraw=function(){return wc};
this.getConstrainPan=function(a){return Z.constrainPan};this.setConstrainPan=function(a){Z.constrainPan="0"!=a;Z.constrainPanLimit=parseInt(a,10);Z.constrainPanStrict="3"==a;Z.constrainPan&&h.toggleConstrainPan(!0)};this.getSmoothPan=function(){return Z.smoothPan};this.setSmoothPan=function(a){Z.smoothPan=a};this.getSmoothPanEasing=function(){return Z.smoothPanEasing};this.setSmoothPanEasing=function(a){Z.smoothPanEasing=a};this.getSmoothPanGlide=function(){return Z.smoothPanGlide};this.setSmoothPanGlide=
function(a){Z.smoothPanGlide=a};this.getSmoothZoom=function(){return Z.smoothZoom};this.setSmoothZoom=function(a){Z.smoothZoom=a};this.getSmoothZoomEasing=function(){return Z.smoothZoomEasing};this.setSmoothZoomEasing=function(a){Z.smoothZoomEasing=a};this.getImageMetadataXML=function(){return Z.imageMetadataXML};this.setCoordinatesDisplayVisibility=function(a){a?(Z.Utils.addEventListener(document,"mousemove",r),Z.Utils.addEventListener(document,"mousedown",r)):(Z.coordinatesVisible=!1,Z.Utils.removeEventListener(document,
"mousemove",r),Z.Utils.removeEventListener(document,"mousedown",r))};this.setTourPath=function(a,b){h.setHotspotPath(a,b)};this.setHotspotPath=function(a,b){"undefined"===typeof a||Z.Utils.stringValidate(a)?(Z.hotspotPath=Z.Utils.stringRemoveTrailingSlash(a),Z.hotspotFolder=Z.hotspotPath,".xml"==Z.hotspotPath.toLowerCase().substring(Z.hotspotPath.length-4,Z.hotspotPath.length)&&(Z.hotspotFolder=Z.hotspotFolder.substring(0,Z.hotspotFolder.lastIndexOf("/"))),b||(h.deleteAllHotspots(),loadHotspotsXML(Oa))):
(Z.hotspotPath=null,Z.hotspotFolder=null,h.deleteAllHotspots())};this.getHotspotCurrentID=function(){return va};this.getHotspotCurrentIDExternal=function(){var a=h.getHotspotCurrentID();return currIDExt=M[a].id};this.getHotspots=function(){return M};this.setHotspots=function(a){M=a.slice(0)};this.getAnnotationPath=function(){return fc};this.setAnnotationPath=function(a,b){if("undefined"!==typeof a&&Z.Utils.stringValidate(a)){fc=Z.annotationPath=Z.Utils.stringRemoveTrailingSlash(a);Z.annotationFolder=
Z.annotationPath;var c=Z.annotationPath.toLowerCase();".json"!=c.substring(Z.annotationPath.length-5,Z.annotationPath.length)&&".xml"!=c.substring(Z.annotationPath.length-4,Z.annotationPath.length)&&(Z.annotationPath=Z.annotationPath+"/"+Z.Utils.getResource("z69"));".xml"==c.substring(Z.annotationPath.length-4,Z.annotationPath.length)&&(Z.annotationFolder=Z.annotationFolder.substring(0,Z.annotationFolder.lastIndexOf("/")));Z.annotations=!0;Z.annotationPathProvided=!0;b||(h.deleteAllAnnotations(),
loadAnnotationsXML(Oa))}else Z.annotationPath=null,Z.annotationFolder=null,h.deleteAllAnnotations(),Z.annotations=!1};this.testSetAnnotationPath=function(){h.setAnnotationPath("Assets/Annotations/annotations2.xml")};this.getAnnotationsXML=function(){return Ae=z669(Ae)};this.setAnnotationsXML=function(a){Ae=a};this.setXMLCallbackFunction=function(a){Z.xmlCallbackFunction=a};this.setLabelClickDrag=function(a){Z.labelClickDrag=a};this.setVisibility=function(a,b){if(b){var c=a?1:0;Gb&&Z.Utils.setOpacity(Gb,
c);la&&Z.Utils.setOpacity(la,c)}else c=a?"inline-block":"none",Gb&&!Aa&&(Aa=Gb.style),Aa&&(Aa.display=c),la&&!E&&(E=la.style),E&&(E.display=c)};this.setOpacity=function(a){Z.Utils.setOpacity(la,2<=a?a/100:0>a?0:1<a?1:a)};this.showLists=function(a){Z.annotationFileList&&h.setAnnotationFileListVisibilty(a?"visible":"hidden");Z.hotspots&&Z.Viewer.setVisibilityHotspotChoiceList(a,Oa.toString());Z.slideshow&&Z.Viewport.setVisibilitySlidesChoiceList(a);Z.imageSet&&!Z.comparison&&Z.Viewer.setVisibilityImageSetChoiceList(a)};
this.getLabelList=function(){if("undefined"!==typeof Qc){var a=Z.Utils.arrayClone("labels",Qc,a);return a}};this.z619=function(b){A();b||(n(Id,qa),Zd=!0);(!Z.imageSet||Z.comparison||a==Z.imageSetStart||b)&&ta>Fe&&(n(Hd,qa),Yd=!0,ta>Ee&&(n(md,qa),Xd=!0),h.setStatus("backfillPrecachedViewport",!0));qa.sort();qa=Z.Utils.arrayUnique(qa);gb=qa.slice(0);h.traceDebugValues("tilesBackfillToPrecache",null,gb.length);G(qa,ha,"simple","image-backfill")};this.prez581s=function(a){if(Z.imageSet)Z.Utils.showMessage(Z.Utils.getResource("ALERT_PRELOADINGIMAGESET-LOADINGTILES"),
!1,Z.messageDurationLong,"center"),h.updateView(!0,!0);else{Z.Utils.showMessage(Z.Utils.getResource("ALERT_PRELOADINGONEIMAGE-LOADINGTILES"),!1,Z.messageDurationLong,"center");Z.Utils.arrayClear(V);a=0;for(var b=ta;a<b;a++)for(var c=h.z542(a,null,!0,!0),d=c.l,e=c.r;d<=e;d++)for(var g=c.t,f=c.b;g<=f;g++){var l=a+"-"+d+"-"+g;V[V.length]=l}if(0<V.length)for(c=(new Date).getTime(),a=0,b=V.length;a<b;a++)if(l=V[a])l=new I(l,"image-display"),U(l,c,F)}};this.updateView=function(b,c,d){if("undefined"===typeof a||
null===a)a=0;if(a!=Z.viewportCurrentID&&!b){var e=Z["Viewport"+a.toString()];Z.imageX=e.getX(!0);Z.imageY=e.getY(!0);Z.imageZ=e.getZoom(!0);Z.imageR=e.getRotation(!0)}var g=Z.mouseIsDown||Z.buttonIsDown||Z.keyIsDown||Z.mouseWheelIsDown,e=W!=rb||h.getZoom()!=Z.imageZ,f=parseFloat(E.left)!=Ta||parseFloat(E.top)!=Ua||h.getX()!=Z.imageX||h.getY()!=Z.imageY,n=Z.fullViewPrior,k=Z.animation||Z.slideshowPlaying;if(e||f||n||"undefined"!==typeof b&&b&&(!g||k)||"undefined"!==typeof c&&c||"external"==Z.imageFilters){d||
Pb();if(Z.comparison||Z.overlays||!Z.imageSet||!Z.Viewer.getStatus("readyViewer")||a>Z.viewportCurrentID-1&&a<Z.viewportCurrentID+1||c){var y=!1;if(b||parseFloat(X.width)!=ga.width){if(Z.useCanvas){X.width=ga.width+"px";X.height=ga.height+"px";X.left="0px";X.top="0px";Ba.restore();Ba.save();try{Ba.scale(W,W)}catch(O){Z.Utils.showMessage(Z.Utils.getResource("ERROR_SCALINGCANVASFORUNCONVERTEDIMAGE")),console.log("In function z630 scaling canvas:  "+O)}Xa&&(mb.width=ga.width+"px",mb.height=ga.height+
"px",mb.left="0px",mb.top="0px");Pa&&(Qa.width=Pa.width+"px",Qa.height=Pa.height+"px",Qa.left="0px",Qa.top="0px");Ra&&(Sa.width=Ra.width+"px",Sa.height=Ra.height+"px",Sa.left="0px",Sa.top="0px");ca&&(za?(J.width=ca.width+"px",J.height=ca.height+"px",J.left=zb+"px",J.top=Ab+"px",Kb.restore(),Kb.save(),Kb.scale(lb,lb)):(J.width=Xb+"px",J.height=Yb+"px",J.left=zb+"px",J.top=Ab+"px"))}y=!0}if(b||parseFloat(E.left)!=Ta||parseFloat(E.top)!=Ua)y=parseFloat(E.left)-Ta,d=parseFloat(E.top)-Ua,0!=Z.imageR&&
(d=Z.Utils.rotatePoint(y,d,Z.imageR),y=d.x,d=d.y),E.left=Ta+"px",E.top=Ua+"px",za||(zb=parseFloat(J.left)+y,Ab=parseFloat(J.top)+d,J.left=zb+"px",J.top=Ab+"px"),g=h.getZoom(),Z.imageX=fe=Z.imageX-y/g,Z.imageY=ge=Z.imageY-d/g,y=!0;y&&(v(ga,Q,hb,"centerOut",!1,"1a. Updating view: resetting display positions"),Z.maskingSelection&&Xa&&displayMask(),za&&v(ca,na,Da,"simple",!1,"1b. Updating view: resetting backfill positions"));y=!1;if("undefined"!==typeof b&&b||W!=rb||h.getZoom()!=Z.imageZ||!h.getStatus("initializedViewport")||
c){W!=rb&&(Z.imageZ=h.getZoom());Z.imageZ<Z.minZ&&(Z.imageZ=Z.minZ);Z.imageZ>Z.maxZ&&(Z.imageZ=Z.maxZ);g=ue;for(d=ta;0<d&&g/2>=Z.imageZ;)d--,g/=2;d=0>d-1?0:d-1;g=ua(d,Z.imageZ);if(d!=Q||g!=W)Z.useCanvas&&(Ba.restore(),Ba.save(),Ba.scale(g,g)),Q!=d&&(Yc=!0),Q=d,W=g;rb=W;"unconverted"!=Z.tileSource&&(A(),v(ca,na,Da,"simple",!1,"2. Updating view: changing tier - backfill"));!b&&0<uc&&(y=!0)}else h.traceDebugValues("updateView-noChange");"unconverted"!=Z.tileSource&&za?l(!0):S&&Z.Utils.clearDisplay(S)}a==
Z.viewportCurrentID||Z.comparison||Z.overlays||!Z.imageSet||c?("unconverted"!=Z.tileSource&&(l(),v(ga,Q,null,"centerOut",y,"3. Updating view: prior to loading of any new tiles")),Z.maskingSelection&&updateMask(),0<V.length&&G(V,F,"centerOut","image-display"),h.syncViewportRelated(!0,!0,!0,!0,!0,!0,Z.comparison&&a==Z.viewportCurrentID,Z.overlays&&a==Z.viewportCurrentID,Z.bookmarksSet,Z.tracking)):(h.setStatus("displayLoadedViewport",!0),h.setStatus("displayDrawnViewport",!0));c&&(b=null!==Z.imageSetLength?
Z.imageSetLength.toString():"",b=(h.getViewportID()+1).toString()+" of "+b,Z.Utils.showMessage(Z.Utils.getResource("ALERT_PRELOADINGIMAGESET-UPDATINGVIEW")+"  "+b,!1,Z.messageDurationLong,"center"));f&&Z.Utils.validateCallback("viewPanned");e&&Z.Utils.validateCallback("viewZoomed");(f||e)&&Z.Utils.validateCallback("viewChanged")}};syncTransitionCanvas=function(){eb&&Sb&&Wb&&(eb.width=ga.width,eb.height=ga.height,Sb.width=X.width,Sb.height=X.height,Sb.left=X.left,Sb.top=X.top,Wb.restore(),Wb.save(),
Wb.translate(ub,vb),Wb.scale(W,W))};this.Tile=function(a,b){return new I(a,b)};this.formatTilePath=function(a,b,c,d){var e;if("ZoomifyZIFFile"==Z.tileSource){var g=h.getViewportID();e="offsetLoading";var f="loading",l="loading",n;if(1==gc[a])f=Rb[a];else{var k=new ja(a,b,c),y=k.chunkID+","+a+","+b+","+c+","+d+",offset";n=Z.Utils.arrayIndexOfObjectValue(sb,"chunkID",k.chunkID);-1==n?(h.traceDebugValues("z532",k.chunkID+","+a+","+b+","+c+","+d),-1==Z.Utils.arrayIndexOf(sa,y)&&(sa[sa.length]=y),sb[sb.length]=
{chunkID:k.chunkID,chunk:"loading"},n=new Z.NetConnector,n.loadByteRange(wb,k.chunkStart,k.chunkEnd,"loadingZIFFileBytes","offset",null,k.chunkID,g)):"loading"==sb[n].chunk?-1==Z.Utils.arrayIndexOf(sa,y)&&(sa[sa.length]=y):"loading"!=sb[n].chunk&&(n=sb[n].chunk,f=Z.Utils.longValue(n,k.offsetStartInChunk))}1==hc[a]?l=Fb[a]:(n=b+c*oa[a],2==hc[a]?(a=Fb[a],l=0==n?a.substring(0,a.indexOf(",")):a.substring(a.indexOf(",")+1,a.length)):(k=new Mb(a,b,c),a=k.chunkID+","+a+","+b+","+c+","+d+",byteCount",n=Z.Utils.arrayIndexOfObjectValue(tb,
"chunkID",k.chunkID),-1==n?(-1==Z.Utils.arrayIndexOf(sa,a)&&(sa[sa.length]=a),tb[tb.length]={chunkID:k.chunkID,chunk:"loading"},n=new Z.NetConnector,n.loadByteRange(wb,k.chunkStart,k.chunkEnd,"loadingZIFFileBytes","byteCount",null,k.chunkID,g)):"loading"==tb[n].chunk?-1==Z.Utils.arrayIndexOf(sa,a)&&(sa[sa.length]=a):"loading"!=tb[n].chunk&&(n=tb[n].chunk,l=Z.Utils.intValue(n,k.bcStartInChunk))));"loading"==f||isNaN(f)||"loading"==l||isNaN(l)||(e=wb+"?"+f.toString()+","+l.toString())}else if("ZoomifyImageFolder"==
Z.tileSource){d=c*oa[a]+b;for(e=0;e<a;e++)d+=Na[e];a=wb+"/TileGroup"+Math.floor(d/256)+"/"+a+"-"+b+"-"+c+"."+Z.tileType;if(Z.browser==Z.browsers.IE&&9>Z.browserVersion||0==uc)a=Z.Utils.cacheProofPath(a);e=a}else if("ZoomifyPFFFile"==Z.tileSource&&null===Z.tileHandlerPathFull){e=h.getViewportID();f="offsetLoading";g=l="loading";g=0;for(l=ta-1;l>a;l--)g+=Na[l];g+=c*oa[a]+b;l=Math.floor(g/Ja);n=pc+Ja*l*8;var k=n+8*Ja,O=g-l*Ja,y=8*O,q=l+","+a+","+b+","+c+","+d+",chunk",g=Z.Utils.arrayIndexOfObjectValue(pa,
"chunkID",l);-1==g?(h.traceDebugValues("z531",l+","+a+","+b+","+c+","+d),-1==Z.Utils.arrayIndexOf(sa,q)&&(sa[sa.length]=q),pa[pa.length]={chunkID:l,chunk:"loading"},(new Z.NetConnector).loadByteRange(wb,n,k,"loadingPFFFileBytes","offset",null,l,e)):"loading"==pa[g].chunk?-1==Z.Utils.arrayIndexOf(sa,q)&&(sa[sa.length]=q):(l=Z.Utils.longValue(pa[g].chunk,8*(O-1),!0),g=Z.Utils.longValue(pa[g].chunk,y,!0)-l-1,"loading"==l||isNaN(l)||"loading"==g||isNaN(g)||(f=wb+"?"+l.toString()+","+g.toString()));e=
f}else if("ZoomifyPFFFile"==Z.tileSource){g="offsetLoading";n=e=0;for(f=ta-1;f>a;f--)e+=Na[f];e+=c*oa[a]+b;f=Math.floor(e/Ja);n=-1==e-1?0:e-1;l=Math.floor(n/Ja);"undefined"===typeof pa[f]||"offsetLoading"==pa[f]||"undefined"===typeof pa[l]||"offsetLoading"==pa[l]?(e=f+","+a+","+b+","+c+","+d+",chunk",-1==Z.Utils.arrayIndexOf(sa,e)&&(sa[sa.length]=e),h.traceDebugValues("z531",f+","+a+","+b+","+c+","+d),"undefined"===typeof pa[f]&&(pa[f]="offsetLoading",a=pc+Ja*f*8,b=a+8*Ja,Ya(a,b,f)),"undefined"===
typeof pa[l]&&(pa[l]="offsetLoading",a=pc+Ja*l*8,b=a+8*Ja,Ya(a,b,f))):(d=Math.floor(pa[f][0]),g=Math.floor(pa[l][0]),l=pa[l][1],f=pa[f][1],n=n%Ja*9,l=Math.floor(parseFloat(l.substring(n,n+9))),n=e%Ja*9,f=Math.floor(parseFloat(f.substring(n,n+9))),e=0==e?pc+8*Rc:g+l,d+=f,g=0<d-e?Z.tileHandlerPathFull+"?file="+wb+"&requestType=0&begin="+e.toString()+"&end="+d.toString()+"&vers="+ia.toString()+"&head="+Ed.toString():"z647:"+a+"-"+b+"-"+c);e=g}else"DZIFolder"==Z.tileSource?e=w("tile",a,b,c,d):"IIIFImageServer"==
Z.tileSource?e=formatTilePathIIIFImageServer(a,b,c,d):"ImageServer"==Z.tileSource&&(e=z530(a,b,c,d));return e};this.formatTilePathDZI=function(a,b,c,d){return w("tile",a,b,c,d)};this.formatFilePathDZI=function(a,b,c,d,e){return w(a,b,c,d,e)};this.parsePFFOffsetChunk=function(a,b){var c=Z.Utils.arrayIndexOfObjectValue(pa,"chunkID",b);-1!=c&&(pa[c].chunk=a,ra(b,"chunk"))};this.parsePFFOffsetChunkServlet=function(a){var b=parseInt(a.documentElement.getAttribute("BEGIN"),10);a=a.documentElement.getAttribute("REPLYDATA");
var c=rc[b],b=Math.floor((b-pc)/8/Ja);pa[b]=[];pa[b]=a.split(",",2);ra(c,"chunk")};this.z581=function(a,b,c){U(a,b,c)};this.getNavigatorImage=function(){var a=0,b=null;0<Da.length&&"0-0-0"!=Da[0].name&&(a=Z.Utils.arrayIndexOfObjectValue(Da,"name","0-0-0"));-1!=a&&(a=Da[a])&&(b=a.image);return b};this.getClickCoordsAtZoom=function(a,b){var c=this.getClickCoordsInImage(a,b);return new Z.Utils.Point(c.x*b,c.y*b)};this.getClickCoordsInImage=function(a,b,c){a=Z.Utils.event(a);var d=null;if(a){var e=a.type;
if("undefined"===typeof b||null==b)b=h.getZoom();if("undefined"===typeof c||null===c)"touchstart"==e||"touchend"==e||"touchcancel"==e?(fb=Z.Utils.getFirstTouch(a),"undefined"!==typeof fb&&(target=fb.target,c=new Z.Utils.Point(fb.pageX,fb.pageY))):(target=Z.Utils.target(a),relatedTarget=Z.Utils.relatedTarget(a),c=Z.Utils.getMousePosition(a));"undefined"!==typeof c&&null!==c&&(a=h.z479(c.x,c.y),d=h.z485(a.x,a.y,b))}return d};this.getClickZoomCoords3D=function(a,b,c,d,e){var g=parseFloat(Z.Utils.getResource("z93TIERSKIPTHRESHOLD"));
b=h.z479(b.x,b.y);b=h.z485(b.x,b.y,Z.imageZ);var f=ka(c,d);a=a.altKey;e?a?f=Z.fitZ:(e=ua(c,Z.fitZ),d-e<g?f=Z.fitZ:d>1+g?f=ka(c,1):0<c?f=ka(c-1,1):"unconverted"==Z.tileSource&&(f=Z.fitZ)):a?f=Z.maxZ:d<1-g?f=ka(c,1):c<ta-1?f=ka(c+1,1):1<Z.maxZ&&(f=Z.maxZ);return new Z.Utils.Point3D(b.x,b.y,f)};this.getTileNameUnderCursor=function(a){a=a?Z.Utils.getMousePosition(a):new Z.Utils.Point(h.getX(),h.getY());a=h.z479(a.x,a.y);var b=h.z485(a.x,a.y,h.getZoom());a=Math.round(b.x);b=Math.round(b.y);a=Math.min(Gc,
Math.max(0,Math.floor(a/xa)));b=Math.min(tc,Math.max(0,Math.floor(b/Fa)));return nb+"-"+a+"-"+b};this.calculateCurrentCenterCoordinates=function(a,b,c){if("undefined"===typeof a||null===a)a=new Z.Utils.Point(parseFloat(E.left),parseFloat(E.top));if("undefined"===typeof c||null===c)c=h.getRotation();0>c&&(c+=360);if("undefined"===typeof b||null===b)b=h.getZoom();var d=Math.round(Z.imageX-(a.x-Ta)/b);a=Math.round(Z.imageY-(a.y-Ua)/b);c=Z.Utils.getPositionRotated(d,a,Z.imageX,Z.imageY,-c);return new Z.Utils.Point(c.x,
c.y)};this.z542=function(a,b,c,d){if("undefined"===typeof a||null===a)a=Q;if("undefined"===typeof b||null===b)b=!1;return new $a(h.z541(b,c?a:null,d),a)};this.z541=function(a,b,c){var d=parseFloat(E.left)-Ta,e=parseFloat(E.top)-Ua;if(Z.useCanvas)var g=parseFloat(E.width)/fa.width,d=d/g,e=e/g;g=h.getZoom();0!=d&&(d/=g);0!=e&&(e/=g);var f=a?N:Y;a=a?P:da;return new ab(Z.imageX-d,Z.imageY-e,-(f/2),f/2,-(a/2),a/2,g,b,c)};this.HotspotsAllBoundingBoxInPixels=function(){for(var a=new HotspotContext,b=Z.imageCtrX,
c=Z.imageCtrX,d=Z.imageCtrY,e=Z.imageCtrY,g=0,f=M.length;g<f;g++){var l=M[g],n=new HotspotDimensions(l,a,null,!0),k=l.x-n.w/2,y=l.x+n.w/2,h=l.y-n.h/2,l=l.y+n.h/2;k<b&&(b=k);y>c&&(c=y);h<d&&(d=h);l>e&&(e=l)}a=parseInt(Z.Utils.getResource("DEFAULT_SAVEIMAGELABELMARGIN"),10);b-=a;d-=a;c+=a;e+=a;this.l=b;this.r=c;this.t=d;this.b=e;this.x=b+(c-b)/2;this.y=d+(e-d)/2};this.z480=function(a,b){var c=h.z479(a,b);return new Z.Utils.Point(c.x-Ta,c.y-Ua)};this.convertViewportDisplayCoordsToPageCoords=function(a,
b){var c=h.convertViewportCoordsToPageCoords(a+Ta,b+Ua);return new Z.Utils.Point(c.x,c.y)};this.z479=function(a,b){var c=Z.Utils.getElementPosition(sc);return new Z.Utils.Point(a-c.x+Ta,b-c.y+Ua)};this.convertViewportCoordsToPageCoords=function(a,b){var c=Z.Utils.getElementPosition(sc);return new Z.Utils.Point(a+c.x-Ta,b+c.y-Ua)};this.convertPageCoordsToImageCoords=function(a,b){var c=h.z479(a,b),c=h.z485(c.x,c.y,Z.imageZ);return new Z.Utils.Point(c.x,c.y)};this.convertImageCoordsToPageCoords=function(a,
b,c,d){a=h.z478(a,b,c,d);a=h.convertViewportCoordsToPageCoords(a.x,a.y,Z.imageZ);return new Z.Utils.Point(a.x,a.y)};this.z485=function(a,b,c,d){if("undefined"===typeof c||null===c)c=Z.imageZ;if("undefined"===typeof d||null===d)d=Z.imageR;0>d&&(d+=360);var e=parseFloat(E.left)+ub,g=parseFloat(E.top)+vb;a-=e;b-=g;0!=Z.imageR&&(viewportClickPt=Z.Utils.rotatePoint(a,b,d),a=viewportClickPt.x,b=viewportClickPt.y);return new Z.Utils.Point(a/c+Z.imageX,b/c+Z.imageY)};this.z478=function(a,b,c,d){if("center"==
a||isNaN(parseFloat(a)))a=Z.imageCtrX;if("center"==b||isNaN(parseFloat(b)))b=Z.imageCtrY;if("undefined"===typeof c||null===c)c=Z.imageZ;if("undefined"===typeof d||null===d)d=Z.imageR;0>d&&(d+=360);a=(a-Z.imageX)*c;b=(b-Z.imageY)*c;0!=Z.imageR&&(viewportClickPt=Z.Utils.rotatePoint(a,b,-d),a=viewportClickPt.x,b=viewportClickPt.y);d=parseFloat(E.left)+ub;c=parseFloat(E.top)+vb;return new Z.Utils.Point(a+d,b+c)};this.convertImageCoordsToViewportEdgeCoords=function(a,b,c,d){if("undefined"===typeof c||
null===c)c=Z.imageZ;if("undefined"===typeof d||null===d)d=Z.imageR;0>d&&(d+=360);a=(Z.imageX-a)*c;b=(Z.imageY-b)*c;0!=Z.imageR&&(viewportClickPt=Z.Utils.rotatePoint(a,b,-d),a=viewportClickPt.x,b=viewportClickPt.y);return new Z.Utils.Point(Ta+a,Ua+b)};this.convertViewportEdgeCoordsToImageCoords=function(a,b,c,d){if("undefined"===typeof c||null===c)c=Z.imageZ;if("undefined"===typeof d||null===d)d=Z.imageR;0>d&&(d+=360);a-=Ta;b-=Ua;0!=Z.imageR&&(viewportClickPt=Z.Utils.rotatePoint(a,b,-d),a=viewportClickPt.x,
b=viewportClickPt.y);return new Z.Utils.Point(Z.imageX-a/c,Z.imageY-b/c)};this.z468=function(a,b,c){if("undefined"===typeof a||null===a)a=Z.imageW;if("undefined"===typeof b||null===b)b=Z.imageH;var d=a/b>N/P?N/a:P/b;if(90==c||270==c)d=a/b>N/P?N/b:P/a;return d};this.calculateZoomToFill=function(a,b,c){if("undefined"===typeof a||null===a)a=Z.imageW;if("undefined"===typeof b||null===b)b=Z.imageH;var d=a/b>N/P?P/b:N/a;if(90==c||270==c)d=a/b>N/P?P/a:N/b;return d};this.calculateZoomForResize=function(a,
b,c,d,e){var g=a,f=Z.imageW*a,l=Z.imageH*a;b=d/b;c=e/c;f<d&&l<e?g=a:f==d&&l<e?g=-1:f<d&&l==e?g=-1:f>d&&l<=e?g=a*b:f<=d&&l>e?g=a*c:f>d&&l>e&&(d=1,1<=b&&1<=c?d=b>c?b:c:1>=b&&1>=c&&(d=b<c?b:c),g=a*d);g<Z.minZ&&(g=Z.minZ);g>Z.maxZ&&(g=Z.maxZ);return g};this.z482=function(a,b){return ka(a,b)};this.syncViewportToNavigator=function(b){var c=Z.imageR;0>c&&(c+=360);var d=jb(b.x,b.y,Z.imageZ,c,"image"),e=Z.imageX,g=Z.imageY;if(0==c){var f=d.x;b=d.y}else f=b.x,b=b.y;e=dX=e-f;g=dY=g-b;0!=c&&(270<=c?(e=dY,g=-dX):
180<=c?(e=-dX,g=-dY):90<=c&&(e=-dY,g=dX));c=e*Z.imageZ;g*=Z.imageZ;e=g+Ua;E.left=c+Ta+"px";E.top=e+"px";S&&za&&(Z.mobileDevice||Math.abs(c)>N/2||Math.abs(g)>P/2)&&v(S,db,Da,"simple",!1,"Updating backfill oversize display");Z.Viewer.syncComparisonViewport();Z.Viewer.syncOverlayViewports(null,a)};this.getStatus=function(a){a=Z.Utils.arrayIndexOfObjectValue(Pc,"state",a);return-1==a?!1:Pc[a].status};this.setStatus=function(a,b){var c=!1,d=Z.Utils.arrayIndexOfObjectValue(Pc,"state",a);-1==d?(c=b,Pc[Pc.length]=
{state:a,status:b}):(!Pc[d].status&&b&&(c=!0),Pc[d].status=b);c&&(Z.Utils.validateCallback(a),Z.Viewer.validateViewerStatus(a))};this.traceDebugValues=function(a,b,c,d){c="undefined"!==typeof c&&null!==c?c:null;b=null!==b?b:"";switch(a){case "tilesToDisplay":Kd=c;pd=vc=qd=Ld=0;wc=c;Hc=0;tilesTimeStart=(new Date).getTime();Md=0;window.clearTimeout(Zc);Zc=null;Zc=window.setTimeout(Ob,Ke);break;case "tilesInCache":Ld=c;break;case "z581-image-display":qd+=1;break;case "onTileLoad":vc+=1;Hc=((new Date).getTime()-
c)/1E3;Md=vc/Hc;break;case "z507":c=Z.Utils.arrayIndexOf(kc,b);-1!=c&&(kc.splice(c,1),pd+=1,--wc);break;case "tilesBackfillToPrecache":od=c;break;case "onTileBackfillPrecache":yb+=1;break;case "tilesBackfillToDisplay":Ve=be=c;break;case "z599":ce+=1;break;case "z507Backfill":c=Z.Utils.arrayIndexOf(gb,b),-1!=c&&(gb.splice(c,1),ee+=1,--Ve)}2!=Z.debug&&3!=Z.debug||Z.Utils.traceTileStatus(Kd,Ld,qd,vc,pd,wc);if(2==Z.debug){var e="undefined"!==typeof d&&null!==d&&0<d.length?d.join(", "):"none";c=!0;var g=
"";switch(a){case "updateView-noChange":g="Updating view: no change of tier.";break;case "tilesToDisplay":g="Tiles to display: "+e;break;case "tilesInCache":g="Tiles in cache: "+e;break;case "tilesToLoad":g="Tiles to load: "+e;break;case "tilesToLoad-backfill":g="Tiles to load-backfill: "+e;break;case "z622-viewportDisplay":a=[];e=0;for(g=d.length;e<g;e++)a[a.length]=d[e].name;g="Tiles from cache-"+b+": "+a.join(", ");break;case "z622-backfillDisplay":a=[];e=0;for(g=d.length;e<g;e++)a[a.length]=d[e].name;
g="Tiles from cache-"+b+": "+a.join(", ");break;case "z577-image-display":g="Tile requests for display: "+b+e;break;case "z577-image-backfill":g="Tile requests for backfill: "+b+e;break;case "imageRequestTimeout":g="Image request for "+b;break;case "z581-image-display":g="Tile request-display: "+b;c=!1;break;case "z581-image-backfill":g="Tile request-backfill: "+b;c=!1;break;case "z581DelayForOffset":g="Tile not yet being loaded - offset chunk loading in progress: "+b;break;case "onTileLoad":g="Tiles received-display: "+
b;c=!1;break;case "z599":g="Tiles received-backfill: "+b;0==qa.length&&(g+="\n\nTile loading complete for backfill: all requested tiles received.");c=!1;break;case "z532":g="Tile request recorded for after load offset chunk: "+b;break;case "selectTilesRetry":g="Requesting tiles after offset chunk received: "+e;break;case "z531":g="Tile request recorded for after load offset chunk: "+b;c=!1;break;case "selectTilesRetry":g="Requesting tiles after offset chunk received: "+e;c=!1;break;case "z577Retry":g=
b;break;case "z507":g="Tile displaying: "+b;c=!1;break;case "blankLine":g=" "}""!=g&&Z.Utils.trace(g,!1,c)}};this.updateProgress=function(a,b){var c=Z,d;0==a&&0==b?(Z.Utils.validateCallback("loadingTilesComplete"),Z.Utils.validateCallback("loadingTilesCompleteGetLabelIDs"),d=void 0):(d=Math.round(100-b/a*100),d=Math.round(d/10));c.updateViewPercent=d;Z.Toolbar&&Z.ToolbarDisplay&&Z.Toolbar.getInitialized()&&Z.Toolbar.updateProgress(a,b)};this.setViewNoUpdate=function(a,b,c,d,e,g,f,l,n,k,y){E.left=
a;E.top=b;X.width=c;X.height=d;X.left=e;X.top=g;J.width=f;J.height=l;J.left=n;J.top=k;0!=y&&Z.Utils.rotateElement(E,y,!0)};this.setView=function(a,b,c,d,e,g){ba(a,b,c,d,e,g)};this.zoom=function(a){if("stop"!=a||"stop"!=Z.zooming){switch(a){case "out":0<=kb&&(kb-=gd);break;case "in":0>=kb&&(kb+=gd);break;case "stop":kb=0}Z.zooming=0==kb?"stop":0<kb?"in":"out";if(0!=kb){if(!nc){if(0>kb&&Z.imageZ>Z.minZ||0<kb&&Z.imageZ<Z.maxZ)h.toggleWatermarks(!1),M&&39<M.length&&h.setHotspotsVisibility(!1);Z.useCanvas||
Z.Utils.clearDisplay(Ha);nc=window.setTimeout(g,ie)}}else k(),h.updateView(),h.toggleWatermarks(!0),M&&39<M.length&&h.setHotspotsVisibility(!0)}};this.pan=function(a){if("horizontalStop"!=a||"stop"!=Z.panningX)if("verticalStop"!=a||"stop"!=Z.panningY){if(!Z.tracking)switch(a){case "left":0>=pb&&(pb+=Rd);break;case "up":0>=qb&&(qb+=Rd);break;case "down":0<=qb&&(qb-=Rd);break;case "right":0<=pb&&(pb-=Rd);break;case "horizontalStop":pb=0;break;case "verticalStop":qb=0;break;case "stop":qb=pb=0}Z.panningX=
0==pb?"stop":0<pb?"left":"right";Z.panningY=0==qb?"stop":0<qb?"up":"down";ka(Q,1);ka(Q,1);0!=pb||0!=qb?nc||(h.toggleWatermarks(!1),Z.useCanvas||Z.Utils.clearDisplay(Ha),M&&39<M.length&&h.setHotspotsVisibility(!1),nc=window.setTimeout(g,ie)):(k(),h.updateView(),h.toggleWatermarks(!0),M&&39<M.length&&h.setHotspotsVisibility(!0))}};this.zoomAndPanToView=function(a,b,c,d,e,g,f,l){h.zoomAndPanAllStop();if(!Z.clickZoomAndPanBlock||"undefined"!==typeof l&&null!==l&&l){if("undefined"===typeof a||null===a)a=
Z.imageX;if("undefined"===typeof b||null===b)b=Z.imageY;if("undefined"===typeof c||null===c)c=Z.imageZ;if("undefined"===typeof d||null===d)d=Z.imageR;if("undefined"===typeof e||null===e)e=Pf;if("undefined"===typeof g||null===g)g=Od;if("center"==a||isNaN(parseFloat(a)))a=Z.imageCtrX;if("center"==b||isNaN(parseFloat(b)))b=Z.imageCtrY;if(-1==c||isNaN(parseFloat(c)))c=Z.fitZ;h.toggleWatermarks(!1);Z.useCanvas||Z.Utils.clearDisplay(Ha);M&&39<M.length&&h.setHotspotsVisibility(!1);"undefined"===typeof c||
null===c?c=Z.initialZ:100<c?c/=100:c>Z.maxZ?c=Z.maxZ:c<Z.maxZ&&c>Z.maxZ-.01&&(c=Z.maxZ);b=jb(a,b,c,d,"image");a=b.x;b=b.y;c=q(c);if(Math.round(a)!=Math.round(Z.imageX)||Math.round(b)!=Math.round(Z.imageY)||Math.round(1E5*c)!=Math.round(1E5*Z.imageZ)||Math.round(d)!=Math.round(Z.imageR))Z.interactive=!1,$c=0,Z.zoomAndPanInProgressID=a.toString()+"-"+b.toString()+"-"+c.toString()+"-"+d.toString(),O(a,b,c,d,e,g,f)}else Z.clickZoomAndPanBlock=!1};this.zoomAndPanAllStop=function(a,b){Z.interactive&&((null!==
Z.zoomAndPanInProgressID||rd)&&y(),Z.tourPlaying&&b&&(h.tourStop(),a=!1),Z.slideshowPlaying&&b&&(h.slideshowStop(),a=!1),Z.smoothPan&&null!==Nc&&(Z.mouseIsDown||vd(!0),a=!0),a||h.updateView(null,null,!0))};this.syncViewportRelated=function(b,c,d,e,g,f,l,n,k,y,O){Z.expressParamsEnabled&&(Z.sliderZoomVisible&&("undefined"===typeof d||null===d||d)&&(Z.Toolbar&&Z.ToolbarDisplay&&Z.Toolbar.getInitialized()&&(d=h.getZoom(),Z.Toolbar.syncSliderToViewportZoom(d)),Z.Utils.validateCallback("viewZoomingGetCurrentZoom")),
Z.Navigator&&("undefined"===typeof e||null===e||e)&&Ea());Z.proParamsEnabled&&(Z.watermarks&&("undefined"===typeof b||null===b||b)&&rez508s(),M&&("undefined"===typeof c||null===c||c)&&z623(),Z.Ruler&&("undefined"===typeof g||null===g||g)&&Z.Ruler&&Z.Ruler.getInitialized()&&Z.Ruler.syncToViewport(),Z.sliderImageSetVisible&&"undefined"!==typeof f&&f&&Z.Viewer.syncToolbarImageSetSliderToViewport(Z.viewportCurrentID),Z.comparison&&("undefined"===typeof l||null===l||l)&&Z.Viewer.syncComparisonViewport(l),
Z.overlays&&("undefined"===typeof n||null===n||n)&&Z.Viewer.syncOverlayViewports(n,a),Z.bookmarksSet&&"undefined"!==typeof k&&null!==k&&k&&Z.Utils.setBookmarksURL());Z.enterpriseParamsEnabled&&(Z.Magnifier&&("undefined"===typeof O||null===O||O)&&syncMagnifierToViewport(),Z.tracking&&("undefined"===typeof y||null===y||y)&&h.syncTrackingToViewport());Z.Utils.validateCallback("viewChanging");Z.Utils.validateCallback("viewPanningGetCurrentCoordinates");Z.Utils.validateCallback("viewChangingGetCurrentCoordinatesFull")};
this.scaleTierToZoom=function(a,b){cc(a,b)&&h.syncViewportRelated()};this.reset=function(a){Z.maskingSelection&&Z.maskClearOnUserAction&&h.clearMask();a?(Z.Utils.setButtonDefaults(buttonReset),h.zoomAndPanToView(Z.priorX,Z.priorY,Z.priorZ,Z.priorR)):h.zoomAndPanToView(Z.initialX,Z.initialY,Z.initialZ,Z.initialR);Pb(!0)};this.labelScale=function(a){switch(a){case "down":0<=Qb&&(Qb-=Vd);break;case "up":0>=Qb&&(Qb+=Vd);break;case "stop":Qb=0}0!=Qb?Ic||(Ic=window.setTimeout(Le,Me)):(Ic&&(window.clearTimeout(Ic),
Ic=null),Qb=0)};this.toggleWatermarks=function(a){if(Ib){var b="inline-block"==Ib.display;Ib.display=("undefined"!==typeof a&&null!==a?a:!b)?"inline-block":"none"}};this.toggleConstrainPan=function(a){Z.constrainPan="undefined"!==typeof a&&null!==a?a:!Z.constrainPan;if(Z.constrainPan){a=parseFloat(X.left);var b=parseFloat(X.top);a=jb(a,b,Z.imageZ,Z.imageR,"container");E.left=a.x+"px";E.top=a.y+"px";h.updateView()}};this.toggleSmoothPan=function(){vd();Z.smoothPan=!Z.smoothPan};this.toggleSmoothZoom=
function(){y();Z.smoothZoom=!Z.smoothZoom};this.buttonToggleBackfillHandler=function(){h.toggleBackfill()};this.toggleBackfill=function(a){var b=document.getElementById("viewportBackfillDisplay"+Oa.toString());if(b){var b=b.style,c="inline-block"==b.display;b.display=("undefined"!==typeof a&&null!==a?a:!c)?"inline-block":"none"}};this.buttonToggleDisplayHandler=function(){h.toggleDisplay()};this.toggleDisplay=function(a){var b=document.getElementById("viewportDisplay"+Oa.toString());b&&(X=b.style,
b="inline-block"==X.display,X.display=("undefined"!==typeof a&&null!==a?a:!b)?"inline-block":"none")};this.toggleDisplaysOther=function(a){a=a?"inline-block":"none";Aa&&(Aa.display=a);J&&(J.display=a);Sb&&(Sb.display=a);Ib&&(Ib.display=a);Qa&&(Qa.display=a);Sa&&(Sa.display=a);Jb&&(Jb.display=a);Cc&&(Cc.display=a)};this.zoomAndPanToZoomRectangle=function(a){var b=Math.min(a[0].x,a[1].x,a[2].x,a[3].x),c=Math.max(a[0].x,a[1].x,a[2].x,a[3].x),d=Math.min(a[0].y,a[1].y,a[2].y,a[3].y);a=Math.max(a[0].y,
a[1].y,a[2].y,a[3].y);c-=b;a-=d;var b=b+c/2,d=d+a/2,e=h.getRotation(),c=h.z468(c,a,e);h.zoomAndPanToView(b,d,c)};this.toggleFullViewModeExternal=function(){ye=!0;h.toggleFullViewMode()};this.toggleFullViewMode=function(a,b){Z.maskingSelection&&Z.maskClearOnUserAction&&h.clearMask();Z.ToolbarDisplay&&Z.Toolbar&&Z.Toolbar.show(!1);var c=null,d=null;Z.fullViewPrior=Z.fullView;Z.fullView="undefined"!==typeof a&&null!==a?a:!Z.fullView;var e=document.body.style,g=document.documentElement.style,f=Z.ViewerDisplay.style,
c=Z.Utils.getElementStyle(Z.pageContainer);Z.fullView?(d=Z.Utils.getContainerSize(Z.pageContainer,Z.ViewerDisplay),ve=d.x,we=d.y,bf=e.overflow,cf=g.overflow,xe=Z.Utils.stringValidate(c.backgroundColor)&&"transparent"!=c.backgroundColor?c.backgroundColor:Z.Utils.stringValidate(e.backgroundColor)&&"transparent"!=e.backgroundColor?e.backgroundColor:Z.Utils.getResource("z120"),df=f.zIndex,Z.fullScreenSupported&&!Z.fullPageVisible?(d=Z.Utils.getScreenSize(),Z.fullScreenEntering=!0,Z.Utils.fullScreenView(Z.ViewerDisplay,
!0),Z.Utils.validateCallback("fullscreenEntered")):(d=Z.Utils.getWindowSize(),Z.mobileDevice?(e.width=d.x,e.height=d.y):(e.width="100%",e.height="100%"),Z.Utils.validateCallback("fullpageEntered")),c=d.x,d=d.y,e.overflow="hidden",g.overflow="hidden",f.backgroundColor=xe,f.position="fixed",f.zIndex="99999999",Z.autoResize&&Z.Utils.removeEventListener(window,"resize",Z.Viewer.viewerEventsHandler)):(e.overflow=bf,g.overflow=cf,f.backgroundColor=xe,f.position="relative",f.zIndex=df,Z.fullScreenSupported&&
!Z.fullPageVisible?(Z.Utils.fullScreenView(Z.ViewerDisplay,!1,b),Z.Utils.validateCallback("fullscreenExited")):Z.Utils.validateCallback("fullpageExited"),e.width=ve,e.height=we,c=ve,d=we,isNaN(c)&&(c=Z.ViewerDisplay.clientWidth),isNaN(d)&&(d=Z.ViewerDisplay.clientHeight),ye=!1,Z.autoResize&&Z.Utils.addEventListener(window,"resize",Z.Viewer.viewerEventsHandler));Z.initialFullPage&&h.setSizeAndPosition(c,d);e=Z.viewportCurrent.calculateZoomForResize(Z.viewportCurrent.getZoom(),Z.viewerW,Z.viewerH,c,
d);Z.Viewer.resizeViewer(c,d,e);e=null;if(Z.slideshow)Z.Toolbar.gallerySizeAndPositionReset();else if(Z.comparison)(e=0==h.getViewportID()?Z.Viewport1:Z.Viewport0)&&e.syncViewportResize(Z.imageX,Z.imageY,Z.imageZ,Z.imageR);else if(Z.overlays)for(g=0,f=Z.imageSetLength-1;g<f;g++)Z["Viewport"+g.toString()].syncViewportResize(Z.imageX,Z.imageY,Z.imageZ,Z.imageR);else Z.narrative&&(Z.Narrative.drawLayoutNarrativePanel(),Z.narrativeMode&&Z.Narrative.drawLayoutFileManagerPanel());Z.imageList&&h.getStatus("initializedImageList")&&
(h.setSizeAndPositionImageList(),e&&e.getStatus("initializedImageList")&&e.setSizeAndPositionImageList());Z.annotationFileList&&h.getStatus("initializedAnnotationFileList")&&h.setSizeAndPositionAnnotationFileList();e=Z.fullView;g=document.getElementById("buttonFullView");f=document.getElementById("buttonFullViewExit");g&&f&&(g.style.display=e?"none":"inline-block",f.style.display=e?"inline-block":"none");ye?(hd||(e=Z.Utils.getResource("z420"),g=parseFloat(Z.viewerW)-54,f=parseFloat(Z.viewerH)-54,
c=Z.Utils.getResource("DEFAULT_FULLVIEWEXITEXTERNALBUTTONCOLOR"),hd=new Z.Utils.Button("buttonFullViewExitExternal",e,null,null,null,null,"34px","34px",g+"px",f+"px","mousedown",zf,"z391EXITEXTERNAL","solid","1px",c,"0px","0px"),Z.ViewerDisplay.appendChild(hd.elmt)),hd.elmt.style.display="inline-block"):hd&&(hd.elmt.style.display="none");Z.fullViewPrior=!1};this.rotate=function(a,b){if(!Z.rotationFree||b)0!=Z.imageR%90&&(Z.imageR=90*Math.round(Z.imageR/90)),h.rotateStep("clockwise"==a?90:-90,!0);
else if("stop"!=a||"stop"!=Z.rotating)Kc="stop"==a?0:"clockwise"==a?af:-af,Z.rotating=0==Kc?"stop":0<Kc?"clockwise":"counterwise",0!=Kc?Jc||(Jc=window.setTimeout(Ne,Oe)):(Kc=0,Jc&&(window.clearTimeout(Jc),Jc=null),h.updateView())};this.rotateStep=function(a,b,c){h.rotateSet(Z.imageR+a,b,c)};this.rotateSet=function(a,b,c){if(Z.interactive)if(Z.rotationSupported)if(Z.rotationFree)c?(Z.Utils.rotateElement(E,Z.imageR,!0),Z.interactive=!0):(Z.Utils.rotateElement(E,a),Z.imageR=a,Ea());else{Z.interactive=
!1;var d=H(a);b?h.zoomAndPanToView(Z.imageX,Z.imageY,Z.imageZ,a,600,12,function(){Z.imageR=d}):c?(Z.Utils.rotateElement(E,Z.imageR,!0),Z.interactive=!0):(Z.Utils.rotateElement(E,a),S&&0!=Z.imageR&&ya.rotate((a-Z.imageR)*Math.PI/180),Z.imageR=d,h.zoomAndPanToView(Z.imageX,Z.imageY,Z.imageZ))}else Z.Utils.showMessage(Z.Utils.getResource("z12"))};this.toggleEditModeMeasure=function(a){h.zoomAndPanAllStop();Z.maskingSelection&&Z.maskClearOnUserAction&&h.clearMask();"undefined"!==typeof a&&!a||"measure"==
Z.labelMode?(null===Z.editMode&&"measure"==Z.labelMode&&0<M.length&&(h.deleteAllMeasureHotspots(),va=null),h.setEditModeLabel("view")):h.setEditModeLabel("measure",null,null,null,null,!0)};this.getTargetHotspot=function(a){return sd(a)};this.updateAnnotationPanelForNewLabel=function(){var a=Qc[Qc.length-1];z611(a.poiID,a.value);Z.annotationsAddMultiple||(Z.editing="editLabel")};this.getSmoothPanGliding=function(){return Ka};this.setSmoothPanGliding=function(a){Ka=a};this.fullScreenEscapeHandler=function(a){Z.fullScreenEntering?
Z.fullScreenEntering=!1:h.toggleFullViewMode(!1,!0)};this.mouseWheelHandler=function(a,b){Z.mouseWheelIsDown=!0;Z.mouseWheelCompleteTimer&&window.clearTimeout(Z.mouseWheelCompleteTimer);Z.mouseWheelCompleteTimer=window.setTimeout(Z.Viewer.z586,Z.mouseWheelCompleteDuration);if(!("zoom"!=Z.sliderFocus||Z.imageSet&&b)){var c=h.z482(Q,W*(1+(0<a?gd:-gd)));constrainedZ=q(c);constrainedZ!=Z.imageZ&&(Z.zooming=0<a?"in":0>a?"out":"stop",h.scaleTierToZoom(constrainedZ))}else if("imageSet"==Z.sliderFocus||b)0<
a?Z.Viewer.viewportNext():0>a&&Z.Viewer.viewportPrior()}};
Z.ZoomifyToolbar=function(a){function b(){parseFloat(Z.Utils.getResource("UI_TOOLBARINTERNALBACKGROUNDALPHA"));var a=Z.Utils.getResource("UI_TOOLBARINTERNALBACKGROUNDCOLOR"),b=Z.Utils.getResource("UI_TOOLBARINTERNALBUTTONUPCOLOR"),c=Z.viewerW/2-50,d=Z.viewerH-25-10,f=Math.round(25),l=Math.round(25/1.5),n=(100-3*f)/4,q=(25-l)/2;Z.ToolbarDisplay=Z.Utils.createContainerElement("div","ToolbarDisplay","inline-block","absolute","visible","100px","25px",c+"px",d+"px","none","0px","transparent none","0px",
"0px","normal");w=Z.ToolbarDisplay.style;c=Z.Utils.createContainerElement("div","buttonZoomOutInternal","inline-block","absolute","visible",f+"px",l+"px",n+1+"px",q+1+"px","none","0px",b,"0px","0px","normal");Z.Utils.setOpacity(c,.6,a);c.setAttribute("title",Z.Utils.getResource("z400"));d=document.createTextNode(Z.Utils.getResource("UI_TOOLBARINTERNALBUTTONZOOMOUTTEXT"));c.appendChild(d);Z.ToolbarDisplay.appendChild(c);G=c.style;G.borderRadius="3px";Z.Utils.setTextNodeStyle(d,"black","verdana","15px",
"none","normal","normal","normal","bold","1em","center","none");Z.Utils.disableTextInteraction(d);d=Z.Utils.createContainerElement("div","buttonResetInternal","inline-block","absolute","visible",f+"px",l+"px",2*n+f+1+"px",q+1+"px","none","0px",b,"0px","0px","normal");Z.Utils.setOpacity(d,.6,a);d.setAttribute("title",Z.Utils.getResource("z378"));var m=document.createTextNode(Z.Utils.getResource("UI_TOOLBARINTERNALBUTTONRESETTEXT"));d.appendChild(m);Z.ToolbarDisplay.appendChild(d);aa=d.style;aa.borderRadius=
"3px";Z.Utils.setTextNodeStyle(m,"blue","verdana","15px","none","normal","normal","normal","bold","1em","center","none");Z.Utils.disableTextInteraction(m);b=Z.Utils.createContainerElement("div","buttonZoomInInternal","inline-block","absolute","visible",f+"px",l+"px",3*n+2*f+1+"px",q+1+"px","none","0px",b,"0px","0px","normal");Z.Utils.setOpacity(b,.6,a);b.setAttribute("title",Z.Utils.getResource("z399"));a=document.createTextNode(Z.Utils.getResource("UI_TOOLBARINTERNALBUTTONZOOMINTEXT"));b.appendChild(a);
Z.ToolbarDisplay.appendChild(b);v=b.style;v.borderRadius="3px";Z.Utils.setTextNodeStyle(a,"black","verdana","15px","none","normal","normal","normal","bold","1em","center","none");Z.Utils.disableTextInteraction(a);Z.Utils.addEventListener(c,"mouseover",x);Z.Utils.addEventListener(c,"mousedown",x);Z.Utils.addEventListener(c,"mouseup",x);Z.Utils.addEventListener(c,"mouseout",x);Z.Utils.addEventListener(c,"touchstart",x);Z.Utils.addEventListener(c,"touchend",x);Z.Utils.addEventListener(c,"touchcancel",
x);Z.Utils.addEventListener(d,"mouseover",x);Z.Utils.addEventListener(d,"mousedown",x);Z.Utils.addEventListener(d,"mouseup",x);Z.Utils.addEventListener(d,"mouseout",x);Z.Utils.addEventListener(d,"touchstart",x);Z.Utils.addEventListener(d,"touchend",x);Z.Utils.addEventListener(d,"touchcancel",x);Z.Utils.addEventListener(b,"mouseover",x);Z.Utils.addEventListener(b,"mousedown",x);Z.Utils.addEventListener(b,"mouseup",x);Z.Utils.addEventListener(b,"mouseout",x);Z.Utils.addEventListener(b,"touchstart",
x);Z.Utils.addEventListener(b,"touchend",x);Z.Utils.addEventListener(b,"touchcancel",x);w.zIndex=(Z.baseZIndex+2).toString();Z.ViewerDisplay.appendChild(Z.ToolbarDisplay);Z.Utils.addEventListener(Z.ToolbarDisplay,"mouseover",Z.Utils.stopPropagation);e(!0)}function c(){Z.Gallery&&Z.Gallery.getInitialized()?Z.Gallery.setSizeAndPosition():window.setTimeout(c,100)}function d(){window.clearInterval(Ia);Ia=null;var a=document.getElementById("progressTextBoxCenteredDiv");a&&(a=a.firstChild)&&(a.nodeValue=
"")}function e(a){!A&&a&&(A=!0,Z.Utils.validateCallback("toolbarInitialized"),Z.Viewer.validateViewerReady("toolbarInitialized"))}function f(a){4>Z.toolbarVisible&&!Z.mobileDevice||8==Z.toolbarVisible||Z.toolbarInternal?m(a):u(!a)}function m(a){w&&(w.display=a?"inline-block":"none")}function u(a){Z.ToolbarMinimized=a;if(w){var b=document.getElementById("buttonContainer"),c=document.getElementById("toolbarBackground"),d=document.getElementById("buttonMinimize"),e=document.getElementById("buttonExpand"),
f=document.getElementById("logoDivider"),l=0;e&&!ka&&(l=parseFloat(e.style.left)+parseFloat(e.style.width)+4);if(Z.imageFilters)var n=document.getElementById("imageFilterPanelBackground"),q=document.getElementById("buttonContainerImageFilter");var m=Z.toolbarCurrentW;a?(b&&(b.style.display="none"),d&&e&&!ka&&(f&&(f.style.display="none"),d.style.display="none",e.style.display="inline-block"),w.width=l+"px",c&&(c.style.width=l+"px"),n&&q&&(n.style.width="0px",q.style.display="none")):(b&&(b.style.display=
"inline-block"),d&&e&&!ka&&(f&&(f.style.display="inline-block"),d.style.display="inline-block",e.style.display="none"),w.width=m+"px",c&&(c.style.width=m+"px"),n&&q&&imageFilterPanelVisible&&(n.style.width=imageFilterPanelW+"px",q.style.display="inline-block"))}}function t(a){if("undefined"!==typeof trszS&&"undefined"!==typeof btszS){a=(a-Z.minZ)/(Z.maxZ-Z.minZ);var b=parseFloat(trszS.left),c=parseFloat(trszS.left)+parseFloat(trszS.width)-parseFloat(btszS.width)-b;btszS.left=a*c+b+"px"}}function B(a){"undefined"!==
typeof btsZ&&(F=!0,a=Z.Utils.getMousePosition(a),btsZ.mouseXPrior=a.x,btsZ.mouseYPrior=a.y)}function C(){if("undefined"!==typeof trszS&&"undefined"!==typeof btsZ&&"undefined"!==typeof btszS){var b=parseFloat(trszS.left),c=parseFloat(trszS.left)+parseFloat(trszS.width)-parseFloat(btszS.width),d=parseFloat(btszS.left)+(xb.x-btsZ.mouseXPrior);d<b?d=b:d>c?d=c:btsZ.mouseXPrior=xb.x;btszS.left=d+"px";b=Z.minZ+(d-b)/(c-b)*(Z.maxZ-Z.minZ);c=b-a.getZoom();Z.zooming=0<c?"in":0>c?"out":"stop";a.scaleTierToZoom(b)}}
function x(b){if(b=Z.Utils.event(b)){var c=b.type,d=Z.Utils.target(b);if(d){G.background=ja;aa.background=ja;v.background=ja;var e=d.id;b=b.altKey;if("mousedown"==c||"touchstart"==c)c="start";if("mouseup"==c||"touchend"==c||"touchcancel"==c)c="end";switch(c){case "mouseover":d.style.background=I;break;case "start":d.style.background=T;"buttonZoomInInternal"==e?b||a.zoom("in"):"buttonZoomOutInternal"==e&&(b||a.zoom("out"));break;case "end":d.style.background=I,a.zoom("stop"),"buttonResetInternal"==
e&&a.reset(b)}}}}function p(b){if(b=Z.Utils.event(b)){var c=b.type,d=Z.Utils.target(b);if(d){var e=d.parentNode;if(e){var f=e;tbID=e.id}}d=Z.Utils.relatedTarget(b)}"mousedown"==c&&a&&"buttonMinimize"!=tbID&&"buttonExpand"!=tbID&&"buttonAudioOn"!=tbID&&"buttonAudioMuted"!=tbID&&(a.zoomAndPanAllStop(!1,!0),Z.maskingSelection&&Z.maskClearOnUserAction&&a.clearMask());if((Z.interactive||"mousedown"!=c&&"mouseup"!=c||"buttonRotateClockwise"==tbID||"buttonRotateCounterwise"==tbID)&&(!d||"[object HTMLSelectElement]"!=
d&&"[object HTMLOptionElement]"!=d)&&!Z.Utils.isRightMouseButton(b)){Z.touchSupport&&b.preventDefault();if(tbID&&-1!=tbID.indexOf("viewportContainer")||F||Pb||H)F?e=document.getElementById("buttonSliderZoom"):H&&(e=document.getElementById("buttonSliderImageSet")),e&&(tbID=e.id);L(e,c);if(tbID&&"buttonBackground"!=tbID&&c)switch(c){case "click":c=-1!=tbID.toLowerCase().indexOf("checkbox");a&&c&&R(b,tbID);break;case "mouseover":if("trackSliderZoom"!=tbID&&"trackSliderImageSet"!=tbID)if(Z.Utils.removeEventListener(e.childNodes[0],
"mouseover",p),Z.Utils.addEventListener(e.childNodes[1],"mousedown",p),Z.Utils.addEventListener(e.childNodes[1],"mouseout",p),F&&f&&Z.Utils.addEventListener(f.childNodes[0],"mouseup",p),H&&f&&Z.Utils.addEventListener(f.childNodes[0],"mouseup",p),"buttonZoomIn"==tbID||"buttonSliderZoom"==tbID||"buttonZoomOut"==tbID)Z.sliderFocus="zoom";else{if("buttonImageSetPrior"==tbID||"buttonSliderImageSet"==tbID||"buttonImageSetNext"==tbID)Z.sliderFocus="imageSet"}else Z.Utils.addEventListener(e.childNodes[0],
"mouseout",p),Z.sliderFocus="trackSliderImageSet"==tbID?"imageSet":"zoom";break;case "mousedown":Z.buttonIsDown=!0;!Z.fullView&&document.activeElement&&document.activeElement.blur();"trackSliderZoom"!=tbID&&"trackSliderImageSet"!=tbID&&-1==tbID.indexOf("trackSliderFilter")?(Z.Utils.removeEventListener(e.childNodes[1],"mousedown",p),Z.Utils.removeEventListener(e.childNodes[1],"mouseout",p),Z.Utils.addEventListener(e.childNodes[2],"mouseup",p),Z.Utils.addEventListener(e.childNodes[2],"mouseout",p),
"buttonSliderZoom"==tbID?(B(b),ea(b),Z.Utils.addEventListener(document,"mousemove",ea),ha||(ha=window.setInterval(C,U)),Z.Utils.addEventListener(document,"mouseup",p)):-1!=tbID.indexOf("buttonSliderFilter")?(imageFilterEventsManager(b,tbID,"sliderStart"),sliderMouseMoveHandlerFilter(b,tbID),Z.Utils.addEventListener(document,"mousemove",sliderMouseMoveHandlerFilter),ba||(ba=window.setInterval(function(){imageFilterEventsManager(b,tbID,"sliderSlide")},Ob)),Z.Utils.addEventListener(document,"mouseup",
p)):"buttonSliderImageSet"==tbID&&(sliderSlideStartImageSet(b),sliderMouseMoveHandlerImageSet(b),Z.Utils.addEventListener(document,"mousemove",sliderMouseMoveHandlerImageSet),Ea||(Ea=window.setInterval(sliderSlideImageSet,q)),Z.Utils.addEventListener(document,"mouseup",p))):Z.Utils.addEventListener(document,"mouseup",p);a&&R(b,tbID);break;case "mouseup":Z.buttonIsDown=!1;"trackSliderZoom"!=tbID&&"trackSliderImageSet"!=tbID&&-1==tbID.indexOf("trackSliderFilter")?(Z.Utils.removeEventListener(e.childNodes[2],
"mouseup",p),Z.Utils.removeEventListener(e.childNodes[2],"mouseout",p),Z.Utils.addEventListener(e.childNodes[1],"mousedown",p),Z.Utils.addEventListener(e.childNodes[1],"mouseout",p),f&&(F||Pb||H)&&Z.Utils.removeEventListener(f.childNodes[0],"mouseup",p)):Z.Utils.addEventListener(document,"mouseup",p);a&&R(b,tbID);break;case "mouseout":if("trackSliderZoom"!=tbID&&-1==tbID.indexOf("trackSliderFilter")&&"trackSliderImageSet"!=tbID){if(Z.Utils.removeEventListener(e.childNodes[1],"mousedown",p),Z.Utils.removeEventListener(e.childNodes[1],
"mouseout",p),Z.Utils.addEventListener(e.childNodes[0],"mouseover",p),a&&R(b,tbID),"buttonImageSetPrior"==tbID||"buttonSliderImageSet"==tbID||"trackSliderImageSet"==tbID||"buttonImageSetNext"==tbID||"buttonZoomIn"==tbID||"buttonSliderZoom"==tbID||"buttonZoomOut"==tbID)Z.sliderFocus=2==Z.mouseWheel?"imageSet":"zoom"}else Z.Utils.removeEventListener(e.childNodes[0],"mouseout",p),Z.sliderFocus=2==Z.mouseWheel?"imageSet":"zoom";break;case "touchstart":"buttonSliderZoom"==tbID?(B(b),K(b),Z.Utils.addEventListener(document,
"touchmove",K),ha||(ha=window.setInterval(C,U))):-1!=tbID.indexOf("buttonSliderFilter")?(imageFilterEventsManager(b,tbID,"sliderStart"),sliderTouchMoveHandlerFilter(b,tbID),Z.Utils.addEventListener(document,"touchmove",sliderTouchMoveHandlerFilter),ba||(ba=window.setInterval(function(){imageFilterEventsManager(b,tbID,"sliderSlide")},Ob))):"buttonSliderImageSet"==tbID&&(sliderSlideStartImageSet(b),sliderTouchMoveHandlerImageSet(b),Z.Utils.addEventListener(document,"touchmove",sliderTouchMoveHandlerImageSet),
Ea||(Ea=window.setInterval(sliderSlideImageSet,q)));Z.Utils.addEventListener(e,"touchend",p);Z.Utils.addEventListener(e,"touchcancel",p);a&&R(b,tbID);break;case "touchend":Z.Utils.addEventListener(e,"touchstart",p);a&&R(b,tbID);break;case "touchcancel":Z.Utils.addEventListener(e,"touchstart",p);a&&R(b,tbID);break;case "MSPointerDown":"buttonSliderZoom"==tbID?(B(b),K(b),Z.Utils.addEventListener(document,"MSPointerMove",K),ha||(ha=window.setInterval(C,U))):-1!=tbID.indexOf("SliderFilter")?(imageFilterEventsManager(b,
tbID,"sliderStart"),sliderTouchMoveHandlerFilter(b,tbID),Z.Utils.addEventListener(document,"MSPointerMove",sliderTouchMoveHandlerFilter),ba||(ba=window.setInterval(function(){imageFilterEventsManager(b,tbID,"sliderSlide")},Ob))):"buttonSliderImageSet"==tbID&&(sliderSlideStartImageSet(b),sliderTouchMoveHandlerImageSet(b),Z.Utils.addEventListener(document,"MSPointerMove",sliderTouchMoveHandlerImageSet),Ea||(Ea=window.setInterval(sliderSlideImageSet,q)));Z.Utils.addEventListener(e,"MSPointerUp",p);a&&
R(b,tbID);break;case "MSPointerUp":Z.Utils.addEventListener(e,"MSPointerDown",p),a&&R(b,tbID)}}}function R(b,c){var d=b.type,e=Z.annotationFileShared?"0":l,f=b.altKey;if("click"==d)Z.comparison&&-1!=c.indexOf("Sync")?(e=Z.Utils.target(b),Z.syncComparison=e.checked,Z.Viewer.syncComparisonViewport(!0)):Z.tracking&&-1!=c.indexOf("Count")?a.trackingEventsManager(b,c):Z.userLogging&&-1!=c.indexOf("User")?a.trackingEventsManager(b,c):Z.imageFilters&&-1!=c.indexOf("Filter")&&imageFilterEventsManager(b,c,
"checkbox");else if("mousedown"==d||"touchstart"==d)switch(d=document.activeElement.id,!Z.Utils.stringValidate(d)||d!="poiNameTextElement"+l&&d!="labelNameTextElement"+l&&"captionTextElement"!=d&&"commentTextElement"!=d&&"tooltipTextElement"!=d&&"clickURLTextElement"!=d&&d!="noteNameTextElement"+l&&d!="noteTextElement"+l||document.getElementById(d).blur(),n.positionButtonBorder(c),Z.tracking&&-1!=c.indexOf("buttonCounterListShow")&&(c="buttonCounterListShow"),c){case "buttonMinimize":f?a.setHotspotsVisibility(!a.getHotspotsVisibility()):
(n.minimize(!0),Z.Navigator&&(Z.Navigator.setVisibility(!1),Z.comparison&&Z.Navigator2.setVisibility(!1)),Z.Ruler&&Z.Ruler.setVisibility(!1),Z.viewportCurrent&&Z.viewportCurrent.showLists(!1),!Z.annotations||2!=Z.annotationPanelVisible&&3!=Z.annotationPanelVisible||Z.Toolbar.setVisibilityAnnotationPanel(!1),!Z.tracking||2!=Z.trackingPanelVisible&&3!=Z.trackingPanelVisible||Z.Toolbar.setVisibilityTrackingPanel(!1),2!=Z.userPanelVisible&&3!=Z.userPanelVisible||Z.Toolbar.setVisibilityUserPanel(!1),Z.Gallery&&
Z.Gallery.setVisibility(!1),Z.viewportCurrent&&0<Z.magnifierVisible&&Z.viewportCurrent.setVisibilityMagnifier(!1));break;case "buttonExpand":f?a.setHotspotsVisibility(!a.getHotspotsVisibility()):(n.minimize(!1),Z.Navigator&&(Z.Navigator.setVisibility(!0),Z.comparison&&Z.Navigator2.setVisibility(!0)),Z.Ruler&&Z.Ruler.setVisibility(!0),!Z.viewportCurrent||Z.narrative&&!Z.narrativeMode||Z.viewportCurrent.showLists(!0),!Z.annotations||2!=Z.annotationPanelVisible&&3!=Z.annotationPanelVisible||Z.Toolbar.setVisibilityAnnotationPanel(!0),
!Z.tracking||2!=Z.trackingPanelVisible&&3!=Z.trackingPanelVisible||Z.Toolbar.setVisibilityTrackingPanel(!0),2!=Z.userPanelVisible&&3!=Z.userPanelVisible||Z.Toolbar.setVisibilityUserPanel(!0),Z.Gallery&&Z.Gallery.setVisibility(!0),Z.viewportCurrent&&1<Z.magnifierVisible&&Z.viewportCurrent.setVisibilityMagnifier(!0));break;case "buttonZoomOut":f||a.zoom("out");break;case "buttonZoomIn":f||a.zoom("in");break;case "buttonPanLeft":a.pan("left");break;case "buttonPanUp":a.pan("up");break;case "buttonPanDown":a.pan("down");
break;case "buttonPanRight":a.pan("right");break;case "buttonReset":a.reset(f);break;case "buttonFullView":break;case "buttonFullViewExit":break;case "buttonMeasure":a.toggleEditModeMeasure(!0);break;case "buttonMeasureExit":a.toggleEditModeMeasure(!1);break;case "buttonHelp":Z.annotations&&null===Z.editMode?Z.Utils.showHelp(Z.Utils.getResource("z32")+Z.Utils.getResource("z30")+Z.Utils.getResource("z29")):Z.Utils.showHelp(Z.Utils.getResource("z32"));break;case "buttonHelpMarkup"+e:Z.Utils.showHelp(Z.Utils.getResource("z31"));
break;case "buttonHelpAnnotation"+e:Z.Utils.showHelp(Z.Utils.getResource("z28"));break;case "buttonRotateClockwise":a.rotate("clockwise",f);break;case "buttonRotateCounterwise":a.rotate("counterwise",f);break;case "buttonTourPrior":a.priorDestination(!0);break;case "buttonTourNext":a.nextDestination(!0);break;case "buttonTourStart":a.tourStart();break;case "buttonTourStop":a.tourStop();break;case "buttonSlideshowPrior":a.priorSlide(!0);break;case "buttonSlideshowNext":a.nextSlide(!0);break;case "buttonSlideshowStart":a.slideshowStart();
break;case "buttonSlideshowStop":a.slideshowStop();break;case "buttonAudioOn":a.audioMute(!0);break;case "buttonAudioMuted":a.audioMute(!1);break;case "buttonImageSetPrior":Z.animation&&Z.Viewer.viewportChange("backward");break;case "buttonImageSetNext":Z.animation&&Z.Viewer.viewportChange("forward");break;case "buttonPreload":Z.imageSet?Z.Viewer.prez581s():Z.Viewport.prez581s();break;case "buttonPOIGo"+e:a.goToPOICurrent();break;case "buttonPOIAdd"+e:a.addNewPOI();break;case "buttonPOIEdit"+e:a.editCurrentPOI();
break;case "buttonPOIDelete"+e:a.deleteCurrentPOI();break;case "buttonPOICancel"+e:a.cancelEditsPOI();break;case "buttonPOISave"+e:a.saveEditsPOI();break;case "buttonLabelGo"+e:a.goToLabelCurrent();break;case "buttonLabelAdd"+e:a.addNewLabel();break;case "buttonLabelEdit"+e:a.editCurrentLabel();break;case "buttonLabelDelete"+e:a.deleteCurrentLabel();break;case "buttonLabelCancel"+e:a.cancelEditsLabel();break;case "buttonLabelSave"+e:a.saveEditsLabel(!1,!0,!0);break;case "buttonNoteAdd"+e:a.addNewNote();
break;case "buttonNoteEdit"+e:a.editCurrentNote();break;case "buttonNoteDelete"+e:a.deleteCurrentNote();break;case "buttonNoteCancel"+e:a.cancelEditsNote();break;case "buttonNoteSave"+e:a.saveEditsNote();break;case "buttonClearAll"+e:a.deleteAllAnnotations();break;case "buttonViewMode"+e:a.setEditModeLabel("view");break;case "buttonEditModeFieldOfView"+e:a.setEditModeLabel("fieldofview",null,null,null,null,!0);break;case "buttonEditModeText"+e:a.setEditModeLabel("text",null,null,null,null,!0);break;
case "buttonEditModeShape"+e:(e=a.getLabelShapePickerVisibility())||a.setEditModeLabel("shape",!0,null,null,null,!0);a.toggleLabelShapePicker(!e);a.toggleLabelLineStylePicker(!1);a.toggleLabelColorPicker(!1);break;case "buttonEditModeFreehand"+e:a.setEditModeLabel("freehand",null,null,null,null,!0);break;case "buttonEditModePolygon"+e:a.setEditModeLabel("polygon",null,null,null,null,!0);break;case "buttonEditModeMeasure"+e:a.setEditModeLabel("measure",null,null,null,null,!0);break;case "buttonEditLineStyle"+
e:a.toggleLabelShapePicker(!1);a.toggleLabelLineStylePicker();a.toggleLabelColorPicker(!1);break;case "buttonEditColorPicker"+e:a.toggleLabelShapePicker(!1);a.toggleLabelLineStylePicker(!1);a.toggleLabelColorPicker();break;case "buttonNarrativeBold":Z.Narrative.setSelectedTextFormat("bold");break;case "buttonNarrativeItalic":Z.Narrative.setSelectedTextFormat("italic");break;case "buttonNarrativeUnderline":Z.Narrative.setSelectedTextFormat("underline");break;case "buttonNarrativeScaleDown":Z.Narrative.setSelectedTextFontSize("down");
break;case "buttonNarrativeScaleUp":Z.Narrative.setSelectedTextFontSize("up");break;case "buttonNarrativeAlignLeft":Z.Narrative.setCurrentParagraphAlignment("left");break;case "buttonNarrativeAlignCenter":Z.Narrative.setCurrentParagraphAlignment("center");break;case "buttonNarrativeAlignRight":Z.Narrative.setCurrentParagraphAlignment("right");break;case "buttonNarrativeAlignJustify":Z.Narrative.setCurrentParagraphAlignment("justify");break;case "buttonNarrativeSetInitialImage":Z.Narrative.setNarrativeDefaultImage();
break;case "buttonNarrativeSetInitialLabels":Z.Narrative.setNarrativeDefaultAnnotations();break;case "buttonNarrativeLinkClear":Z.Utils.htmlClearLinkFromSelection();break;case "buttonNarrativeCancel":Z.Narrative.cancelNarrative();break;case "buttonNarrativeSave":Z.Narrative.saveNarrative();break;case "buttonHelpNarrative":null===Z.narrativeMode?Z.Utils.getResource("CONTENT_HELPNARRATIVEVIEW"):Z.Utils.getResource("CONTENT_HELPNARRATIVEEDIT");Z.Utils.showHelp(Z.narrativeHelpContent);break;case "buttonFileManagerUpload":Z.Narrative.selectUploadFiles();
break;case "buttonFileManagerDownload":Z.Narrative.showDownloadPanel(!0);break;case "buttonFileManagerNew":Z.Narrative.createFile();break;case "buttonFileManagerDelete":Z.Narrative.deleteFilePrep();break;case "buttonDownloadPanelClose":Z.Narrative.showDownloadPanel(!1);break;case "buttonCounterListShow":a.trackingEventsManager(b,c);break;case "buttonCounterListHide"+e:a.trackingEventsManager(b,c);break;case "buttonToggleTrackingNav"+e:a.trackingEventsManager(b,c);break;case "buttonTrackingClearLast"+
e:a.trackingEventsManager(b,c);break;case "buttonTrackingClearType"+e:a.trackingEventsManager(b,c);break;case "buttonTrackingClearAll"+e:a.trackingEventsManager(b,c);break;case "buttonTrackingSave"+e:a.trackingEventsManager(b,c);break;default:"buttonColor"==c.substr(0,11)&&a.setDrawingColor(c)}else"mouseup"==d||"touchend"==d||"touchcancel"==d?"buttonSliderZoom"==c||F?(ha&&(window.clearInterval(ha),ha=null),ma(),F=!1,Z.zooming="stop",a.updateView()):"trackSliderZoom"==c?"undefined"!==typeof trsZ&&
"undefined"!==typeof trszS&&(e=Z.Utils.getElementPosition(trsZ),e=Z.Utils.getMousePosition(b).x-e.x,f=parseFloat(trszS.width),e=Z.minZ+(e-0)/(f-0)*(Z.maxZ-Z.minZ),e<Z.minZ+.1&&(e=Z.minZ),e>Z.maxZ-.1&&(e=Z.maxZ),f=e-a.getZoom(),Z.zooming=0<f?"in":0>f?"out":"stop",a.scaleTierToZoom(e),Z.zooming="stop",a.updateView()):-1!=c.indexOf("buttonSliderFilter")||Pb?(ba&&(window.clearInterval(ba),ba=null),ma(),imageFilterEventsManager(b,c,"sliderEnd")):-1!=c.indexOf("trackSliderFilter")?imageFilterEventsManager(b,
c,"sliderSnap"):"buttonImageFilterPlus"==c||"buttonImageFilterMinus"==c?imageFilterEventsManager(b,c):"buttonSliderImageSet"==c||H?(Ea&&(window.clearInterval(Ea),Ea=null),ma(),sliderSlideEndImageSet()):"buttonZoomOut"==c||"buttonZoomIn"==c?(a.zoom("stop"),"buttonZoomOut"==c&&f&&a.toggleSmoothZoom(),"buttonZoomIn"==c&&f&&a.toggleEditMode()):"buttonPanLeft"==c||"buttonPanRight"==c?(Z.tracking?"buttonPanLeft"==c?Z.viewportCurrent.goToNextCell("left"):Z.viewportCurrent.goToNextCell("right"):a.pan("horizontalStop"),
"buttonPanLeft"==c&&f&&a.toggleSmoothPan()):"buttonPanUp"==c||"buttonPanDown"==c?Z.tracking?"buttonPanUp"==c?Z.viewportCurrent.goToNextCell("up"):Z.viewportCurrent.goToNextCell("down"):a.pan("verticalStop"):"buttonHelp"==c?0==Z.debug&&f&&Z.Utils.showGlobals():"buttonRotateClockwise"==c||"buttonRotateCounterwise"==c?Z.rotationFree&&a.rotate("stop"):"buttonFullView"==c?a.toggleFullViewMode(!0):"buttonFullViewExit"==c?a.toggleFullViewMode(!1):"buttonRulerSettingsShow"==c?Z.Ruler.showRulerSettings(!0):
"buttonRulerSettingsCancel"==c?Z.Ruler.showRulerSettings(!1):"buttonRulerSettingsSave"==c?Z.Ruler.showRulerSettings(!1,!0):"buttonNarrativePreview"==c?Z.Narrative.toggleNarrativeMode(!1):"buttonNarrativeEdit"==c?Z.Narrative.toggleNarrativeMode(!0):"buttonNarrativeToolsShow"==c?Z.Narrative.showFileManagerPanel(!1):"buttonFileManagerShow"==c?Z.Narrative.showFileManagerPanel(!0):"trackSliderImageSet"==c?Z.slidestack&&sliderSnapImageSet(b):"buttonImageSetPrior"==c||"buttonImageSetNext"==c?Z.animation?
Z.Viewer.viewportChange("stop"):Z.slidestack&&("buttonImageSetPrior"==c?Z.Viewer.viewportChange("backward"):"buttonImageSetNext"==c&&Z.Viewer.viewportChange("forward")):"buttonImageFilterClear"==c?a.clearImageFilterLast():"buttonImageFiltersClearAll"==c?a.clearImageFiltersAll():"buttonImageFilterPanelShow"==c?n.showImageFilterPanel(!0):"buttonImageFilterPanelHide"==c?n.showImageFilterPanel(!1):"buttonImageFilterPanelHideOnPanel"==c&&n.showImageFilterPanel(!1):"mouseout"==d&&("buttonZoomOut"==c||"buttonZoomIn"==
c?a.zoom("stop"):"buttonPanLeft"==c||"buttonPanRight"==c?a.pan("horizontalStop"):"buttonPanUp"==c||"buttonPanDown"==c?a.pan("verticalStop"):"buttonRotateClockwise"==c||"buttonRotateCounterwise"==c?Z.rotationFree&&a.rotate("stop"):"buttonImageSetPrior"!=c&&"buttonImageSetNext"!=c||Z.Viewer.viewportChange("stop"))}function ma(){F?(Z.Utils.removeEventListener(document,"mousemove",ea),Z.Utils.removeEventListener(document,"mouseup",p),Z.Utils.removeEventListener(document,"touchmove",K)):Pb?(Z.Utils.removeEventListener(document,
"mousemove",sliderMouseMoveHandlerFilter),Z.Utils.removeEventListener(document,"mouseup",p),Z.Utils.removeEventListener(document,"touchmove",sliderTouchMoveHandlerFilter)):H&&(Z.Utils.removeEventListener(document,"mousemove",sliderMouseMoveHandlerImageSet),Z.Utils.removeEventListener(document,"mouseup",p),Z.Utils.removeEventListener(document,"touchmove",sliderTouchMoveHandlerImageSet));for(var a=Z.ToolbarDisplay.childNodes,b=0,c=a.length;b<c;b++){var d=a[b],e=d.id;if(e&&-1!=e.indexOf("button"))if("buttonContainer"!=
e&&"buttonContainerImageFilter"!=e)Z.Utils.setButtonDefaults(d);else for(var d=d.childNodes,e=0,f=d.length;e<f;e++){var l=d[e],n=l.id;n&&-1!=n.indexOf("button")&&Z.Utils.setButtonDefaults(l)}}}function ea(a){xb=new Z.Utils.Point(a.clientX,a.clientY)}function K(a){(a=Z.Utils.getFirstTouch(a))&&(xb=new Z.Utils.Point(a.pageX,a.pageY))}function L(a,b){if(-1!=a.id.indexOf("button")&&-1==a.id.indexOf("buttonContainer")){var c=a.firstChild,d=a.childNodes[1],e=a.childNodes[2];if(c&&d&&e)if(c=c.style,d=d.style,
e=e.style,c.visibility=d.visibility=e.visibility="hidden","mouseover"==b&&"buttonSliderZoom"==a.id&&F)e.visibility="visible";else if("mouseover"==b&&-1!=a.id.indexOf("buttonSliderFilter")&&Pb)e.visibility="visible";else if("mouseover"==b&&"buttonSliderImageSet"==a.id&&H)e.visibility="visible";else if("mouseover"==b||"mouseup"==b)d.visibility="visible";else if("mousedown"==b||"mousemove"==b||"touchstart"==b||"MSPointerDown"==b)e.visibility="visible";else if("mouseout"==b||"touchend"==b||"touchcancel"==
b||"MSPointerUp"==b)c.visibility="visible"}}var n=this,A=!1,l=a?a.getViewportID().toString():"0";if(Z.toolbarInternal){var v,aa,G,I=Z.Utils.getResource("UI_TOOLBARINTERNALBUTTONOVERCOLOR"),T=Z.Utils.getResource("UI_TOOLBARINTERNALBUTTONDOWNCOLOR"),ja=Z.Utils.getResource("UI_TOOLBARINTERNALBUTTONUPCOLOR");b()}else{Z.skinPath=Z.Utils.stringRemoveTrailingSlash(Z.skinPath);(new Z.NetConnector).loadXML(Z.skinPath+"/"+Z.Utils.getResource("z200"),null,"loadingSkinXML");var Mb,w,Ya=[],ra=[],D=[],U=parseInt(Z.Utils.getResource("z205ZOOM"),
10),F=!1,ha=null,xb=null,Ia=null,Za=null,$a,ab,ka,ua,jb;if(Z.imageSet)var q=parseInt(Z.Utils.getResource("z205IMAGESET"),10),H=!1,Ea=null,nd;if(Z.imageFilters)var Ob=parseInt(Z.Utils.getResource("z205FILTER"),10),Pb=!1,ba=null}this.gallerySizeAndPositionReset=function(){c()};this.getInitialized=function(){return A};this.getSkinArray=function(){return Ya};this.getSkinSizes=function(){return D};this.show=function(a){f(a)};this.setVisibility=function(a){m(a)};this.minimize=function(a){u(a)};this.setVisibilityAnnotationPanel=
function(b,c){var d=c;if("undefined"===typeof d||null===d)d=Z.annotationFileShared?"0":a.getViewportID().toString();if(d=document.getElementById("AnnotationPanelDisplay"+d))!b||Z.measureVisible&&null===Z.editMode&&1!=Z.annotationPanelVisible&&2!=Z.annotationPanelVisible&&!Z.narrative?(d.style.display="none",Z.annotationPanelVisibleState=!1):(d.style.display="inline-block",Z.annotationPanelVisibleState=!0)};this.toggleAnnotationPanelMode=function(b){a.clearAnnotationPanel(l);a.setStatus("annotationPanelInitializedViewport",
!1);a.createAnnotationPanel(l)};this.setVisibilityTrackingPanel=function(b,c){var d=c;if("undefined"===typeof d||null===d)d=Z.trackingFileShared?"0":a.getViewportID().toString();if(d=document.getElementById("TrackingPanelDisplay"+d))b?(d.style.display="inline-block",Z.trackingPanelVisibleState=!0):(d.style.display="none",Z.trackingPanelVisibleState=!1)};this.setVisibilityUserPanel=function(a){var b=document.getElementById("userPanelDisplay");b&&(a?(b.style.display="inline-block",Z.userPanelVisibleState=
!0):(b.style.display="none",Z.userPanelVisibleState=!1))};this.showProgress=function(){var a=document.getElementById("progressTextBox");a&&(a=a.style)&&(a.display="inline-block")};this.hideProgress=function(){var a=document.getElementById("progressTextBox");a&&(a=a.style)&&(a.display="none")};this.updateProgress=function(a,b){if(Z.progressVisible){Ia&&window.clearInterval(Ia);var c,e=document.getElementById("progressTextBoxCenteredDiv");e&&(e=e.firstChild)&&(0==a||0==b?(e.nodeValue="llllllllll",Ia=
window.setInterval(d,parseInt(Z.Utils.getResource("z182")),10)):(c=Math.round(100-b/a*100),c=Math.round(c/10),e.nodeValue=Z.Utils.stringMultiply("l",c)))}};this.setViewport=function(b){a=b;l=a.getViewportID().toString()};this.parseSkinXML=function(b){Z.skinMode=Z.narrative?Z.skinMode="2":b.getElementsByTagName("SETUP")[0].attributes.getNamedItem("SKINMODE").nodeValue;var d,k;1==Z.skinMode||0==Z.skinMode&&!Z.mobileDevice?(d=b.getElementsByTagName("SETUP")[0].attributes.getNamedItem("FOLDERSTANDARD").nodeValue,
k="SIZESSTANDARD"):(d=b.getElementsByTagName("SETUP")[0].attributes.getNamedItem("FOLDERLARGE").nodeValue,k="SIZESLARGE");var q=b.getElementsByTagName("SETUP")[0].attributes.getNamedItem("PROGRESSCOLOR");"undefined"!==typeof q&&null!==q&&(Za=b.getElementsByTagName("SETUP")[0].attributes.getNamedItem("PROGRESSCOLOR").nodeValue);q=[];q[q.length]=parseFloat(b.getElementsByTagName(k)[0].attributes.getNamedItem("TOOLBARW").nodeValue);q[q.length]=parseFloat(b.getElementsByTagName(k)[0].attributes.getNamedItem("TOOLBARH").nodeValue);
q[q.length]=parseFloat(b.getElementsByTagName(k)[0].attributes.getNamedItem("LOGOW").nodeValue);q[q.length]=parseFloat(b.getElementsByTagName(k)[0].attributes.getNamedItem("LOGOH").nodeValue);q[q.length]=parseFloat(b.getElementsByTagName(k)[0].attributes.getNamedItem("DIVIDERW").nodeValue);q[q.length]=parseFloat(b.getElementsByTagName(k)[0].attributes.getNamedItem("DIVIDERH").nodeValue);q[q.length]=parseFloat(b.getElementsByTagName(k)[0].attributes.getNamedItem("BUTTONW").nodeValue);q[q.length]=parseFloat(b.getElementsByTagName(k)[0].attributes.getNamedItem("BUTTONH").nodeValue);
q[q.length]=parseFloat(b.getElementsByTagName(k)[0].attributes.getNamedItem("BUTTONSPAN").nodeValue);q[q.length]=parseFloat(b.getElementsByTagName(k)[0].attributes.getNamedItem("SLIDERBUTTONW").nodeValue);q[q.length]=parseFloat(b.getElementsByTagName(k)[0].attributes.getNamedItem("SLIDERBUTTONH").nodeValue);q[q.length]=parseFloat(b.getElementsByTagName(k)[0].attributes.getNamedItem("SLIDERTRACKW").nodeValue);q[q.length]=parseFloat(b.getElementsByTagName(k)[0].attributes.getNamedItem("SLIDERTRACKH").nodeValue);
q[q.length]=parseFloat(b.getElementsByTagName(k)[0].attributes.getNamedItem("SLIDERSPAN").nodeValue);q[q.length]=parseFloat(b.getElementsByTagName(k)[0].attributes.getNamedItem("PROGRESSW").nodeValue);q[q.length]=parseFloat(b.getElementsByTagName(k)[0].attributes.getNamedItem("PROGRESSH").nodeValue);q[q.length]=parseFloat(b.getElementsByTagName(k)[0].attributes.getNamedItem("PROGRESSFONTSIZE").nodeValue);var m,v,A;k=Z.imageFilters?216:"edit"==Z.trackingEditMode?200:Z.tracking?188:Z.narrativeMode?
182:"edit"==Z.editMode?141:"markup"==Z.editMode?132:Z.screensaver||Z.preloadVisible||Z.tourPath||Z.slidePath||Z.imageSetPath?77:Z.rotationVisible?58:Z.measureVisible?51:0<Z.helpVisible?45:Z.fullScreenVisible||Z.fullPageVisible?45:Z.resetVisible?35:Z.panButtonsVisible?32:Z.sliderZoomVisible?19:Z.minimizeVisible?14:Z.logoVisible?8:6;m=b.getElementsByTagName("FILES")[0].attributes.getNamedItem("SKIN0");null!==m&&(v=m.nodeValue);m=b.getElementsByTagName("FILES")[0].attributes.getNamedItem("SKIN"+k.toString());
null!==m&&(A=m.nodeValue);if("undefined"!==typeof v&&Z.Utils.stringValidate(v)&&"undefined"!==typeof A&&Z.Utils.stringValidate(A)){v=!1;A=0;for(k+=1;A<k;A++)m=b.getElementsByTagName("FILES")[0].attributes.getNamedItem("SKIN"+A).nodeValue,Z.Utils.stringValidate(m)?ra[A]=d+"/"+m:(ra[A]="null",v=!0);v&&Z.Utils.showMessage(Z.Utils.getResource("z279"));Ya=b=ra;Z.ToolbarDisplay=Z.Utils.createContainerElement("div","ToolbarDisplay","inline-block","absolute","visible","1px","1px","0px","1px","none","0px",
"transparent","0px","0px","normal");w=Z.ToolbarDisplay.style;w.textAlign="left";w.zIndex=(Z.baseZIndex+3).toString();k=new Z.Utils.Graphic("toolbarBackground",Z.skinPath,b[0],"1px","1px","0px","0px");parseFloat(Z.Utils.getResource("z82"));d=Z.Utils.getResource("z83NOALPHA");Z.ToolbarDisplay.appendChild(k.elmt);Z.toolbarBackgroundVisible||Z.Utils.setOpacity(k.elmt,0,d);D=q;Z.logoVisible&&(Z.Utils.stringValidate(Z.logoCustomPath)?(q=Z.Utils.cacheProofPath(Z.logoCustomPath),q=new Z.Utils.Graphic("toolbarLogo",
q,null,"1px","1px","1px","1px")):q=new Z.Utils.Graphic("toolbarLogo",Z.skinPath,b[7],"1px","1px","1px","1px"),k=Z.Utils.getResource("z427ZOOMIFY"),v=Z.Utils.getResource("z360ZOOMIFY"),Z.expressParamsEnabled&&null!==Z.logoLinkURL&&("none"==Z.logoLinkURL?v=k=null:(k=Z.logoLinkURL,-1==Z.logoLinkURL.toLowerCase().indexOf("zoomify")&&(v=Z.Utils.getResource("z360GENERIC")))),null!==k&&null!==v?(A=document.createElement("a"),A.setAttribute("title",v),A.setAttribute("href",k),A.setAttribute("target",Z.Utils.getResource("z427TARGET")),
A.setAttribute("outline","none"),A.appendChild(q.elmt),Z.ToolbarDisplay.appendChild(A)):Z.ToolbarDisplay.appendChild(q.elmt),0==Z.toolbarVisible||1==Z.toolbarVisible)&&(q=new Z.Utils.Graphic("logoDivider",Z.skinPath,b[8],"1px","1px","1px","1px"),Z.ToolbarDisplay.appendChild(q.elmt));q=Z.Utils.createContainerElement("div","buttonContainer","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal","default");Z.ToolbarDisplay.appendChild(q);Z.Utils.addEventListener(q,
"mousedown",Z.Utils.preventDefault);Z.Utils.addEventListener(q,"mouseover",n.backgroundEventsHandler);Z.Utils.addEventListener(q,"touchstart",Z.Utils.preventDefault);k=new Z.Utils.Graphic("buttonBackground",Z.skinPath,b[0],"1px","1px","0px","0px");q.appendChild(k.elmt);Z.Utils.setOpacity(k.elmt,"0","#FBFAFA");(0!=Z.toolbarVisible&&1!=Z.toolbarVisible||Z.mobileDevice)&&Z.minimizeVisible&&(k=new Z.Utils.Button("buttonMinimize",null,Z.skinPath,b[9],b[10],b[11],"1px","1px","1px","1px","mouseover",p,"z363"),
Z.ToolbarDisplay.appendChild(k.elmt),k=new Z.Utils.Button("buttonExpand",null,Z.skinPath,b[12],b[13],b[14],"1px","1px","1px","1px","mouseover",p,"z341"),Z.ToolbarDisplay.appendChild(k.elmt));Z.zoomButtonsVisible&&(k=new Z.Utils.Button("buttonZoomOut",null,Z.skinPath,b[1],b[2],b[3],"1px","1px","1px","1px","mouseover",p,"z400"),q.appendChild(k.elmt));Z.sliderZoomVisible&&(k=new Z.Utils.Graphic("trackSliderZoom",Z.skinPath,b[15],"1px","1px","0px","0px","z385ZOOM"),q.appendChild(k.elmt),Z.Utils.addEventListener(k.elmt,
"mousedown",p),Z.Utils.addEventListener(k.elmt,"touchstart",p),Z.Utils.addEventListener(k.elmt,"mouseover",p),k=new Z.Utils.Button("buttonSliderZoom",null,Z.skinPath,b[17],b[18],b[19],"1px","1px","1px","1px","mouseover",p,"z385ZOOM"),q.appendChild(k.elmt));Z.zoomButtonsVisible&&(k=new Z.Utils.Button("buttonZoomIn",null,Z.skinPath,b[4],b[5],b[6],"1px","1px","1px","1px","mouseover",p,"z399"),q.appendChild(k.elmt));if(Z.panButtonsVisible){if(Z.zoomButtonsVisible||Z.sliderZoomVisible)k=new Z.Utils.Graphic("panDivider",
Z.skinPath,b[20],"1px","1px","1px","1px"),q.appendChild(k.elmt),Z.toolbarBackgroundVisible||Z.Utils.setOpacity(k.elmt,0,d);k=new Z.Utils.Button("buttonPanLeft",null,Z.skinPath,b[21],b[22],b[23],"1px","1px","1px","1px","mouseover",p,"z370");q.appendChild(k.elmt);k=new Z.Utils.Button("buttonPanUp",null,Z.skinPath,b[24],b[25],b[26],"1px","1px","1px","1px","mouseover",p,"z372");q.appendChild(k.elmt);k=new Z.Utils.Button("buttonPanDown",null,Z.skinPath,b[27],b[28],b[29],"1px","1px","1px","1px","mouseover",
p,"z369");q.appendChild(k.elmt);k=new Z.Utils.Button("buttonPanRight",null,Z.skinPath,b[30],b[31],b[32],"1px","1px","1px","1px","mouseover",p,"z371");q.appendChild(k.elmt)}Z.resetVisible&&(k=new Z.Utils.Button("buttonReset",null,Z.skinPath,b[33],b[34],b[35],"1px","1px","1px","1px","mouseover",p,"z378"),q.appendChild(k.elmt));if(Z.fullScreenVisible||Z.fullPageVisible)k=new Z.Utils.Graphic("fullViewDivider",Z.skinPath,b[36],"1px","1px","1px","1px"),q.appendChild(k.elmt),Z.toolbarBackgroundVisible||
Z.Utils.setOpacity(k.elmt,0,d),k=new Z.Utils.Button("buttonFullViewExit",null,Z.skinPath,b[40],b[41],b[42],"1px","1px","1px","1px","mouseover",p,"z391EXIT"),q.appendChild(k.elmt),k=new Z.Utils.Button("buttonFullView",null,Z.skinPath,b[37],b[38],b[39],"1px","1px","1px","1px","mouseover",p,"z391"),q.appendChild(k.elmt);Z.measureVisible&&null===Z.editMode&&(Z.fullScreenVisible||Z.fullPageVisible||(k=new Z.Utils.Graphic("measureDivider",Z.skinPath,b[36],"1px","1px","1px","1px"),q.appendChild(k.elmt),
Z.toolbarBackgroundVisible||Z.Utils.setOpacity(k.elmt,0,d)),null===Z.editMode&&(k=new Z.Utils.Button("buttonMeasureExit",null,Z.skinPath,b[49],b[50],b[51],"1px","1px","1px","1px","mouseover",p,"z392EXIT"),q.appendChild(k.elmt)),k=new Z.Utils.Button("buttonMeasure",null,Z.skinPath,b[46],b[47],b[48],"1px","1px","1px","1px","mouseover",p,"z392"),q.appendChild(k.elmt));Z.rotationVisible&&(k=new Z.Utils.Graphic("rotateDivider",Z.skinPath,b[52],"1px","1px","1px","1px"),q.appendChild(k.elmt),Z.toolbarBackgroundVisible||
Z.Utils.setOpacity(k.elmt,0,d),k=new Z.Utils.Button("buttonRotateCounterwise",null,Z.skinPath,b[53],b[54],b[55],"1px","1px","1px","1px","mouseover",p,"z381"),q.appendChild(k.elmt),k=new Z.Utils.Button("buttonRotateClockwise",null,Z.skinPath,b[56],b[57],b[58],"1px","1px","1px","1px","mouseover",p,"z380"),q.appendChild(k.elmt));Z.tour&&(k=new Z.Utils.Graphic("tourDivider",Z.skinPath,b[59],"1px","1px","1px","1px"),q.appendChild(k.elmt),Z.toolbarBackgroundVisible||Z.Utils.setOpacity(k.elmt,0,d),k=new Z.Utils.Button("buttonTourPrior",
null,Z.skinPath,b[60],b[61],b[62],"1px","1px","1px","1px","mouseover",p,"z394"),q.appendChild(k.elmt),k=new Z.Utils.Button("buttonTourNext",null,Z.skinPath,b[63],b[64],b[65],"1px","1px","1px","1px","mouseover",p,"z393"),q.appendChild(k.elmt),k=new Z.Utils.Button("buttonTourStart",null,Z.skinPath,b[66],b[67],b[68],"1px","1px","1px","1px","mouseover",p,"z395"),q.appendChild(k.elmt),k=new Z.Utils.Button("buttonTourStop",null,Z.skinPath,b[69],b[70],b[71],"1px","1px","1px","1px","mouseover",p,"z396"),
q.appendChild(k.elmt));Z.slideshow&&Z.slideButtonsVisible&&(k=new Z.Utils.Graphic("slideshowDivider",Z.skinPath,b[59],"1px","1px","1px","1px"),q.appendChild(k.elmt),Z.toolbarBackgroundVisible||Z.Utils.setOpacity(k.elmt,0,d),k=new Z.Utils.Button("buttonSlideshowPrior",null,Z.skinPath,b[60],b[61],b[62],"1px","1px","1px","1px","mouseover",p,"z384"),q.appendChild(k.elmt),k=new Z.Utils.Button("buttonSlideshowNext",null,Z.skinPath,b[63],b[64],b[65],"1px","1px","1px","1px","mouseover",p,"z383"),q.appendChild(k.elmt),
k=new Z.Utils.Button("buttonSlideshowStart",null,Z.skinPath,b[66],b[67],b[68],"1px","1px","1px","1px","mouseover",p,"z386"),q.appendChild(k.elmt),k=new Z.Utils.Button("buttonSlideshowStop",null,Z.skinPath,b[69],b[70],b[71],"1px","1px","1px","1px","mouseover",p,"z387"),q.appendChild(k.elmt));if(Z.tour||Z.slideshow)k=new Z.Utils.Button("buttonAudioOn",null,Z.skinPath,b[72],b[73],b[74],"1px","1px","1px","1px","mouseover",p,"z321"),q.appendChild(k.elmt),k=new Z.Utils.Button("buttonAudioMuted",null,Z.skinPath,
b[75],b[76],b[77],"1px","1px","1px","1px","mouseover",p,"z322"),q.appendChild(k.elmt);Z.imageSet&&!Z.overlays&&(1<q.childNodes.length&&(k=new Z.Utils.Graphic("imageSetDivider",Z.skinPath,b[59],"1px","1px","1px","1px"),q.appendChild(k.elmt),Z.toolbarBackgroundVisible||Z.Utils.setOpacity(k.elmt,0,d)),k=new Z.Utils.Button("buttonImageSetPrior",null,Z.skinPath,b[60],b[61],b[62],"1px","1px","1px","1px","mouseover",p,"TIP_IMAGESETPRIOR"),q.appendChild(k.elmt),Z.sliderImageSetVisible&&(k=new Z.Utils.Graphic("trackSliderImageSet",
Z.skinPath,b[15],"1px","1px","0px","0px","z385IMAGESET"),q.appendChild(k.elmt),Z.Utils.addEventListener(k.elmt,"mousedown",p),Z.Utils.addEventListener(k.elmt,"touchstart",p),Z.Utils.addEventListener(k.elmt,"mouseover",p),k=new Z.Utils.Button("buttonSliderImageSet",null,Z.skinPath,b[17],b[18],b[19],"1px","1px","1px","1px","mouseover",p,"z385IMAGESET"),q.appendChild(k.elmt)),k=new Z.Utils.Button("buttonImageSetNext",null,Z.skinPath,b[63],b[64],b[65],"1px","1px","1px","1px","mouseover",p,"TIP_IMAGESETNEXT"),
q.appendChild(k.elmt));Z.preloadVisible&&(k=new Z.Utils.Graphic("preloadDivider",Z.skinPath,b[59],"1px","1px","1px","1px"),q.appendChild(k.elmt),Z.toolbarBackgroundVisible||Z.Utils.setOpacity(k.elmt,0,d),d=new Z.Utils.Button("buttonPreload",null,Z.skinPath,b[69],b[70],b[71],"1px","1px","1px","1px","mouseover",p,"TIP_PRELOAD"),q.appendChild(d.elmt));Z.comparison&&(d=Z.Utils.createContainerElement("div","labelSyncTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent",
"0px","0px","nowrap",null,!0),k=document.createTextNode(Z.Utils.getResource("UI_TOOLBARLABELSYNC")),d.appendChild(k),k=new Z.Utils.Checkbox("checkboxSyncComparison","test","1px","1px","1px","1px","click",p,"TIP_SYNC"),q.appendChild(d),q.appendChild(k));if(1==Z.helpVisible||3==Z.helpVisible)b=new Z.Utils.Button("buttonHelp",null,Z.skinPath,b[43],b[44],b[45],"1px","1px","1px","1px","mouseover",p,"z342"),q.appendChild(b.elmt);Z.progressVisible&&(b=Z.Utils.createContainerElement("div","progressTextBox",
"inline-block","absolute","hidden","1px","1px","1px","1px","none","0px","transparent","0px","0px","normal",null,!0),d=D[16],q.appendChild(b),q=document.createTextNode(Z.Utils.getResource("z183")),b.appendChild(Z.Utils.createCenteredElement(q,"progressTextBoxCenteredDiv")),null===Za&&(Za=Z.Utils.getResource("z183COLOR")),Z.Utils.setTextNodeStyle(q,Za,"verdana",d+"px","none","normal","normal","normal","normal","1em","left","none"),Z.Utils.disableTextInteraction(q));Z.ViewerDisplay.appendChild(Z.ToolbarDisplay);
Z.toolbarW=D[0];Z.toolbarCurrentW=-1==Z.toolbarW?Z.viewerW:Z.toolbarW;Z.toolbarH=Mb=D[1];b=Z.toolbarBackgroundVisible?0:parseInt(Z.Utils.getResource("DEFAULT_TOOLBARBACKGROUNDVISIBLEADJUST"),10);n.setSizeAndPosition(Z.toolbarCurrentW,Z.toolbarH,0,1==Z.toolbarPosition?Z.viewerH-Z.toolbarH-b:0+b);a&&a.getStatus("initializedViewport")&&(1==Z.toolbarVisible&&Z.toolbarBackgroundVisible&&(a.setSizeAndPosition(Z.viewerW,Z.viewerH-Z.toolbarH,0,0==Z.toolbarPosition?Z.toolbarH:0),a.validateXYZDefaults(!0),
a.updateView()),b=a.getZoom(),t(b),Z.annotations&&a.setDrawingColor("buttonColor0"+l,!0));f(1==Z.toolbarVisible||2==Z.toolbarVisible||4==Z.toolbarVisible||7==Z.toolbarVisible);Z.Utils.addEventListener(Z.ToolbarDisplay,"mouseover",Z.Utils.stopPropagation);e(!0);c()}else Z.Utils.showMessage(Z.Utils.getResource("z278"))};this.setSizeAndPosition=function(b,c,d,e){"undefined"===typeof b||null===b?b=0<Z.toolbarVisible?Z.toolbarCurrentW:0:Z.toolbarCurrentW=b;if("undefined"===typeof c||null===c)c=0<Z.toolbarVisible&&
8!=Z.toolbarVisible?Mb:0;if("undefined"===typeof d||null===d)d=0;if("undefined"===typeof e||null===e)e=1==Z.toolbarPosition?Z.viewerH-Mb:0;Z.narrative&&(b-=Z.narrativeW,d+=Z.narrativeW);w=Z.ToolbarDisplay.style;w.width=b+"px";w.height=c+"px";w.left=d+"px";w.top=e+"px";var f=b,l=c,n=D[2],q=D[3],m=D[4],A=D[5],v=D[6],p=D[7],H=D[8],t=D[9],u=D[10],Ea=D[11],aa=D[12],I=D[13],x=D[14],B=D[15],r=Z.narrative?10:0,F=(l-q)/2,C=(l-A)/2,G=(l-p)/2,T=Z.narrative?G:1.3*G,U=Z.narrative?3:0,ja=G+6-U,R=G+5-U,ha=1==Z.logoVisible?
0:H/2,h=1==Z.logoVisible?0:H/2,K=H-(v-m),ia=0,ba=0;Z.zoomButtonsVisible&&(ia+=2);Z.panButtonsVisible&&(ia+=4,ba+=1);Z.resetVisible&&(ia+=1);if(Z.fullScreenVisible||Z.fullPageVisible)ia+=1,ba+=1;Z.helpVisible&&(ia+=1,Z.fullScreenVisible||Z.fullPageVisible||(ba+=1));Z.measureVisible&&(Z.fullScreenVisible||Z.fullPageVisible||(ba+=1),ia+=1);Z.rotationVisible&&(ia+=2,ba+=1);if(Z.tour||Z.slideshow&&Z.slideButtonsVisible)ia+=3,ba+=1,Z.audioContent&&(ia+=1);Z.preloadVisible&&(ia+=1,ba+=1);Z.comparison&&Z.syncVisible&&
(ia+=1,ba+=1);if(Z.imageSet&&Z.sliderImageSetVisible){var Pb=I,ra=Ea,ea=aa;nd=!1;ia+=2}Z.progressVisible||(x=0);var L=ia*H+ba*K;Z.sliderZoomVisible&&(L+=I);Z.imageSet&&Z.sliderImageSetVisible&&(L+=Pb);$a=ab=ka=ua=overrideZoom=!1;var Ob=(1==Z.logoVisible?n+2:0)+(0!=Z.toolbarVisible&&1!=Z.toolbarVisible&&0!=Z.minimizeVisible?H:0),xa=1==Z.panButtonsVisible?4*H+K:0,ma=1==Z.zoomButtonsVisible?2*H:0,Ya=1==Z.resetVisible?H:0,Ia=Ob+20+L+20+x;Ia>f&&($a=!0,Ia-I>f&&(ab=!0,Ia-I-x>f&&(ka=!0,Ia-I-x-Ob>f&&(jb=!0,
Ia-I-x-Ob-Ya>f&&(ua=!0,L-=xa,Ia-I-x-Ob-Ya-xa>f&&(overrideZoom=!0,L-=ma)),L-=Ya),Ob=0),x=0),L-=I);var Za=(f-L)/2-20+3,xb=document.getElementById("toolbarBackground");xb&&(xb.style.width=f+"px",xb.style.height=l+"px",xb.firstChild.style.width=f+"px",xb.firstChild.style.height=l+"px");var oc=document.getElementById("buttonContainer");oc&&(oc.style.width=L+40+"px",oc.style.height=l+"px",oc.style.left=Za+"px");var Gb=document.getElementById("buttonBackground");Gb&&(Gb.style.width=f+"px",Z.Utils.graphicSize(Gb,
parseFloat(oc.style.width),parseFloat(oc.style.height)),Gb.style.left="0px");var S=document.getElementById("toolbarLogo");if(S){var Aa=S.style;if(Aa)if(ka)Aa.display="none";else{Aa.display="inline-block";Z.Utils.graphicSize(S,n,q);Aa.left=r+"px";Aa.top=F+"px";var r=r+(n+5),ya=document.getElementById("logoDivider");if(ya){Z.Utils.graphicSize(ya,m,A);var zc=ya.style;zc.left=r+"px";zc.top=C+"px"}}}if(0!=Z.toolbarVisible&&1!=Z.toolbarVisible){var Hb=document.getElementById("buttonMinimize"),ic=document.getElementById("buttonExpand");
if(Hb&&ic){var la=Hb.style,fa=ic.style;la&&fa&&(ka?(la.display="none",fa.display="none"):(la.display="inline-block",fa.display="inline-block",Z.Utils.buttonSize(Hb,v,p),Z.Utils.buttonSize(ic,v,p),la.left=r+ha+"px",la.top=T+"px",fa.left=r+h+"px",fa.top=T+"px"))}}r=20;if(!overrideZoom){var E=document.getElementById("buttonZoomOut");if(E){Z.Utils.buttonSize(E,v,p);var Tc=E.style;Tc.left=r+"px";Tc.top=G+"px";r+=H}trsZ=document.getElementById("trackSliderZoom");btsZ=document.getElementById("buttonSliderZoom");
trsZ&&btsZ&&(trszS=trsZ.style,btszS=btsZ.style,trszS&&btszS&&($a?(trszS.display="none",btszS.display="none"):(trszS.display="inline-block",btszS.display="inline-block",Z.Utils.graphicSize(trsZ,Ea,aa),trszS.left=r-2+"px",trszS.top=ja+"px",Z.Utils.buttonSize(btsZ,t,u),btszS.left=parseFloat(trszS.left)+"px",btszS.top=R+"px",r+=I)));var ca=document.getElementById("buttonZoomIn");if(ca){Z.Utils.buttonSize(ca,v,p);var J=ca.style;J.left=r+"px";J.top=G+"px";r+=H+1}}if(!ua){var Kb=document.getElementById("panDivider");
if(Kb){Z.Utils.graphicSize(Kb,m,A);var sc=Kb.style;sc.left=r+"px";sc.top=C-5+"px";r+=K}var ga=document.getElementById("buttonPanLeft");if(ga){Z.Utils.buttonSize(ga,v,p);var X=ga.style;X.left=r+"px";X.top=G+"px";r+=H}var Ba=document.getElementById("buttonPanUp");if(Ba){Z.Utils.buttonSize(Ba,v,p);var Uc=Ba.style;Uc.left=r+"px";Uc.top=G+"px";r+=H}var eb=document.getElementById("buttonPanDown");if(eb){Z.Utils.buttonSize(eb,v,p);var Sb=eb.style;Sb.left=r+"px";Sb.top=G+"px";r+=H}var Wb=document.getElementById("buttonPanRight");
if(Wb){Z.Utils.buttonSize(Wb,v,p);var Vc=Wb.style;Vc.left=r+"px";Vc.top=G+"px";r+=H}}if(!jb){var Ha=document.getElementById("buttonReset");if(Ha){Z.Utils.buttonSize(Ha,v,p);var Ib=Ha.style;Ib.left=r+"px";Ib.top=G+"px";r+=H+1}}var Vb=document.getElementById("fullViewDivider");if(Vb){Z.Utils.graphicSize(Vb,m,A);var Wa=Vb.style;Wa.left=r+"px";Wa.top=C+"px";r+=K}var Jb=document.getElementById("buttonFullViewExit");if(Jb){Z.Utils.buttonSize(Jb,v,p);var ld=Jb.style;ld.left=r+"px";ld.top=G+"px";ld.display=
Z.fullView?"inline-block":"none"}var fd=document.getElementById("buttonFullView");if(fd){Z.Utils.buttonSize(fd,v,p);var Ac=fd.style;Ac.left=r+"px";Ac.top=G+"px";r+=H+1;Ac.display=Z.fullView?"none":"inline-block"}var Pa=document.getElementById("measureDivider");if(Pa){Z.Utils.graphicSize(Pa,m,A);var Qa=Pa.style;Qa.left=r+"px";Qa.top=C+"px";r+=K}if(null===Z.editMode){var Dc=document.getElementById("buttonMeasureExit");if(Dc){Z.Utils.buttonSize(Dc,v,p);var Bc=Dc.style;Bc.left=r+"px";Bc.top=G+"px";Bc.display=
"measure"==Z.labelMode?"inline-block":"none"}}if(Hb=document.getElementById("buttonMeasure"))Z.Utils.buttonSize(Hb,v,p),la=Hb.style,la.left=r+"px",la.top=G+"px",r+=H+1,la.display="measure"==Z.labelMode?"none":"inline-block";var Ra=document.getElementById("rotateDivider");if(Ra){Z.Utils.graphicSize(Ra,m,A);var Sa=Ra.style;Sa.left=r+"px";Sa.top=C+"px";var r=r+K,Ec=document.getElementById("buttonRotateCounterwise");if(Ec){Z.Utils.buttonSize(Ec,v,p);var yd=Ec.style;yd.left=r+"px";yd.top=G+"px";r+=H}var cd=
document.getElementById("buttonRotateClockwise");if(cd){Z.Utils.buttonSize(cd,v,p);var Wc=cd.style;Wc.left=r+"px";Wc.top=G+"px";r+=H+1}}if(Z.tour){var Xa=document.getElementById("tourDivider");if(Xa){Z.Utils.graphicSize(Xa,m,A);var mb=Xa.style;mb.left=r+"px";mb.top=C+"px";var r=r+K,Fc=document.getElementById("buttonTourPrior");if(Fc){Z.Utils.buttonSize(Fc,v,p);var Xc=Fc.style;Xc.left=r+"px";Xc.top=G+"px";r+=H+1}var jc=document.getElementById("buttonTourNext");if(jc){Z.Utils.buttonSize(jc,v,p);var Cc=
jc.style;Cc.left=r+"px";Cc.top=G+"px";r+=H+1}var Rb=document.getElementById("buttonTourStop");if(Rb){Z.Utils.buttonSize(Rb,v,p);var gc=Rb.style;gc.left=r+"px";gc.top=G+"px";gc.display=Z.tourPlaying?"inline-block":"none"}var sb=document.getElementById("buttonTourStart");if(sb){Z.Utils.buttonSize(sb,v,p);var Sc=sb.style;Sc.left=r+"px";Sc.top=G+"px";r+=H+1;Sc.display=Z.tourPlaying?"none":"inline-block"}}}else if(Z.slideshow&&Z.slideButtonsVisible){var Fb=document.getElementById("slideshowDivider");if(Fb){Z.Utils.graphicSize(Fb,
m,A);var hc=Fb.style;hc.left=r+"px";hc.top=C+"px";var r=r+K,tb=document.getElementById("buttonSlideshowPrior");if(tb){Z.Utils.buttonSize(tb,v,p);var kd=tb.style;kd.left=r+"px";kd.top=G+"px";r+=H+1}var qc=document.getElementById("buttonSlideshowNext");if(qc){Z.Utils.buttonSize(qc,v,p);var pa=qc.style;pa.left=r+"px";pa.top=G+"px";r+=H+1}var rc=document.getElementById("buttonSlideshowStop");if(rc){Z.Utils.buttonSize(rc,v,p);var ta=rc.style;ta.left=r+"px";ta.top=G+"px";ta.display=Z.slideshowPlaying?"inline-block":
"none"}var Q=document.getElementById("buttonSlideshowStart");if(Q){Z.Utils.buttonSize(Q,v,p);var na=Q.style;na.left=r+"px";na.top=G+"px";r+=H+1;na.display=Z.slideshowPlaying?"none":"inline-block"}}}else if(null!==Z.imageSetPath&&!Z.comparison){var nb=document.getElementById("imageSetDivider");if(nb){Z.Utils.graphicSize(nb,m,A);var Gc=nb.style;Gc.left=r+"px";Gc.top=C+"px";r+=K}var tc=document.getElementById("buttonImageSetPrior");if(tc){Z.Utils.buttonSize(tc,v,p);var za=tc.style;za.left=r+"px";za.top=
G+"px";r+=H+1}trsiS=document.getElementById("trackSliderImageSet");btsiS=document.getElementById("buttonSliderImageSet");trsiS&&btsiS&&(trsisS=trsiS.style,btsisS=btsiS.style,trsisS&&btsisS&&(nd?(trsisS.display="none",btsisS.display="none"):(trsisS.display="inline-block",btsisS.display="inline-block",Z.Utils.graphicSize(trsiS,ra,ea),trsisS.left=r-2+"px",trsisS.top=ja+"px",Z.Utils.buttonSize(btsiS,t,u),btsisS.left=parseFloat(trsisS.left)+"px",btsisS.top=R+"px",r+=Pb)));var db=document.getElementById("buttonImageSetNext");
if(db){Z.Utils.buttonSize(db,v,p);var Yc=db.style;Yc.left=r+"px";Yc.top=G+"px";r+=H+1}}if(Z.tour||Z.slideshow){var W=document.getElementById("buttonAudioMuted");if(W){Z.Utils.buttonSize(W,v,p);var rb=W.style;rb.left=r+"px";rb.top=G+"px";rb.display="none"}var lb=document.getElementById("buttonAudioOn");if(lb){Z.Utils.buttonSize(lb,v,p);var Ga=lb.style;Ga.left=r+"px";Ga.top=G+"px";r+=H+1;Ga.display="none"}a.initializeAudioMuteButtons()}if(Z.preloadVisible){var Ca=document.getElementById("preloadDivider"),
La=document.getElementById("buttonPreload");if(Ca&&La){Z.Utils.graphicSize(Ca,m,A);var oa=Ca.style;oa.top=C+"px";Z.imageSet||(oa.left=r+"px",r+=K);Z.Utils.buttonSize(La,v,p);var Ma=La.style;Ma.left=r+"px";Ma.top=G+"px";r+=H;Z.imageSet&&(oa.left=r+"px",r+=K);r+=8}}if(1==Z.helpVisible||3==Z.helpVisible){var Na=document.getElementById("buttonHelp");if(Na){Z.Utils.buttonSize(Na,v,p);var gb=Na.style;gb.left=r+"px";gb.top=G+"px";r+=H+8}}if(Z.comparison&&Z.syncVisible){var Da=parseInt(Z.Utils.getResource("DEFAULT_TOOLBARLABELFONTSIZE"),
10),qa=document.getElementById("labelSyncTextBox"),ib=document.getElementById("containerFor-checkboxSyncComparison"),ob=document.getElementById("checkboxSyncComparison");if(qa&&ib&&ob){var Lb=qa.style;Lb.width="28px";Lb.height="20px";Lb.left=r+"px";Lb.top=G+6+"px";Lb.visibility="visible";Z.Utils.setTextNodeStyle(qa,"black","verdana",Da+"px","none","normal","normal","normal","normal","1em","left","none");var $b=ib.style;$b.width=1.5*v+"px";$b.height=1.5*p+"px";$b.left=r+28+3+"px";$b.top=G+2+"px";ob.width=
v;ob.height=p;ob.checked=Z.initialSync}}var od=document.getElementById("progressTextBox");if(od){var yb=od.style;yb&&(ab?yb.display="none":(yb.display="inline-block",yb.width=x+"px",yb.height=B+"px",yb.left=f-parseFloat(oc.style.left)-parseFloat(yb.width)+"px",yb.top=(l-parseFloat(yb.height))/2+"px"))}};this.syncSliderToViewportZoom=function(a){t(a)};this.z457=function(a){p(a)};this.backgroundEventsHandler=function(a){a=Z.Utils.event(a);if(a=Z.Utils.relatedTarget(a)){var b=a.parentNode;b&&(b=b.id)&&
(F||Pb||H||-1==b.indexOf("button")||-1!=b.indexOf("buttonContainer")||Z.Utils.setButtonDefaults(a.parentNode))}};this.positionButtonBorder=function(a){var b=Z.annotationFileShared?"0":l;if("buttonColor"==a.substr(0,11))var c=document.getElementById("buttonBorderSm"+b);else if(a=="buttonViewMode"+b||a=="buttonEditModeFieldOfView"+b||a=="buttonEditModeText"+b||a=="buttonEditModeShape"+b||a=="buttonEditModeFreehand"+b||a=="buttonEditModePolygon"+b||a=="buttonEditModeMeasure"+b)c=document.getElementById("buttonBorderLg"+
b);var d=document.getElementById(a);c&&d&&(a=="buttonClearAll"+b&&(d=document.getElementById("buttonViewMode"+tbViewportID)),a=c.style,d=d.style,a.left=parseFloat(d.left)-2+"px",a.top=parseFloat(d.top)-2+"px")};this.showImageFilterPanel=function(a){var b=document.getElementById("imageFilterPanelBackground"),c=document.getElementById("buttonContainerImageFilter"),d=document.getElementById("buttonImageFilterPanelShow"),e=document.getElementById("buttonImageFilterPanelHide");b&&c&&d&&e&&(b.style.width=
a?imageFilterPanelW+"px":"0px",c.style.display=a?"inline-block":"none",d.style.display=a?"none":"inline-block",e.style.display=a?"inline-block":"none");imageFilterPanelVisible=a};this.addFilterToImageFilterList=function(a,b,c,d){var e=document.getElementById("imageFilterList");if(e){var f=Z.Utils.stringUpperCaseFirstLetter(a),l=Z.Utils.arrayIndexOfObjectValueSubstring(e.options,"text",f),n="\u00a0\u00a0"+f;"\u00a0\u00a0None"==e.options[e.options.length-1].text&&e.options.remove(e.options.length-1);
f="";"undefined"!==typeof b&&null!==b&&(f=Z.Utils.roundToFixed(b,3).toString());b="";"undefined"!==typeof c&&null!==c&&(b="-"+Z.Utils.roundToFixed(c,3).toString());d?(a=e.options[l].text,a=a.substring(0,a.indexOf(":\u00a0\u00a0")+3),e.options[l].text=a+f+b):-1==e.options[e.options.length-1].text.toLowerCase().indexOf(a.toLowerCase())?(e.options[e.options.length]=new Option(n,a),Z.Utils.stringValidate(f)&&(e.options[e.options.length-1].text+=":\u00a0\u00a0"+f+b)):(a=e.options[e.options.length-1].text,
a=a.substring(0,a.indexOf(":\u00a0\u00a0")+3),e.options[e.options.length-1].text=a+f+b)}}};
Z.ZoomifyNavigator=function(a){function b(){"undefined"===typeof ha&&(Z.clearCallback(Z.comparison&&"0"!=aa?"navigator2TileLoaded":"navigatorTileLoaded",b),c(),v||(v=!0,Z.Utils.validateCallback("navigatorInitialized"),Z.Viewer.validateViewerReady("navigatorInitialized")),t())}function c(b){"unconverted"!=Z.tileSource?ha="undefined"!==typeof b&&null!==b?b:a.getNavigatorImage():Z.useCanvas&&(ha=a.createUnconvertedImageThumbnail(b));if(Ya&&ha){b=Z.Utils.createContainerElement("div","testImageContainer",
"inline-block","absolute","hidden",$a+"px",ab+"px","0px","0px","none","0px","transparent","0px","0px","normal",null,!0);b.appendChild(ha);b.removeChild(ha);b=ha.width;var c=ha.height;0!=b&&0!=c?(Ya.innerHTML="",Ya.appendChild(ha),ha.alt=xb,ha.id="navigatorImage",D=ha,e($a,ab,ka,ua,jb,b,c)):window.setTimeout(l.drawNavigatorImage,100)}else window.setTimeout(l.drawNavigatorImage,100)}function d(){v&&(G&&(window.clearInterval(G),G=null),T&&ja&&Mb&&w&&Ya&&ra&&D&&U&&F||(T=I,ja=T.style,Mb=I.firstChild,w=
Mb.style,Ya=I.childNodes[1],ra=Ya.style,D=I.childNodes[1].firstChild,U=I.childNodes[2],F=U.style))}function e(b,c,d,e,l,n,v){l||(l=jb);if("undefined"===typeof b||null===b)b=Z.navigatorW;if("undefined"===typeof c||null===c)c=Z.navigatorH;if("undefined"===typeof d||null===d)d=0;if("undefined"===typeof e||null===e)e=0;T||(T=I);ja||(ja=T.style);"undefined"!==typeof n&&null!=n&&"undefined"!==typeof v&&null!=v&&(D=T.childNodes[1].firstChild);D&&(0==D.width&&"undefined"!==n&&null!==n&&(D.width=n),0==D.height&&
"undefined"!==v&&null!==v&&(D.height=v));T&&ja&&D&&(Z.tracking&&(l=0),"undefined"!==typeof l&&null!==l&&(n=D.width/D.height,v=Z.viewerW/Z.viewerH,l=0==l?v:n,1<n?c=b/l:(b=c,b*=l)),ja.width=b+"px",ja.height=c+"px",Z.narrative&&(d+=Z.narrativeW+15,e+=15),ja.left=d+"px",ja.top=e+"px",f(b,c));Z.navigatorW=b;Z.navigatorH=c;if(Z.tracking||Z.annotations||Z.narrative)Z.Ruler&&Z.Ruler.getInitialized()&&(d=-1==Z.rulerL&&Z.Navigator?Z.navigatorL:Z.rulerL,e=-1==Z.rulerT&&Z.Navigator?Z.navigatorT+Z.navigatorH+
1:Z.rulerT,Z.Ruler.setSizeAndPosition(Z.rulerW,Z.rulerH,d,e)),Z.userPanelVisible&&null!==Z.UserPanel&&(b=Z.rulerW,c=parseInt(Z.Utils.getResource("DEFAULT_USERPANELHEIGHT"),10),d=Z.Utils.calculateUserPanelCoords(Z.userPanelPosition,b,c,Z.viewerW,Z.viewerH),Z.Utils.sizeAndPositionUserPanel(Z.UserPanel.style,b,c,d.x,d.y)),Z.imageList&&a.getStatus("initializedImageList")&&(a.setSizeAndPositionImageList(),Z.comparison&&(b=0==a.getViewportID()?Z.Viewport1:Z.Viewport0)&&b.getStatus("initializedImageList")&&
b.setSizeAndPositionImageList())}function f(a,b){D||(D=I.childNodes[1].firstChild);if(D&&0!=D.width&&0!=D.height){if(w||(w=I.firstChild.style),ra||(ra=I.childNodes[1].style),w&&ra&&(w.width=a+"px",w.height=b+"px",m(a,b),ra.width=D.width+"px",ra.height=D.height+"px",ra.left=(a-D.width)/2+"px",ra.top=(b-D.height)/2+"px",t(),Z.comparison)){if(!c)var c=document.getElementById("navigatorBorder"+aa);c&&(c=c.style,c.width=a-2+"px",c.height=b-2+"px",c.left=parseFloat(w.left)+"px",c.top=parseFloat(w.top)+
"px",c.display=aa==Z.viewportCurrentID?"inline-block":"none")}}else window.setTimeout(function(){f(a,b)},100)}function m(a,b){D||(D=I.childNodes[1].firstChild);if(D){var c=D.width,d=D.height,e=c/d,f=a/c,l=b/d;f<=l?(c=a,d=a/e,navImageT=(b-a/c*d)/2):l<f&&(d=b,c=b*e,navImageL=(a-b/d*c)/2);D.width=c;D.height=d}}function u(a){!ja&&I&&(ja=I.style);ja&&(ja.display=a?"inline-block":"none")}function t(){if(a&&a.getStatus("initializedViewport")){C();B();var b=a.calculateCurrentCenterCoordinates();x(b)}}function B(){if(D&&
F){var b=D.width/Z.imageW,c=D.height/Z.imageH,d=a.getZoom(Z.comparison&&aa!=Z.viewportCurrentID),b=Z.viewerW*b/d;Z.comparison&&(b/=2);c=Z.viewerH*c/d;F.width=b+"px";F.height=c+"px"}}function C(){!ra&&I&&(ra=I.childNodes[1].style);if(ra){var b=a.getRotation();Z.Utils.rotateElement(ra,b,!0)}}function x(a){if(D&&F&&ra){if("undefined"===typeof a||null===a||0==a.x&&0==a.y)a=new Z.Utils.Point(Z.imageX,Z.imageY);if("undefined"===typeof z||null===z)z=Z.imageZ;var b=Z.imageR;0>b&&(b+=360);var c=parseFloat(D.width),
d=parseFloat(D.height),b=Z.Utils.rotatePoint(c/Z.imageW*a.x-c/2,d/Z.imageH*a.y-d/2,-b);a=b.x-parseFloat(F.width)/2;c=b.y-parseFloat(F.height)/2;b=parseFloat(ja.width)/2;c=parseFloat(ja.height)/2+c-1;F.left=b+a+(Z.comparison?-1:0)+"px";F.top=c+"px"}}function p(b){if(D&&F&&ra){b=Z.imageR;0>b&&(b+=360);var c=parseFloat(F.left),d=parseFloat(F.top),e=parseFloat(ja.width)/2,f=parseFloat(ja.height)/2,d=d-f,c=c-e+parseFloat(F.width)/2,e=d+parseFloat(F.height)/2;b=Z.Utils.rotatePoint(c,e,b);c=parseFloat(D.width);
e=parseFloat(D.height);d=c/Z.imageW;b=new Z.Utils.Point((b.x+c/2)/d,(b.y+e/2)/d);a.syncViewportToNavigator(b)}}function R(b){Z.interactive&&(a.zoomAndPanAllStop(!1,!0),Z.mouseIsDown=!0,Z.comparison&&Z.Viewer.viewportSelect(parseInt(aa,10)),Z.maskingSelection&&Z.maskClearOnUserAction&&a.clearMask(),T&&U&&F&&(b=Z.Utils.event(b),U.mouseXPrior=b.clientX,U.mouseYPrior=b.clientY,dragPtStart=new Z.Utils.Point(b.clientX,b.clientY),Z.Utils.addEventListener(T,"mousemove",ma),Z.Utils.addEventListener(T,"mouseup",
ea),Z.Utils.addEventListener(document,"mouseup",ea)))}function ma(a){if(Z.interactive&&U&&F){var b=parseFloat(F.left),c=parseFloat(F.top);F.left=b+(a.clientX-U.mouseXPrior)+"px";F.top=c+(a.clientY-U.mouseYPrior)+"px";U.mouseXPrior=a.clientX;U.mouseYPrior=a.clientY;p(!1);return!1}}function ea(b){if(Z.interactive&&(Z.mouseIsDown=!1,T&&U&&F)){document.mousemove=null;document.mouseup=null;Z.Utils.removeEventListener(T,"mousemove",ma);Z.Utils.removeEventListener(T,"mouseup",ea);Z.Utils.removeEventListener(document,
"mouseup",ea);b=Z.Utils.event(b);var c=new Z.Utils.Point(b.clientX,b.clientY);if(c=Z.Utils.calculatePointsDistance(dragPtStart.x,dragPtStart.y,c.x,c.y)<Ia){var d=Z.Utils.getElementPosition(I);F.left=b.clientX-d.x-parseFloat(F.width)/2+"px";F.top=b.clientY-d.y-parseFloat(F.height)/2+"px"}p(c);Z.comparison&&c||a.updateView()}}function K(a){Z.interactive&&(Z.mouseIsDown=!0,a.preventDefault(),T&&U&&F&&(a=Z.Utils.getFirstTouch(a)))&&(a=new Z.Utils.Point(a.pageX,a.pageY),dragPtStart=new Z.Utils.Point(a.x,
a.y),U.mouseXPrior=a.x,U.mouseYPrior=a.y)}function L(a){if(Z.interactive&&(a.preventDefault(),Z.mousePan)){if(U&&F&&(a=Z.Utils.getFirstTouch(a))){a=new Z.Utils.Point(a.pageX,a.pageY);var b=parseFloat(F.left),c=parseFloat(F.top);F.left=b+(a.x-U.mouseXPrior)+"px";F.top=c+(a.y-U.mouseYPrior)+"px";U.mouseXPrior=a.x;U.mouseYPrior=a.y;p(!1)}return!1}}function n(b){if(Z.interactive&&(Z.mouseIsDown=!1,T&&U&&F)){if(b=Z.Utils.getFirstTouch(b)){b=new Z.Utils.Point(b.pageX,b.pageY);var c=new Z.Utils.Point(b.x,
b.y);if(c=Z.Utils.calculatePointsDistance(dragPtStart.x,dragPtStart.y,c.x,c.y)<Za){var d=Z.Utils.getElementPosition(I);F.left=b.x-d.x-parseFloat(F.width)/2+"px";F.top=b.y-d.y-parseFloat(F.height)/2+"px"}}p(c);a.updateView()}}function A(b){if(Z.interactive&&(Z.mouseIsDown=!1,T&&U&&F)){if(b=Z.Utils.getFirstTouch(b)){b=new Z.Utils.Point(b.pageX,b.pageY);var c=new Z.Utils.Point(b.x,b.y);if(c=Z.Utils.calculatePointsDistance(dragPtStart.x,dragPtStart.y,c.x,c.y)<Za){var d=Z.Utils.getElementPosition(I);F.left=
b.x-d.x-parseFloat(F.width)/2+"px";F.top=b.y-d.y-parseFloat(F.height)/2+"px"}}p(c);a.updateView()}}var l=this,v=!1,aa=a.getViewportID().toString(),G,I,T,ja,Mb,w,Ya,ra,D,U,F,ha,xb=Z.Utils.getResource("z439"),Ia=parseInt(Z.Utils.getResource("DEFAULT_MOUSECLICKTHRESHOLDNAVIGATOR"),10),Za=parseInt(Z.Utils.getResource("DEFAULT_TOUCHTAPTHRESHOLDNAVIGATOR"),10),$a=Z.navigatorW,ab=Z.navigatorH,ka=Z.navigatorL,ua=Z.navigatorT,jb=Z.navigatorFit;Z.comparison&&"1"==aa&&(ka=Z.viewerW-$a-1);(function(){I=Z.Utils.createContainerElement("div",
"navigatorDisplay"+aa,"inline-block","absolute","hidden",$a+"px",ab+"px",ka+"px",ua+"px","solid","1px","transparent","0px","0px","normal",null,!0);T=Z.NavigatorDisplay=I;ja=T.style;Z.slideshow&&Z.Utils.setOpacity(Z.NavigatorDisplay,0);ja.zIndex=(Z.baseZIndex+4).toString();var c=parseFloat(Z.Utils.getResource("z82")),d=Z.Utils.getResource("z83"),f=Z.Utils.getResource("z83NOALPHA"),d=Z.Utils.createContainerElement("div","navigatorBackground","inline-block","absolute","hidden",$a+"px",ab+"px","0px",
"0px","none","0px",d,"0px","0px","normal",null,!0);Z.Utils.setOpacity(d,c,f);I.appendChild(d);Mb=d;w=Mb.style;c=Z.Utils.createContainerElement("div","navigatorImageContainer","inline-block","absolute","hidden",$a+"px",ab+"px","0px","0px","none","0px","transparent","0px","0px","normal",null,!0);I.appendChild(c);Ya=c;ra=Ya.style;c=Z.Utils.createContainerElement("div","navigatorRectangle","inline-block","absolute","hidden",$a+1+"px",ab+1+"px",ka+"px",ua+"px","solid","1px","transparent","0px","0px","normal",
null,!0);c.style.borderColor=Z.Utils.stringValidateColorValue(Z.navigatorRectangleColor);I.appendChild(c);U=c;F=U.style;Z.comparison&&(c=Z.Utils.getResource("DEFAULT_NAVIGATORBORDERCOLOR"),f=Z.Utils.createContainerElement("div","navigatorBorder"+aa,"inline-block","absolute","hidden",$a+1+"px",ab+1+"px",ka+"px",ua+"px","solid","1px","transparent","0px","0px","normal",null,!0),f.style.borderColor=Z.Utils.stringValidateColorValue(c),I.appendChild(f),nBO=f,nboS=Mb.style);Z.ViewerDisplay.appendChild(I);
e($a,ab,ka,ua,jb,null,null);u(1==Z.navigatorVisible||2==Z.navigatorVisible);Z.Utils.addEventListener(T,"mouseover",Z.Utils.stopPropagation);Z.Utils.addEventListener(T,"mousedown",R);Z.Utils.addEventListener(T,"touchstart",K);Z.Utils.addEventListener(T,"touchmove",L);Z.Utils.addEventListener(T,"touchend",n);Z.Utils.addEventListener(T,"touchcancel",A);a&&(a.getStatus("precacheLoadedViewport")||"unconverted"==Z.tileSource)?b():Z.setCallback(Z.comparison&&"0"!=aa?"navigator2TileLoaded":"navigatorTileLoaded",
b)})();this.drawNavigatorImage=function(a){c(a)};this.drawNavigatorImage=function(a){c(a)};this.setImage=function(){Z.tracking&&I&&0<I.childNodes.length&&I.removeChild(navigatorTrackingOverlay);c()};this.getInitialized=function(){return v};this.setVisibility=function(a){u(a)};this.setSelected=function(a){if(!b)var b=document.getElementById("navigatorBorder"+aa);b&&(b.style.display=a?"inline-block":"none")};this.syncToViewport=function(){t()};this.z657=function(){B()};this.z659=function(){C()};this.z658=
function(a){x(a)};this.setViewport=function(b){a=b;aa=a.getViewportID().toString();Z.overlays||l.setImage()};this.drawNavigatorTrackingOverlay=function(b,c){var d=document.getElementById("navigatorTrackingOverlay");if("undefined"===typeof d||null===d)d=Z.Utils.createContainerElement("div","navigatorTrackingOverlay","none","absolute","visible",$a+1+"px",ab+1+"px",ka+"px",ua+"px","none","0px","transparent","0px","0px","normal",null,!0),I.appendChild(d);if(d){for(;d.hasChildNodes();)d.removeChild(d.lastChild);
if("undefined"===typeof c||null===c)c=Z.Navigator.getSizeAndPositionNavigatorImage();if(c)for(var e=c.height/Z.imageH,f=Math.round(c.width/Z.imageW*Z.viewerW),e=Math.round(Z.viewerH*e),n=0,v=b.length;n<v;n++){if(b[n].complete){var g=a.getCoordinatesFromTrackingCellID(b[n].id);if(null!==g.x&&null!==g.y&&null!==g.z){var m=g.z/100,k=f/m,A=e/m,p=Math.floor(g.x*k),g=Math.floor(g.y*A),k=p+k<=c.width?k:c.width-p,A=g+A<=c.height?A:c.height-g,t="cellComp"+n.toString(),m=getTrackingOverlayColor(m);d[t]=Z.Utils.createContainerElement("div",
t,"inline-block","absolute","visible",k+"px",A+"px",p+"px",g+"px","solid","1px",m,"0px","0px","normal",null,!0);d.appendChild(d[t]);Z.Utils.setOpacity(d[t],.25)}}}else window.setTimeout(function(){l.drawNavigatorTrackingOverlay(b)},10)}};getTrackingOverlayColor=function(a){a=Z.Utils.convertZoomPercentToMagnification(100*a,Z.sourceMagnification,!0);return Z.Utils.stringValidateColorValue(Z.Utils.getResource("UI_TRACKINGNAVIGATOROVERLAYCOLOR_UNDER"+(2>a?"1":4>a?"2":10>a?"4":16>a?"10":25>a?"16":40>a?
"25":60>a?"40":100>a?"60":"INFINITY")))};this.z682=function(){v?d():G=window.setInterval(d,300)};this.setSizeAndPosition=function(a,b,c,d,f,l,n){e(a,b,c,d,f,l,n)};this.getSizeAndPositionNavigatorImage=function(){D||(D=I.childNodes[1].firstChild);var a=null;"undefined"!==typeof D.parentNode&&null!==D.parentNode&&(a=D.parentNode.style,a={width:D.width,height:D.height,left:parseFloat(a.left)-1,top:parseFloat(a.top)-1});return a}};
Z.NetConnector=function(){function a(a,d,e,v,m){var p=a.substring(0,a.indexOf("?")),t=parseFloat(a.substring(a.indexOf("?")+1,a.indexOf(","))),u=parseFloat(a.substring(a.indexOf(",")+1,a.length)),t=new Z.Utils.Range(t,t+u);Z.useLocalFile?b(a,m,t,d,e,v,null):c(p,function(a){f(a,m)},t,d,e,v)}function b(a,b,c,d,e,f,p){c.end+=1;a=Z.localFile.slice(c.start,c.end);c=new FileReader;c.onloadend=function(a){a.target.readyState==FileReader.DONE&&m(a.target.result,b,d,e,f,p)};c.readAsArrayBuffer(a)}function c(a,
b,c,f,m,p,t,u,x,B){var w=d();if(null===w)Z.Utils.showMessage(Z.Utils.getResource("z295"));else{var C="function"===typeof b;if(C){var K=b;b=function(){window.setTimeout(Z.Utils.createCallback(null,K,w),1)};w.onreadystatechange=function(){4==w.readyState&&(w.onreadystatechange=new Function,b())}}try{if("undefined"!==typeof f){var D;if(-1!=a.indexOf("accessType")&&-1==a.indexOf("../../"))if(-1==f.indexOf("renamingFile")){var L=a.indexOf("filePath=")+9;a=a.substring(0,L)+"../../"+a.substring(L)}else{var F=
a.indexOf("filePathOld=")+12;a=a.substring(0,F)+"../../"+a.substring(F);var R=a.indexOf("filePathNew=")+12;a=a.substring(0,R)+"../../"+a.substring(R)}if(-1!=f.indexOf("List"))w.open("POST",a,C),Z.Utils.setObjectProperty(w,"zType",{value:f,writable:!1,enumerable:!1,configurable:!1}),w.setRequestHeader("Content-Type","application/json"),w.send(null);else if(-1!=f.indexOf("renamingFile"))w.open("POST",a,C),D=f.substring(f.indexOf("renamingFile-")+13,f.length),Z.Utils.setObjectProperty(w,"zType",{value:"renamingFile-"+
D,writable:!1,enumerable:!1,configurable:!1}),w.send(null);else if(-1!=f.indexOf("deletingFile"))w.open("POST",a,C),D=f.substring(f.indexOf("deletingFile-")+13,f.length),Z.Utils.setObjectProperty(w,"zType",{value:"deletingFile-"+D,writable:!1,enumerable:!1,configurable:!1}),w.send(null);else if("loadingIIIFJSON"==f)w.open("GET",a,C),w.send(null);else if(-1!=f.indexOf("loading")&&"undefined"===typeof c||null===c)w.open("POST",a,C),Z.Utils.setObjectProperty(w,"zType",{value:f,writable:!1,enumerable:!1,
configurable:!1}),"undefined"!==typeof u&&"undefined"!==typeof x&&"undefined"!==typeof B&&(Z.Utils.setObjectProperty(w,"zFilePath",{value:u,writable:!1,enumerable:!1,configurable:!1}),Z.Utils.setObjectProperty(w,"zOldName",{value:x,writable:!1,enumerable:!1,configurable:!1}),Z.Utils.setObjectProperty(w,"zNewName",{value:B,writable:!1,enumerable:!1,configurable:!1})),f&&-1!=f.indexOf("HTML")&&w.setRequestHeader("Content-Type","text/html"),w.send(null);else if(Z.localUse&&-1!=f.indexOf("post"))Z.Utils.showMessage(Z.Utils.getResource("ERROR_UNSUPPORTEDLOCALSAVING"),
!1,Z.messageDurationStandard,"center",!0);else if("postingAnnotationsXML"==f||"postingTrackingXML"==f||"postingImageMetadata"==f){Z.postingXML=!0;w.open("POST",a,!0);Z.Utils.setObjectProperty(w,"zType",{value:f,writable:!1,enumerable:!1,configurable:!1});var ea=a.indexOf("&"),ma=a.indexOf("?");u=-1!=ea?a.substring(ea):a.substring(ma);console.log(a);Z.Utils.setObjectProperty(w,"zFile",{value:u,writable:!1,enumerable:!1,configurable:!1});w.setRequestHeader("Content-Type","application/xml");w.send(c)}else if("postingHTML"==
f)Z.postingHTML=!0,w.open("POST",a,!0),Z.Utils.setObjectProperty(w,"zType",{value:"postingHTML",writable:!1,enumerable:!1,configurable:!1}),w.setRequestHeader("Content-Type","text/html"),w.send(c);else if("postingImage"==f){Z.Utils.showMessage(Z.Utils.getResource("ALERT_IMAGESAVEUPLOADING"),!1,"none","center");Z.postingImage=!0;var Za=new FormData,$a=Z.legacySaveHandlerInUse?"fileToUpload":"fileData";a=Z.legacySaveHandlerInUse?a:a+"?accessType=saveImage";Za.append($a,c);Z.Utils.addEventListener(w.upload,
"progress",Z.Utils.uploadProgress);w.open("POST",a,!0);Z.Utils.setObjectProperty(w,"zType",{value:f,writable:!1,enumerable:!1,configurable:!1});w.setRequestHeader("Content-Type","application/upload");w.send(Za)}else if("postingFile-narrative"==f||"postingFile-image"==f||"postingFile-media"==f||"postingFile-labelset"==f)Z.Utils.showMessage(Z.Utils.getResource("ALERT_FILEUPLOADING"),!1,"none","center"),Z.postingFile=!0,Za=new FormData,Za.append("filePath",c),Z.Utils.addEventListener(w.upload,"progress",
Z.Utils.uploadProgress),w.open("POST",a,!0),Z.Utils.setObjectProperty(w,"zType",{value:f,writable:!1,enumerable:!1,configurable:!1}),w.setRequestHeader("Content-Type","application/upload"),w.send(Za);else if("loadingZIFFileBytes"==f||"loadingPFFFileBytes"==f||"loadingImageTile"==f)"tile"!=m&&(a=Z.Utils.cacheProofPath(a)),w.open("GET",a,!0),w.responseType="arraybuffer",Z.Utils.setObjectProperty(w,"zType",{value:f,writable:!1,enumerable:!1,configurable:!1}),Z.Utils.setObjectProperty(w,"zDataType",{value:m,
writable:!1,enumerable:!1,configurable:!1}),Z.Utils.setObjectProperty(w,"zTile",{value:p,writable:!1,enumerable:!1,configurable:!1}),Z.Utils.setObjectProperty(w,"zChunkNumber",{value:t,writable:!1,enumerable:!1,configurable:!1}),Z.browser==Z.browsers.SAFARI&&w.setRequestHeader("If-Modified-Since","Thu, 01 Dec 1994 16:00:00 GMT"),w.setRequestHeader("Range","bytes="+c.start.toString()+"-"+c.end.toString()),w.send(null)}}catch(ab){e(ab,a,f),w=null,console.log(ab)}}}function d(){var a=null;switch(Z.xmlHttpRequestSupport){case "XMLHttpRequest":a=
new XMLHttpRequest;break;case "Msxml2.XMLHTTP.6.0":a=new ActiveXObject("Msxml2.XMLHTTP.6.0");break;case "Msxml2.XMLHTTP.3.0":a=new ActiveXObject("Msxml2.XMLHTTP.3.0");break;case "Microsoft.XMLHTTP":a=new ActiveXObject("Microsoft.XMLHTTP")}return a}function e(a,b,c){1==Z.localUse&&(Z.browser==Z.browsers.CHROME||Z.browser==Z.browsers.OPERA||Z.browser==Z.browsers.IE&&11==Z.browserVersion||Z.browser==Z.browsers.SAFARI&&7<=Z.browserVersion)?Z.Utils.showMessage(Z.Utils.getResource("z288"),!1,Z.messageDurationStandard,
"center"):1==Z.localUse&&"ZoomifyZIFFile"==Z.tileSource?Z.Utils.showMessage(Z.Utils.getResource("z290"),!1,Z.messageDurationShort,"center"):1==Z.localUse&&"ZoomifyPFFFile"==Z.tileSource?Z.Utils.showMessage(Z.Utils.getResource("z289"),!1,Z.messageDurationShort,"center"):-1!=b.toLowerCase().indexOf(".zif")?Z.Utils.showMessage(Z.Utils.getResource("z256-ZIFBYTERANGE")+c+".",!1,Z.messageDurationShort,"center"):-1!=b.indexOf("ImageProperties.xml")?Z.Utils.showMessage(Z.Utils.getResource("z256-IMAGEXML"),
!0,null,"left"):-1!=b.toLowerCase().indexOf(".pff")?Z.Utils.showMessage(Z.Utils.getResource("z256-IMAGEHEADER"),!1,Z.messageDurationShort,"center"):-1!=b.toLowerCase().indexOf(".pff")?Z.Utils.showMessage(Z.Utils.getResource("z256-IMAGEXML-DZI"),!1,Z.messageDurationShort,"center"):-1!=b.toLowerCase().indexOf("reply_data")?Z.Utils.showMessage(Z.Utils.getResource("z256-IMAGEOFFSET"),!1,Z.messageDurationShort,"center"):-1!=b.indexOf(Z.Utils.getResource("z200"))?Z.Utils.showMessage(Z.Utils.getResource("z256-TOOLBARSKINSXML"),
!0,null,"left"):-1!=b.indexOf(Z.Utils.getResource("DEFAULT_IMAGELISTXMLFILE"))?Z.Utils.showMessage(Z.Utils.getResource("z256-IMAGELISTXML"),!1,Z.messageDurationShort,"center"):-1!=b.indexOf(Z.Utils.getResource("DEFAULT_COMPARISONXMLFILE"))?Z.Utils.showMessage(Z.Utils.getResource("z256-COMPARISONXML"),!1,Z.messageDurationShort,"center"):-1!=b.indexOf(Z.Utils.getResource("z209"))?Z.Utils.showMessage(Z.Utils.getResource("z256-SLIDESXML"),!1,Z.messageDurationShort,"center"):-1!=b.indexOf(Z.Utils.getResource("z135"))?
Z.Utils.showMessage(Z.Utils.getResource("z256-HOTSPOTSXML"),!1,Z.messageDurationShort,"center"):-1!=b.indexOf(Z.Utils.getResource("z69"))?(Z.Utils.showMessage(Z.Utils.getResource("z256-CREATINGANNOTATIONSXMLFILE"),!1,Z.messageDurationShort,"center"),Z.Viewport.createAnnotationsXMLFile()):-1!=b.indexOf(Z.Utils.getResource("z68"))?Z.Utils.showMessage(Z.Utils.getResource("z256-ANNOTATIONSJSON"),!1,Z.messageDurationShort,"center"):-1!=b.toLowerCase().indexOf(Z.Utils.getResource("z69HANDLERNAME1"))||-1!=
b.toLowerCase().indexOf(Z.Utils.getResource("z69HANDLERNAME1"))?Z.Utils.showMessage(Z.Utils.getResource("z256-ANNOTATIONSFILEHANDLER"),!1,Z.messageDurationShort,"center"):Z.Utils.showMessage(Z.Utils.getResource("z256"),!1,Z.messageDurationShort,"center")}function f(a,b){if(a)if(200!==a.status&&0!==a.status&&206!==a.status){var c=a.status,d=404==c?"Not Found":a.statusText;if(404==c&&"loadingImageMetadataXML"==a.zType)Z.Utils.validateCallback("loadingImageMetadataXMLFailed");else if(404==c&&"loadingAnnotationsXML"==
a.zType)Z.Utils.validateCallback("loadingAnnotationsXMLFailed");else if(Z.xmlParametersParsing)Z.Utils.showMessage(Z.Utils.getResource("z256-PARAMETERSXML"),!0,null,"left");else if(Z.Toolbar&&!Z.Toolbar.getInitialized())Z.Utils.showMessage(Z.Utils.getResource("z256-TOOLBARSKINSXML"),!0,null,"left");else if(Z.Viewport&&null!==Z.annotationPath&&Z.Viewport.getStatus("initializedViewport")&&!Z.Viewport.getStatus("XMLParsedViewport"))Z.Utils.showMessage(Z.Utils.getResource("z256-CREATINGANNOTATIONSXMLFILE"),
!1,Z.messageDurationShort,"center"),Z.Viewport.createAnnotationsXMLFile();else if("ZoomifyZIFFile"==Z.tileSource)Z.Utils.showMessage(Z.Utils.getResource("z273RANGEREQUESTSZIF")+c+" - "+d,!0,null,"left");else if("ZoomifyPFFFile"==Z.tileSource)Z.Utils.showMessage(Z.Utils.getResource("z273RANGEREQUESTSPFF")+c+" - "+d,!0,null,"left");else if("DZIFolder"==Z.tileSource)Z.Utils.showMessage(Z.Utils.getResource("z256-IMAGEXML-DZI")+c+" - "+d,!0,null,"left");else{var e=Z.Utils.verifyCallback("loadingImageXMLFailed");
e?(Z.Utils.validateCallback("loadingImageXMLFailed"),console.log(Z.Utils.getResource("z273")+c+" - "+d)):Z.Utils.showMessage(Z.Utils.getResource("z273")+c+" - "+d,!1,Z.messageDurationShort,"center")}}else if(a.zType)if(c=null,d="undefined"!==typeof Z.annotationPath&&Z.Utils.stringValidate(Z.annotationPath)&&".json"==Z.annotationPath.toLowerCase().substring(Z.annotationPath.length-5,Z.annotationPath.length),"postingImage"==a.zType&&Z.postingImage)Z.postingImage=!1,(e=Z.Utils.verifyCallback("imageSaveComplete"))?
(Z.Utils.hideMessage(),Z.Utils.validateCallback("imageSaveComplete")):Z.Utils.showMessage(Z.Utils.getResource("ALERT_IMAGESAVESUCCESSFUL"),!1,Z.messageDurationShort,"center");else if(("postingFile-narrative"==a.zType||"postingFile-image"==a.zType||"postingFile-media"==a.zType||"postingFile-labelset"==a.zType)&&Z.postingFile)Z.postingFile=!1,"postingFile-narrative"==a.zType?Z.Utils.validateCallback("narrativeFileUploaded"):"postingFile-image"==a.zType?Z.Utils.validateCallback("narrativeImageUploaded"):
"postingFile-media"==a.zType?Z.Utils.validateCallback("narrativeMediaUploaded"):"postingFile-labelset"==a.zType&&Z.Utils.validateCallback("narrativeAnnotationFileUploaded"),Z.Utils.showMessage(Z.Utils.getResource("ALERT_FILEUPLOADSUCCESSFUL"),!1,Z.messageDurationShort,"center");else if("loadingZIFFileBytes"==a.zType||"loadingImageTile"==a.zType&&"ZoomifyZIFFile"==Z.tileSource)m(a,b,a.zType,a.dataType);else if("loadingPFFFileBytes"==a.zType||"loadingImageTile"==a.zType&&"ZoomifyPFFFile"==Z.tileSource)m(a,
b,a.zType,a.dataType);else{if(""==a.responseType||"document"==a.responseType)a.responseXML&&a.responseXML.documentElement&&!d?(c=a.responseXML,t(c,b)):a.responseText&&((c=a.responseText,"narrativeList"==a.zType||"mediaList"==a.zType||"imageList"==a.zType||"annotationFileList"==a.zType)?(c=Z.Utils.stringUnescapeSpaces(c),u(c,b,a.zType)):"postingHTML"==a.zType?(Z.postingHTML=!1,-1==a.responseText.indexOf("Failed to save")?(Z.Utils.showMessage(Z.Utils.getResource("ALERT_NARRATIVESAVESUCCESSFUL"),!1,
Z.messageDurationShort,"center"),Z.narrative&&Z.Utils.validateCallback("narrativeFilePosted")):Z.Utils.showMessage("\n"+a.responseText,!1,Z.messageDurationShort,"center")):"loadingAnnotationsJSON"!=a.zType||-1==c.indexOf("ANNOTATIONDATA")&&-1==c.indexOf("ZAS")&&-1==c.indexOf("Annotations")||!d?"postingAnnotationsXML"==a.zType||"postingTrackingXML"==a.zType||"postingImageMetadata"==a.zType?(Z.postingXML=!1,Z.Utils.showMessage(Z.Utils.getResource("z1"),!1,Z.messageDurationShort,"center",!1,"5"),Z.Viewport&&
Z.Viewport.setAllHotspotsSaved(),Z.narrative&&Z.Utils.validateCallback("narrativeAnnotationFilePosted")):-1!=a.zType.indexOf("renamingFile")?-1==a.responseText.indexOf("Failed to save")?(Z.Utils.showMessage(Z.Utils.getResource("ALERT_FILEMANAGERRENAMESUCCESSFUL"),!1,Z.messageDurationShort,"center",!1,"5"),c="newFilenamePosted-",fileType=a.zType.substring(a.zType.indexOf("renamingFile-")+13,a.zType.length),Z.Utils.validateCallback(c+fileType)):Z.Utils.showMessage("\n"+a.responseText,!1,Z.messageDurationShort,
"center"):-1!=a.zType.indexOf("deletingFile")?-1==a.responseText.indexOf("Failed to save")?(Z.Utils.showMessage(Z.Utils.getResource("ALERT_FILEMANAGERDELETIONSUCCESSFUL"),!1,Z.messageDurationShort,"center",!1,"5"),c="fileDeleted-",fileType=a.zType.substring(a.zType.indexOf("deletingFile-")+13,a.zType.length),Z.Utils.validateCallback(c+fileType)):Z.Utils.showMessage("\n"+a.responseText,!1,Z.messageDurationShort,"center"):"ZoomifyImageFolder"==Z.tileSource?(c=Z.Utils.xmlConvertTextToDoc(c),t(c,b)):
"ZoomifyZIFFile"==Z.tileSource?(c=Z.Utils.xmlConvertTextToDoc(c),t(c,b)):"ZoomifyPFFFile"==Z.tileSource&&(-1!=c.toUpperCase().indexOf("PFFHEADER")?(d=c.indexOf("reply_data=")+11,c=c.substring(d,c.length)):(d=c.indexOf("begin=")+6,e=c.indexOf("&",d),beginValue=c.substring(d,e),d=c.indexOf("reply_data=")+11,replyDataValue=c.substring(d,c.length),c="<PFFOFFSET BEGIN='"+beginValue+"' REPLYDATA='"+replyDataValue+"' />"),c=Z.Utils.xmlConvertTextToDoc(c),t(c,b)):u(c,b,"loadingAnnotationsJSON"))}else"IIIFImageServer"==
Z.tileSource&&a.responseText&&u(a.responseText,b,"loadingIIIFJSON");else Z.Utils.showMessage(Z.Utils.getResource("z272"),!1,Z.messageDurationShort,"center")}function m(a,b,c,d,e,f){if(Z.Viewport)if(Z.useLocalFile||(f=a.zChunkNumber,e=a.zTile),a=new Z.Utils.createUint8Array(Z.useLocalFile?a:a.response,0),"header"==d)if(null===Z.tileSourceMultiple||"undefined"===typeof b||null===b)"ZoomifyZIFFile"==Z.tileSource?Z.Viewport.parseZIFHeader(a):"ZoomifyPFFFile"==Z.tileSource&&Z.Viewport.parsePFFHeader(a);
else{c=0;for(var m=Z.imageSetLength;c<m;c++)"ZoomifyZIFFile"==Z.tileSource?b==c&&Z["Viewport"+c.toString()].parseZIFHeader(a):"ZoomifyPFFFile"==Z.tileSource&&b==c&&Z["Viewport"+c.toString()].parsePFFHeader(a)}else if("jpegHeaders"==d)if(null===Z.tileSourceMultiple||"undefined"===typeof b||null===b)Z.Viewport.parsePFFJPEGHeaders(a);else for(c=0,m=Z.imageSetLength;c<m;c++)b==c&&Z["Viewport"+c.toString()].parsePFFJPEGHeaders(a);else if("offset"==d)if(null===Z.tileSourceMultiple||"undefined"===typeof b||
null===b)"ZoomifyZIFFile"==Z.tileSource?Z.Viewport.parseZIFOffsetChunk(a,f):"ZoomifyPFFFile"==Z.tileSource&&Z.Viewport.parsePFFOffsetChunk(a,f);else for(c=0,m=Z.imageSetLength;c<m;c++)"ZoomifyZIFFile"==Z.tileSource?b==c&&Z["Viewport"+c.toString()].parseZIFOffsetChunk(a,f):"ZoomifyPFFFile"==Z.tileSource&&b==c&&Z["Viewport"+c.toString()].parsePFFOffsetChunk(a,f);else if("byteCount"==d)if(null===Z.tileSourceMultiple||"undefined"===typeof b||null===b)Z.Viewport.parseZIFByteCountChunk(a,f);else for(c=
0,m=Z.imageSetLength;c<m;c++)b==c&&Z["Viewport"+c.toString()].parseZIFByteCountChunk(a,f);else if(d&&"image"==d.substring(0,5))if(p--,null===Z.tileSourceMultiple||"undefined"===typeof b||null===b)"ZoomifyZIFFile"==Z.tileSource?Z.Viewport.parseZIFImage(a,e,d):"ZoomifyPFFFile"==Z.tileSource&&Z.Viewport.parsePFFImage(a,e,d);else for(c=0,m=Z.imageSetLength;c<m;c++)"ZoomifyZIFFile"==Z.tileSource?b==c&&Z["Viewport"+c.toString()].parseZIFImage(a,e,d):"ZoomifyPFFFile"==Z.tileSource&&b==c&&Z["Viewport"+c.toString()].parsePFFImage(a,
e,d);else if("gallery"==d)if(null===Z.tileSourceMultiple||"undefined"===typeof b||null===b)"ZoomifyZIFFile"==Z.tileSource?Z.viewportCurrent.parseZIFImage(a,e,d):"ZoomifyPFFFile"==Z.tileSource&&Z.viewportCurrent.parsePFFImage(a,e,d);else for(c=0,m=Z.imageSetLength;c<m;c++)"ZoomifyZIFFile"==Z.tileSource?b==c&&Z["Viewport"+c.toString()].parseZIFImage(a,e,d):"ZoomifyPFFFile"==Z.tileSource&&b==c&&Z["Viewport"+c.toString()].parsePFFImage(a,e,d);else"loadingZIFFileBytes"==c||"loadingImageTile"==c&&"ZoomifyZIFFile"==
Z.tileSource?Z.Utils.showMessage(Z.Utils.getResource("z256-ZIFBYTES"),!1,Z.messageDurationShort,"center"):("loadingPFFFileBytes"==c||"loadingImageTile"==c&&"ZoomifyPFFFile"==Z.tileSource)&&Z.Utils.showMessage(Z.Utils.getResource("z256-PFFBYTES"),!1,Z.messageDurationShort,"center")}function u(a,b,c){var d=null;try{d=JSON.parse(a)}catch(e){Z.Utils.showMessage(e.name+Z.Utils.getResource("z276")+e.message)}if(d)if("narrativeList"==c)b=Z.Utils.jsonConvertObjectToDataProvider(d),Z.Narrative.configureNarrativeList(b);
else if("imageList"==c)b=Z.Utils.jsonConvertObjectToDataProvider(d),Z.Narrative.configureNarrativeImageChoiceList(b);else if("mediaList"==c)b=Z.Utils.jsonConvertObjectToDataProvider(d),Z.Narrative.configureNarrativeMediaChoiceList(b);else if("annotationFileList"==c)b=Z.Utils.jsonConvertObjectToDataProvider(d),Z.Narrative.configureAnnotationFileChoiceListFromNarrative(b);else if("loadingIIIFJSON"==c)if(Z.iiifInfoJSONObject=d,a='<IMAGE_PROPERTIES WIDTH="'+d.width+'" HEIGHT="'+d.height+'" />',a=Z.Utils.xmlConvertTextToDoc(a),
"undefined"===typeof b||null===b||null===Z.imageSetLength)Z.Viewport&&Z.Viewport.z602(a);else for(c=0,d=Z.imageSetLength;c<d;c++)b==c&&Z["Viewport"+c.toString()].z602(a);else if("loadingAnnotationsJSON"==c)if(Z.annotationJSONObject=d,a=Z.Utils.jsonConvertObjectToXMLText(d),a=Z.Utils.xmlConvertTextToDoc(a),"undefined"===typeof b||null===b)Z.Viewport&&Z.Viewport.parseAnnotationsXML(a);else for(c=0,d=Z.imageSetLength;c<d;c++)b==c&&Z["Viewport"+c.toString()].parseAnnotationsXML(a);else Z.overlays?(Z.overlayJSONObject=
d,a=Z.Utils.jsonConvertObjectToXMLText(d),a=Z.Utils.xmlConvertTextToDoc(a),Z.Viewer&&Z.Viewer.parseImageSetXML(a,"overlay")):Z.Utils.showMessage(Z.Utils.getResource("z276-TYPEUNKNOWN"))}function t(a,b){if(a&&a.documentElement){var c=a.documentElement.tagName;if(Z.xmlParametersParsing)Z.Utils.parseParametersXML(a);else if("USERDATA"==c)Z.Utils.parseUsersXML(a);else if("COPYRIGHT"==c){var c=a.documentElement.getAttribute("STATEMENTTEXT"),d=a.documentElement.getAttribute("DECLINEDTEXT");Z.Utils.stringValidate(c)?
Z.Utils.showCopyright(c,d):Z.Utils.showMessage(Z.Utils.getResource("z255"),!0)}else if("IMAGE_PROPERTIES"==c||"ZIFHEADER"==c||"PFFHEADER"==c||"Image"==c){if("ZoomifyZIFFile"==Z.tileSource||"ZoomifyImageFolder"==Z.tileSource||"ZoomifyPFFFile"==Z.tileSource||"DZIFolder"==Z.tileSource||"ImageServer"==Z.tileSource)if("multiple"!=Z.imagePath)c="undefined"===typeof b||null===b||0==b?Z.Viewport:Z["Viewport"+b.toString()],c.z602(a);else for(c=0,d=Z.imageSetLength;c<d;c++)b==c&&Z["Viewport"+c.toString()].z602(a)}else if("PFFOFFSET"==
c)if("multiple"!=Z.imagePath)c=null===Z.tileSourceMultiple||"undefined"===typeof b||null===b||0==b?Z.Viewport:Z["Viewport"+b.toString()],c.parsePFFOffsetChunkServlet(a);else for(c=0,d=Z.imageSetLength;c<d;c++)b==c&&Z["Viewport"+c.toString()].parsePFFOffsetChunkServlet(a);else if("SKINDATA"==c)"function"===typeof Z.xmlCallbackFunction?Z.xmlCallbackFunction(a):Z.Toolbar&&Z.Toolbar.parseSkinXML(a);else if("IMAGEMETADATA"==c)Z.Viewport&&Z.Viewport.parseImageMetadataXML(a);else if("IMAGELISTDATA"==c)if(null===
Z.tileSourceMultiple||"undefined"===typeof b||null===b)Z.Viewport&&Z.Viewport.parseImageListXML(a);else for(c=0,d=Z.imageSetLength;c<d;c++)b==c&&Z["Viewport"+c.toString()].parseImageListXML(a,b);else if("COMPARISONDATA"==c)Z.Viewer&&Z.Viewer.parseImageSetXML(a,"comparison");else if("OVERLAYDATA"==c)Z.Viewer&&Z.Viewer.parseImageSetXML(a,"overlay");else if("SLIDEDATA"==c)Z.Viewport&&Z.Viewport.parseSlidesXML(a);else if("HOTSPOTDATA"==c)if("undefined"===typeof b||null===b)Z.Viewport&&Z.Viewport.parseHotspotsXML(a);
else for(c=0,d=Z.imageSetLength;c<d;c++)b==c&&Z["Viewport"+c.toString()].parseHotspotsXML(a);else if("ANIMATIONDATA"==c)Z.Viewer&&Z.Viewer.parseImageSetXML(a,"animation");else if("GEODATA"==c)Z.Viewport&&Z.Viewport.parseGeoCoordinatesXML(a);else if("ANNOTATIONDATA"==c||"ZAS"==c||"Annotations"==c)if(null===Z.tileSourceMultiple||"undefined"===typeof b||null===b)Z.Viewport&&Z.Viewport.parseAnnotationsXML(a);else for(c=0,d=Z.imageSetLength;c<d;c++)b==c&&Z["Viewport"+c.toString()].parseAnnotationsXML(a,
b);else if("SLIDESTACKDATA"==c)Z.Viewer&&Z.Viewer.parseImageSetXML(a,"slidestack");else if("TRACKINGDATA"==c)if("undefined"===typeof b||null===b)Z.Viewport&&Z.Viewport.parseTrackingXML(a);else for(c=0,d=Z.imageSetLength;c<d;c++)b==c&&Z["Viewport"+c.toString()].parseTrackingXML(a,b);else Z.postingImage?Z.Utils.showMessage(Z.Utils.getResource("ERROR_SAVEIMAGEHANDLERPATHINVALID"),!0):Z.Utils.showMessage(Z.Utils.getResource("z296"),!0)}else Z.Utils.showMessage(Z.Utils.getResource("z293"),!0)}function B(b,
c,d,e,f,m){if(p<R)return p++,("ZoomifyZIFFile"==Z.tileSource||"ZoomifyPFFFile"==Z.tileSource&&null===Z.tileHandlerPathFull)&&("undefined"!==typeof f&&null!==f||"navigator"==d)?a(b,d,e,f,m):(c=Z.Utils.createCallback(null,C,c),(new x(b,c,d)).start()),!0;-1==Z.Utils.arrayIndexOfObjectValue(L,"sc",b)&&(L[L.length]={sc:b,cb:c,ct:e,t:f},K||(K=window.setInterval(function(){var a=L[0];B(a.sc,a.cb,"loadingImageFromQueue",a.ct,a.t)&&(L=Z.Utils.arraySplice(L,0,1));0==L.length&&K&&(window.clearInterval(K),K=
null)},ea)));return!1}function C(a,b,c){p--;if("function"===typeof a)try{a(c)}catch(d){Z.Utils.showMessage(d.name+Z.Utils.getResource("z245")+b+" "+d.message,!0)}}function x(a,b,c){function d(c){e.onload=null;e.onabort=null;e.onerror=null;f&&window.clearTimeout(f);window.setTimeout(function(){b(a,c?e:null)},1)}var e=null,f=null;this.start=function(){e=new Image;var b=function(){d(!1)};e.onload=function(){d(!0)};e.onabort=b;e.onerror=b;f=window.setTimeout(function(){console.log(Z.Utils.getResource("z253"));
d(!1);Z.Viewport.traceDebugValues("imageRequestTimeout",c+" timeout: "+a)},ma);e.src=a}}var p=0,R=parseInt(Z.Utils.getResource("z140"),10),ma=parseFloat(Z.Utils.getResource("z139")),ea=Z.Utils.getResource("DEFAULT_IMAGELOADQUEUEDELAY"),K,L=[];this.loadHTML=function(a,b,d,e){c(a,b,null,e)};this.loadHTMLToRenameIn=function(a,b,d,e,f,m){c(a,b,null,e,null,null,null,a,f,m)};this.loadXML=function(a,b,d){"undefined"===typeof b||null===b?c(a,f,null,d):c(a,function(a){f(a,b)},null,d)};this.loadFileList=function(a,
b,d,e){if(!Z.localUse&&"undefined"!==typeof b&&Z.Utils.stringValidate(b)){var m="undefined"!==typeof d&&Z.Utils.stringValidate(d)?"filePath="+d:"",p="undefined"!==typeof e&&Z.Utils.stringValidate(e)?"fileTypes="+e:"",t=""!=m&&""!=p?"&":"";c(a+(""!=m||""!=p?"?":"")+"accessType=list"+t+"filePath="+d+t+"fileTypes="+e,f,null,b)}};this.renameFile=function(a,b,d,e){"undefined"!==typeof d&&Z.Utils.stringValidate(d)&&"undefined"!==typeof e&&Z.Utils.stringValidate(e)&&c(a+"?accessType=rename&filePathOld="+
d+"&filePathNew="+e,f,null,b)};this.deleteFile=function(a,b,d){d="undefined"!==typeof d&&Z.Utils.stringValidate(d)?"filePath="+d:"";c(a+"?accessType=delete&"+d,f,null,b)};this.loadJSON=function(a,b,d){"undefined"===typeof b||null===b?c(a,f,null,d):c(a,function(a){f(a,b)},null,d)};this.loadByteRange=function(a,d,e,m,p,t,u,x){d=new Z.Utils.Range(d,e);Z.useLocalFile?b(a,x,d,m,p,t,u):c(a,function(a){f(a,x)},d,m,p,t,u)};this.postXML=function(a,b,d,e){if("undefined"!==typeof e&&Z.Utils.stringValidate(e)){var m=
Z.legacySaveHandlerInUse?"":"accessType=save";c(a+"?"+m+(""!=m?"&":"")+(Z.legacySaveHandlerInUse?"file="+e:"filePath="+e),f,b,d)}};this.postHTML=function(a,b,d){"undefined"!==typeof d&&Z.Utils.stringValidate(d)&&c(a+"?accessType=save&"+("filePath="+d),f,b,"postingHTML")};this.postImage=function(a,b){c(a,f,b,"postingImage")};this.postFile=function(a,b,d,e){"undefined"!==typeof d&&Z.Utils.stringValidate(d)&&c(a+"?accessType=save&"+("filePath="+d),f,b,"postingFile-"+e)};this.loadImage=function(a,b,c,
d,e,f){B(a,b,c,d,e,f)}};
Z.Utils={addCrossBrowserMethods:function(){document.addEventListener?(this.disableTextInteraction=function(a){if(a){var b=a.parentNode.style;b&&(a.parentNode.unselectable="on",b.userSelect="none",b.MozUserSelect="none",b.webkitUserSelect="none",b.webkitTouchCallout="none",b.webkitTapHighlightColor="transparent")}},this.renderQuality=function(a,b){b&&a.style.setProperty("image-rendering","high"==b?"optimizeQuality":"optimizeSpeed",null)},this.setOpacity=function(a,b,c){Z.alphaSupported?a.style.opacity=
b:c&&(a.style.backgroundColor=c)}):document.attachEvent&&(this.disableTextInteraction=function(a){a&&(a.parentNode.unselectable="on",a.parentNode.onselectstart=function(){return!1})},this.renderQuality=function(a,b){b&&(a.style.msInterpolationMode="high"==b?"bicubic":"nearest-neighbor")},this.setOpacity=function(a,b,c){Z.alphaSupported?(b*=100,a.style.zoom=1,a.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity="+b+")",a.style.filter="alpha(opacity="+b+")",100==b&&(a.style.filter="")):c&&
(a.style.backgroundColor=c)})},addCrossBrowserEvents:function(){document.addEventListener?(this.addEventListener=function(a,b,c){a&&("mousewheel"==b&&a.addEventListener("DOMMouseScroll",c,!1),a.addEventListener(b,c,!1))},this.removeEventListener=function(a,b,c){a&&("mousewheel"==b&&a.removeEventListener("DOMMouseScroll",c,!1),a.removeEventListener(b,c,!1))},this.event=function(a){return a},this.target=function(a){return a.target},this.relatedTarget=function(a){return a.relatedTarget},this.isRightMouseButton=
function(a){var b=!1;if(2==a.which||3==a.which)b=!0;return b},this.preventDefault=function(a){a.preventDefault()},this.stopPropagation=function(a){a.stopPropagation()}):document.attachEvent&&(this.addEventListener=function(a,b,c){if(-1==this._findListener(a,b,c)){var d=function(){var b=window.event;Function.prototype.call?c.call(a,b):(a._currentListener=c,a._currentListener(b),a._currentListener=null)};a.attachEvent("on"+b,d);b={target:a,eventName:b,handler:c,handler2:d};var d=(a.document||a).parentWindow,
e="l"+this._listenerCounter++;d._allListeners||(d._allListeners={});d._allListeners[e]=b;a._listeners||(a._listeners=[]);a._listeners[a._listeners.length]=e;d._unloadListenerAdded||(d._unloadListenerAdded=!0,d.attachEvent("onunload",this._removeAllListeners))}},this.removeEventListener=function(a,b,c){if(a&&(c=this._findListener(a,b,c),-1!=c)){var d=(a.document||a).parentWindow,e=a._listeners[c];a.detachEvent("on"+b,d._allListeners[e].handler2);a._listeners=Z.Utils.arraySplice(a._listeners,c,1);delete d._allListeners[e]}},
this.event=function(a){return window.event},this.target=function(a){return a.srcElement},this.relatedTarget=function(a){var b=null;"mouseover"==a.type?b=a.fromElement:"mouseout"==a.type&&(b=a.toElement);return b},this.isRightMouseButton=function(a){var b=!1;2==a.button&&(b=!0);return b},this.preventDefault=function(a){a&&(a.returnValue=!1)},this.stopPropagation=function(a){a.cancelBubble=!0},this._findListener=function(a,b,c){var d=a._listeners;if(!d)return-1;a=(a.document||a).parentWindow;for(var e=
d.length-1;0<=e;e--){var f=a._allListeners[d[e]];if(f&&f.eventName==b&&f.handler==c)return e}return-1},this._removeAllListeners=function(){for(id in this._allListeners){var a=this._allListeners[id];a.target.detachEvent("on"+a.eventName,a.handler2);delete this._allListeners[id]}},this._listenerCounter=0)},declareGlobals:function(){Z.pageContainerID=null;Z.pageContainer=null;Z.imagePath=null;Z.usingDirectoryExtensions=null;Z.imageFilename=null;Z.imagePath2=null;Z.imageMetadataXML=null;Z.parameters=
null;Z.xmlParametersPath=null;Z.xMLParametersPath=null;Z.xmlParametersParsing=null;Z.xMLParametersParsing=null;Z.skinPath=null;Z.skinMode=null;Z.cacheProofCounter=0;Z.timerCounter=0;Z.platform=null;Z.browsers=null;Z.browser=null;Z.browserVersion=null;Z.scaleThreshold=null;Z.canvasSupported=null;Z.cssTransformsSupported=null;Z.cssTransformProperty=null;Z.cssTransformNoUnits=null;Z.alphaSupported=null;Z.renderQuality=null;Z.ellipseDrawingSupported=null;Z.rotationSupported=null;Z.fullScreenSupported=
null;Z.arrayMapSupported=null;Z.arraySpliceSupported=null;Z.float32ArraySupported=null;Z.uInt8ArraySupported=null;Z.localFilesSupported=null;Z.useLocalFile=null;Z.localFile=null;Z.xmlHttpRequestSupport=null;Z.definePropertySupported=null;Z.responseArraySupported=null;Z.responseArrayPrototyped=!1;Z.definedObjectPropertiesArr=[];Z.touchSupport=null;Z.gestureSupport=null;Z.mobileDevice=null;Z.localUse=null;Z.singleFileSupported=null;Z.onReady=null;Z.onAnnotationReady=null;Z.initialX=null;Z.initialY=
null;Z.initialZ=null;Z.initialZoom=null;Z.minZ=null;Z.minZoom=null;Z.maxZ=null;Z.maxZoom=null;Z.zoomSpeed=null;Z.panSpeed=null;Z.smoothPan=null;Z.smoothPanEasing=null;Z.smoothZoom=null;Z.smoothZoomEasing=null;Z.smoothPanGlide=null;Z.autoResize=null;Z.fadeIn=null;Z.fadeInSpeed=null;Z.toolbarInternal=null;Z.toolbarVisible=null;Z.toolbarBackgroundVisible=null;Z.toolbarAutoShowHide=null;Z.toolbarW=null;Z.toolbarH=null;Z.toolbarPosition=null;Z.navigatorVisible=null;Z.navigatorW=null;Z.navigatorWidth=null;
Z.navigatorH=null;Z.navigatorHeight=null;Z.navigatorL=null;Z.navigatorLeft=null;Z.navigatorT=null;Z.navigatorTop=null;Z.navigatorFit=null;Z.navigatorRectangleColor=null;Z.GalleryScrollPanel=null;Z.galleryVisible=null;Z.galleryM=null;Z.galleryAutoShowHide=null;Z.galleryW=null;Z.galleryWidth=null;Z.galleryH=null;Z.galleryHeight=null;Z.galleryL=null;Z.galleryT=null;Z.galleryPosition=null;Z.galleryRectangleColor=null;Z.mouseIsDownGallery=null;Z.clickZoom=null;Z.doubleClickZoom=null;Z.doubleClickDelay=
null;Z.clickPan=null;Z.zoomAndPanInProgressID=null;Z.clickZoomAndPanBlock=!1;Z.mousePan=null;Z.keys=null;Z.constrainPan=null;Z.constrainPanLimit=null;Z.constrainPanStrict=null;Z.panBuffer=null;Z.tooltipsVisible=null;Z.helpVisible=null;Z.helpPath=null;Z.helpCustom=!1;Z.helpContent=null;Z.helpW=null;Z.helpWidth=null;Z.helpH=null;Z.helpHeight=null;Z.helpL=null;Z.helpLeft=null;Z.helpT=null;Z.helpTop=null;Z.minimizeVisible=null;Z.sliderZoomVisible=null;Z.sliderVisible=null;Z.zoomButtonsVisible=null;Z.panButtonsVisible=
null;Z.resetVisible=null;Z.fullViewVisible=null;Z.fullScreenVisible=null;Z.fullPageVisible=null;Z.initialFullPage=null;Z.fullPageInitial=null;Z.fullScreenEntering=null;Z.progressVisible=null;Z.messagesVisible=null;Z.logoVisible=null;Z.logoLink=null;Z.logoLinkURL=null;Z.logoCustomPath=null;Z.bookmarksGet=null;Z.bookmarksSet=null;Z.copyrightPath=null;Z.watermarkPath=null;Z.watermarks=null;Z.virtualPointerVisible=null;Z.virtualPointerPath=null;Z.crosshairsVisible=null;Z.zoomRectangle=null;Z.rulerVisible=
null;Z.units=null;Z.unitsPerImage=null;Z.pixelsPerUnit=null;Z.sourceMagnification=null;Z.magnification=null;Z.rulerListType=null;Z.rulerW=null;Z.rulerWidth=null;Z.rulerH=null;Z.rulerHeight=null;Z.rulerL=null;Z.rulerLeft=null;Z.rulerT=null;Z.rulerTop=null;Z.measureVisible=!1;Z.rotationVisible=null;Z.rotationFree=null;Z.initialR=null;Z.initialRotation=null;Z.imageListPath=null;Z.imageList=null;Z.imageListTitle=null;Z.imageListFolder=null;Z.imageListFileShared=!1;Z.imageSetImageListPath=null;Z.imageListTimeout=
null;Z.screensaver=!1;Z.screensaverSpeed=null;Z.tour=!1;Z.tourPath=null;Z.tourListTitle=null;Z.tourPlaying=null;Z.tourStop=!1;Z.comparison=!1;Z.comparisonPath=null;Z.syncVisible=null;Z.initialSync=null;Z.syncComparison=null;Z.slideshow=!1;Z.slidePath=null;Z.slideListTitle=null;Z.slideButtonsVisible=null;Z.slideshowPlaying=null;Z.slideshowStopping=null;Z.slideTransitionTimeout=null;Z.slideTransitionSpeed=null;Z.slideOpacity=0;Z.audioContent=!1;Z.audioMuted=!1;Z.audioPlaying=null;Z.audioStopped=null;
Z.hotspots=!1;Z.hotspotPath=null;Z.hotspotFolder=null;Z.hotspotListTitle=null;Z.hotspotsDrawOnlyInView=!0;Z.captionBoxes=!1;Z.captionsColorsDefault=!0;Z.captionOffset=null;Z.maskVisible=null;Z.maskScale=null;Z.maskBorder=null;Z.maskingSelection=!1;Z.maskFadeTimeout=null;Z.maskFadeSpeed=null;Z.maskOpacity=0;Z.maskClearOnUserAction=null;Z.annotations=!1;Z.annotationPath=null;Z.annotationFolder=null;Z.annotationXMLText=null;Z.labelShapesInternal=null;Z.annotationJSONObject=null;Z.annotationsAddMultiple=
null;Z.annotationsAutoSave=null;Z.annotationsAutoSaveImage=null;Z.annotationPanelVisible=null;Z.annotationPanelVisibleState=!1;Z.clickURLEntryVisible=null;Z.saveButtonVisible=null;Z.labelClickSelect=null;Z.labelHighlight=null;Z.simplePath=!1;Z.noPost=!1;Z.noPostDefaults=!0;Z.unsavedEditsTest=!0;Z.externalEditPermissionFunction=null;Z.annotationSort="none";Z.annotationXMLAperioLoad=null;Z.annotationXMLAperioPost=null;Z.fileHandlerPath=null;Z.fileHandlerProvided=!1;Z.saveHandlerPath=null;Z.saveImageHandlerPath=
null;Z.saveImageFull=null;Z.postingXML=!1;Z.postingHTML=!1;Z.postingImage=!1;Z.postingFile=!1;Z.magnifierVisible=null;Z.magnifierW=null;Z.magnifierH=null;Z.magnifierL=null;Z.magnifierT=null;Z.narrativePath=null;Z.narrativeFolderPath=null;Z.narrativeImageFolderPath=null;Z.narrativeMediaFolderPath=null;Z.narrativeAnnotationFolderPath=null;Z.narrative=null;Z.narrativeMode=null;Z.narrativeW=0;Z.narrativeImageListTitle=null;Z.narrativePathProvided=!1;Z.narrativeHelpPath=null;Z.narrativeHelpContent=null;
Z.narrativeText=null;Z.narrativeTextPrior=null;Z.annotationFileList=null;Z.coordinatesVisible=null;Z.geoCoordinatesPath=null;Z.geoCoordinatesVisible=null;Z.geoCoordinatesFolder=null;Z.preloadVisible=null;Z.imageFilters=null;Z.imageFiltersVisible=null;Z.initialImageFilters=null;Z.brightnessVisible=null;Z.contrastVisible=null;Z.sharpnessVisible=null;Z.blurrinessVisible=null;Z.colorRedVisible=null;Z.colorGreenVisible=null;Z.colorBlueVisible=null;Z.colorRedRangeVisible=null;Z.colorGreenRangeVisible=null;
Z.colorBlueRangeVisible=null;Z.gammaVisible=null;Z.gammaRedVisible=null;Z.gammaGreenVisible=null;Z.gammaBlueVisible=null;Z.hueVisible=null;Z.saturationVisible=null;Z.lightnessVisible=null;Z.whiteBalanceVisible=null;Z.normalizeVisible=null;Z.equalizeVisible=null;Z.noiseVisible=null;Z.grayscaleVisible=null;Z.thresholdVisible=null;Z.inversionVisible=null;Z.edgesVisible=null;Z.sepiaVisible=null;Z.saveImageFull=null;Z.saveImageFilename=null;Z.saveImageFormat=null;Z.saveImageCompression=null;Z.saveImageBackColor=
null;Z.tracking=!1;Z.trackingPath=null;Z.trackingFolder=null;Z.trackingPathProvided=!1;Z.trackingEditMode=!1;Z.trackingFileShared=!1;Z.imageSetTrackingPath=null;Z.trackingPanelPosition=null;Z.trackingCounts=[];Z.trackingTypeCurrent="0";Z.trackingOverlayVisible=!1;Z.initialTrackingOverlayVisible=null;Z.trackingCellCurrent=null;Z.trackingPanelVisible=null;Z.trackingPanelVisibleState=!1;Z.userName=null;Z.userInitials=null;Z.userLogin=null;Z.userNamePrompt=null;Z.userNamePromptRetry=null;Z.userPath=null;
Z.userFolder=null;Z.userPathProvided=!1;Z.userList=[];Z.userLogging=!1;Z.UserPanel=null;Z.userPanelVisible=null;Z.userPanelPosition=0;Z.userPanelVisibleState=!1;Z.canvas=null;Z.baseZIndex=null;Z.debug=null;Z.hideOverlayBackfill=null;Z.imageProperties=null;Z.serverIP=null;Z.serverPort=null;Z.tileHandlerPath=null;Z.tileHandlerPathFull=null;Z.iiifInfoJSONObject=null;Z.iiifScheme=null;Z.iIIFScheme=null;Z.iiifServer=null;Z.iIIFServer=null;Z.iiifPrefix=null;Z.iIIFPrefix=null;Z.iiifIdentifier=null;Z.iIIFIdentifier=
null;Z.iiifRegion=null;Z.iIIFRegion=null;Z.iiifSize=null;Z.iIIFSize=null;Z.iiifRotation=null;Z.iIIFRotation=null;Z.iiifQuality=null;Z.iIIFQuality=null;Z.iiifFormat=null;Z.iIIFFormat=null;Z.tileW=null;Z.tileH=null;Z.tileType="jpg";Z.tilesPNG=null;Z.fieldOfViewVisible=null;Z.freehandVisible=null;Z.textVisible=null;Z.shapeVisible=null;Z.rectangleVisible=null;Z.polygonVisible=null;Z.captionTextColor=null;Z.captionBackColor=null;Z.labelLineColor=null;Z.labelFillColor=null;Z.captionTextVisible=!0;Z.captionBackVisible=
!0;Z.labelFillVisible=!1;Z.labelLineVisible=!0;Z.captionPosition=null;Z.annotationPathProvided=!1;Z.saveHandlerProvided=!1;Z.fileHandlerProvided=!1;Z.imageSetPathProvided=!1;Z.slidePathProvided=!1;Z.saveImageHandlerProvided=!1;Z.tileSource=null;Z.requestTiles=!1;Z.tileSourceMultiple=null;Z.pffJPEGHeadersSeparate=!1;Z.dziSubfoldersToSkip=null;Z.dziImagePropertiesFilename=null;Z.dziImageSubfolder=null;Z.focal=null;Z.quality=null;Z.markupMode=null;Z.editMode=null;Z.editAdmin=!1;Z.editing=null;Z.labelMode=
"view";Z.editModePrior=Z.editMode;Z.xmlCallbackFunction=null;Z.labelClickDrag=!0;Z.sliderFocus="zoom";Z.overlayPath=null;Z.overlays=!1;Z.overlayJSONObject=null;Z.overlaysInitialVisibility=null;Z.animation=!1;Z.animationPath=null;Z.animationCount=0;Z.animationAxis=null;Z.animator=null;Z.animationFlip=null;Z.slidestack=!1;Z.slidestackPath=null;Z.imageSet=!1;Z.imageSetPath=null;Z.imageSetLength=null;Z.imageSetListPosition=null;Z.imageSetListTitle=null;Z.imageSetStart=null;Z.imageSetLoop=null;Z.sliderImageSetVisible=
null;Z.mouseWheelParmeterProvided=null;Z.mouseWheel=null;Z.imageSetHotspotPath=null;Z.hotspotFileShared=!1;Z.imageSetAnnotationPath=null;Z.annotationFileShared=!1;Z.messageDurationLong=parseInt(Z.Utils.getResource("DEFAULT_MESSAGEDURATIONLONG"),10);Z.messageDurationStandard=parseInt(Z.Utils.getResource("DEFAULT_MESSAGEDURATIONSTANDARD"),10);Z.messageDurationShort=parseInt(Z.Utils.getResource("DEFAULT_MESSAGEDURATIONSHORT"),10);Z.messageDurationVeryShort=parseInt(Z.Utils.getResource("DEFAULT_MESSAGEDURATIONVERYSHORT"),
10);Z.Viewer=null;Z.ViewerDisplay=null;Z.Viewport=null;Z.Toolbar=null;Z.ToolbarDisplay=null;Z.ToolbarMinimized=!1;Z.TooltipDisplay=null;Z.Navigator=null;Z.Navigator2=null;Z.NavigatorDisplay=null;Z.MessageDisplay=null;Z.messages=null;Z.messageDisplayList=[];Z.overlayMessage=null;Z.CoordinatesDisplay=null;Z.coordinates=null;Z.coordinatesSave=null;Z.CopyrightDisplay=null;Z.imageW=null;Z.imageH=null;Z.imageD=null;Z.imageCtrX=null;Z.imageCtrY=null;Z.imageX=0;Z.imageY=0;Z.imageZ=0;Z.imageR=0;Z.priorX=0;
Z.priorY=0;Z.priorZ=0;Z.priorR=0;Z.preventDupCall=!1;Z.fitZ=null;Z.fillZ=null;Z.zooming="stop";Z.panningX="stop";Z.panningY="stop";Z.rotating="stop";Z.fullView=!1;Z.fullViewPrior=!1;Z.interactive=!0;Z.useCanvas=!0;Z.expressParamsEnabled=null;Z.proParamsEnabled=null;Z.specialStorageEnabled=null;Z.enterpriseParamsEnabled=null;Z.updateViewPercent=0;Z.TraceDisplay=null;Z.traces=null;Z.mouseIsDown=!1;Z.buttonIsDown=!1;Z.keyIsDown=!1;Z.altKeyIsDown=!1;Z.mouseWheelIsDown=!1;Z.mouseWheelCompleteDuration=
null;Z.mouseWheelCompleteTimer=null;Z.mouseOutDownPoint=null;maxTileB=maxTileR=maxTier=0;Z.viewportCurrentID=0;Z.viewportCurrent=null;Z.viewportChangeTimeout=null},detectBrowserFeatures:function(){var a=window.navigator.userAgent,a=-1!=a.indexOf("Win")?"windows":-1!=a.indexOf("Mac")?"macintosh":"other";Z.browsers={UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5,EDGE:6};var b=Z.browsers.UNKNOWN,c=0,d=1E4,e=navigator.appName,f=navigator.appVersion,m=!1,u=!1,t=navigator.userAgent.toLowerCase();if(-1!=
t.indexOf("edge"))b=Z.browsers.EDGE,c=f;else if("Microsoft Internet Explorer"==e&&window.attachEvent&&window.ActiveXObject)c=t.indexOf("msie"),b=Z.browsers.IE,c=parseFloat(t.substring(c+5,t.indexOf(";",c))),m="undefined"!==typeof document.documentMode;else if("Netscape"==e&&-1!=t.indexOf("trident"))b=Z.browsers.IE,c=11;else if("Netscape"==e&&window.addEventListener){var B=t.indexOf("firefox"),e=t.indexOf("safari"),f=t.indexOf("chrome");0<=B?(b=Z.browsers.FIREFOX,c=parseFloat(t.substring(B+8)),d=1E4):
0<=e&&(d=t.substring(0,e).lastIndexOf("/"),b=0<=f?Z.browsers.CHROME:Z.browsers.SAFARI,c=parseFloat(t.substring(d+1,e)),d=1E4);e=new Image;e.style.getPropertyValue&&(u=e.style.getPropertyValue("image-rendering"))}else"Opera"==e&&window.opera&&"[object Opera]"==Object.prototype.toString.call(window.opera)&&(b=Z.browsers.OPERA,c=parseFloat(f));var e=window.File&&window.FileReader&&window.Blob,C;if(window.XMLHttpRequest)netReq=new XMLHttpRequest,C="XMLHttpRequest";else if(window.ActiveXObject)for(var f=
["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"],B=0,x=f.length;B<x;B++)try{netReq=new ActiveXObject(f[B]);C=f[B];break}catch(p){}var f="response"in XMLHttpRequest.prototype||"mozResponseArrayBuffer"in XMLHttpRequest.prototype||"mozResponse"in XMLHttpRequest.prototype||"responseArrayBuffer"in XMLHttpRequest.prototype,R=document.createElement("canvas"),B=!(!R.getContext||!R.getContext("2d")),x=!(b==Z.browsers.SAFARI&&4>c||b==Z.browsers.CHROME&&2>c),B=B&&x,x=!(b==Z.browsers.CHROME&&2>
c),u=m||u?"high":null,m=B&&!!R.getContext("2d").ellipse,ma=(document.documentElement||{}).style||{},R=!1,ea=["transform","WebkitTransform","MozTransform","OTransform","msTransform"],K,L;for(;K=ea.shift();)if("undefined"!==typeof ma[K]){R=!0;L=/webkit/i.test(K);break}var ma=R,ea="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints,n=-1<t.indexOf("iphone")||-1<t.indexOf("ipad")||-1<t.indexOf("ipod"),t=-1<t.indexOf("android")||
n,A=!1;if("undefined"!==typeof document.cancelFullScreen||"undefined"!==typeof document.webkitCancelFullScreen||"undefined"!==typeof document.mozCancelFullScreen||"undefined"!==typeof document.oCancelFullScreen||"undefined"!==typeof document.msCancelFullScreen||"undefined"!==typeof document.msExitFullscreen)A=!0;var l=Array.prototype.map,v=Array.prototype.splice,aa=!1;try{new Float32Array(1),aa=!0}catch(p){}var G=!1;try{new Uint8Array(1),G=!0}catch(p){}var I=!1;if("function"==typeof Object.defineProperty)try{Object.defineProperty({},
"x",{}),I=!0}catch(p){}var T;switch(window.location.protocol){case "http:":T=!1;break;case "https:":T=!1;break;case "file:":T=!0;break;default:T=null}var ja=!(Z.browser==Z.browsers.IE&&9>Z.browserVersion||Z.browser==Z.browsers.OPERA&&15>Z.browserVersion||Z.browser==Z.browsers.CHROME&&25>Z.browserVersion&&Z.browser==Z.browsers.FIREFOX&&20>Z.browserVersion&&Z.browser==Z.browsers.SAFARI&&5>Z.browserVersion);Z.platform=a;Z.browser=b;Z.browserVersion=c;Z.scaleThreshold=d;Z.localFilesSupported=e;Z.xmlHttpRequestSupport=
C;Z.responseArraySupported=f;Z.canvasSupported=B;Z.useCanvas=Z.canvasSupported;Z.imageFilters=!Z.useCanvas&&Z.imageFilters?!1:Z.imageFilters;Z.cssTransformsSupported=R;Z.cssTransformProperty=K;Z.cssTransformNoUnits=L;Z.alphaSupported=x;Z.renderQuality=u;Z.ellipseDrawingSupported=m;Z.rotationSupported=ma;Z.fullScreenSupported=A;Z.arrayMapSupported=l;Z.arraySpliceSupported=v;Z.float32ArraySupported=aa;Z.uInt8ArraySupported=G;Z.definePropertySupported=I;Z.touchSupport=ea;Z.gestureSupport=n&&ea;Z.mobileDevice=
t;Z.localUse=T;Z.singleFileSupported=ja},parseParametersXML:function(a){Z.xmlParametersParsing=!1;var b="";a=a.getElementsByTagName("ZOOMIFY")[0];zImagePath=a.getAttribute("IMAGEPATH");zImagePath2=a.getAttribute("IMAGEPATH2");"undefined"!==typeof zImagePath&&Z.Utils.stringValidate(zImagePath)&&(Z.imagePath=zImagePath);"undefined"!==typeof zImagePath2&&Z.Utils.stringValidate(zImagePath2)&&(Z.imagePath2=zImagePath2);for(var c=Z.Utils.getResource("DEFAULT_PARAMETERLISTTEXT").split(","),d=0,e=c.length;d<
e;d++){var f=c[d],m=Z.Utils.stringLowerCaseFirstLetter(f.substr(1)).toUpperCase(),m=a.getAttribute(m);"undefined"!==typeof m&&Z.Utils.stringValidate(m)&&(b+=f+"="+m+"&")}c=a.getAttribute("FULLPAGEINITIAL");"undefined"!==typeof c&&Z.Utils.stringValidate(c)&&(b+="zInitialFullPage="+c+"&");c=a.getAttribute("TOOLBARSKINXMLPATH");"undefined"!==typeof c&&Z.Utils.stringValidate(c)&&(b+="zSkinPath="+c+"&");c=a.getAttribute("TOOLBARTOOLTIPS");"undefined"!==typeof c&&Z.Utils.stringValidate(c)&&(b+="zTooltipsVisible="+
c+"&");c=a.getAttribute("SHOWTOOLTIPS");"undefined"!==typeof c&&Z.Utils.stringValidate(c)&&(b+="zTooltipsVisible="+c+"&");c=a.getAttribute("WATERMARKMEDIA");"undefined"!==typeof c&&Z.Utils.stringValidate(c)&&(b+="zWatermarkPath="+c+"&");c=a.getAttribute("SLIDESXMLPATH");"undefined"!==typeof c&&Z.Utils.stringValidate(c)&&(b+="zSlidePath="+c+"&");c=a.getAttribute("HOTSPOTSXMLPATH");"undefined"!==typeof c&&Z.Utils.stringValidate(c)&&(b+="zHotspotPath="+c+"&");c=a.getAttribute("ANNOTATIONSXMLPATH");"undefined"!==
typeof c&&Z.Utils.stringValidate(c)&&(b+="zAnnotationPath="+c+"&");c=a.getAttribute("SAVETOFILE");"undefined"!==typeof c&&Z.Utils.stringValidate(c)&&(b+="zSaveImageHandlerPath="+c+"&");b="&"==b.slice(-1,b.length)?b.slice(0,b.length-1):b;b=unescape(b);b=Z.Utils.stringUnescapeAmpersandCharacters(b);Z.Utils.arrayClear(Z.parameters);Z.parameters=Z.Utils.parseParameters(b);Z.initialize()},parseParameters:function(a){var b=[];if("object"===typeof a)b=a;else if("string"===typeof a){a=a.split("&");for(var c=
0,d=a.length;c<d;c++){var e=a[c],f=e.indexOf("=");if(0<f){var m=e.substring(0,f),e=e.substring(f+1);b[m]=e}}}return b},parametersToDelimitedString:function(a,b){var c="",d;for(d in a)c+=d+"="+a[d].toString()+b;return c=c.slice(0,-1)},setParameters:function(a){var b=this.getResource("z110"),c=this.getResource("z109"),d=this.getResource("z108");Z.expressParamsEnabled=b!=c?!0:!1;Z.expressParamsEnabled||(Z.toolbarInternal=!0);b=this.getResource("z187");c=this.getResource("z186");this.getResource("z185");
Z.proParamsEnabled=b!=c?!0:!1;b=this.getResource("z215");c=this.getResource("z214");this.getResource("z213");Z.specialStorageEnabled=b!=c?!0:!1;b=this.getResource("z107");c=this.getResource("z106");this.getResource("z105");Z.enterpriseParamsEnabled=b!=c?!0:!1;null===Z.skinPath&&(Z.skinPath=this.getResource("z201"));null===Z.skinMode&&(Z.skinMode=this.getResource("z199"));isNaN(parseFloat(this.getResource("z143")))||(Z.initialX=parseFloat(this.getResource("z143")));isNaN(parseFloat(this.getResource("z144")))||
(Z.initialY=parseFloat(this.getResource("z144")));isNaN(parseFloat(this.getResource("z145")))||(Z.initialZ=parseFloat(this.getResource("z145")));null!==Z.minZ||isNaN(parseFloat(this.getResource("z163")))||(Z.minZ=parseFloat(this.getResource("z163")));null!==Z.maxZ||isNaN(parseFloat(this.getResource("z153")))||(Z.maxZ=parseFloat(this.getResource("z153")));null!==Z.zoomSpeed||isNaN(parseFloat(this.getResource("z241")))||(Z.zoomSpeed=parseFloat(this.getResource("z241")));null!==Z.panSpeed||isNaN(parseFloat(this.getResource("z175")))||
(Z.panSpeed=parseFloat(this.getResource("z175")));null!==Z.fadeInSpeed||isNaN(parseFloat(this.getResource("z111")))||(Z.fadeInSpeed=parseFloat(this.getResource("z111")));Z.fadeIn=0<Z.fadeInSpeed;null===Z.navigatorVisible&&(Z.navigatorVisible=parseInt(this.getResource("z171"),10));null===Z.navigatorW&&(Z.navigatorW=parseInt(this.getResource("z172"),10));null===Z.navigatorH&&(Z.navigatorH=parseInt(this.getResource("z167"),10));null===Z.navigatorL&&(Z.navigatorL=parseInt(this.getResource("z168"),10));
null===Z.navigatorT&&(Z.navigatorT=parseInt(this.getResource("z170"),10));null===Z.navigatorFit&&(Z.navigatorFit=this.getResource("z166"));null===Z.navigatorRectangleColor&&(Z.navigatorRectangleColor=this.getResource("z169"));if(null===Z.galleryVisible||Z.slideshow)Z.galleryVisible=parseInt(this.getResource("DEFAULT_GALLERYVISIBLE"),10);if(null===Z.galleryAutoShowHide||Z.slideshow)Z.galleryAutoShowHide=2==Z.galleryVisible;null===Z.galleryW&&(Z.galleryW=parseInt(this.getResource("DEFAULT_GALLERYWIDTH"),
10));null===Z.galleryH&&(Z.galleryH=parseInt(this.getResource("DEFAULT_GALLERYHEIGHT"),10));null===Z.galleryM&&(Z.galleryM=parseInt(this.getResource("DEFAULT_GALLERYMARGIN"),10));null===Z.galleryL&&(Z.galleryL=parseInt(this.getResource("DEFAULT_GALLERYLEFT"),10));null===Z.galleryT&&(Z.galleryT=parseInt(this.getResource("DEFAULT_GALLERYTOP"),10));null===Z.galleryPosition&&(Z.galleryPosition=parseFloat(this.getResource("DEFAULT_GALLERYPOSITION")));null===Z.galleryRectangleColor&&(Z.galleryRectangleColor=
this.getResource("DEFAULT_GALLERYRECTANGLECOLO R"));null===Z.clickZoom&&(Z.clickZoom="0"!=this.getResource("z93"));null===Z.doubleClickZoom&&(Z.doubleClickZoom="0"!=this.getResource("DEFAULT_DOUBLECLICKZOOM"));null===Z.doubleClickDelay&&(Z.doubleClickDelay=parseFloat(this.getResource("DEFAULT_DOUBLECLICKDELAY")));null===Z.clickPan&&(Z.clickPan="0"!=this.getResource("z92"));null===Z.mousePan&&(Z.mousePan="0"!=this.getResource("z164"));null===Z.constrainPan&&(Z.constrainPan="0"!=this.getResource("z95"));
null===Z.constrainPanLimit&&(Z.constrainPanLimit=parseInt(this.getResource("z95LIMIT"),10));null===Z.constrainPanStrict&&(Z.constrainPanStrict="0"!=this.getResource("z95STRICT"));null===Z.panBuffer&&(Z.panBuffer=parseFloat(this.getResource("z173")));null===Z.smoothPan&&(Z.smoothPan=Z.useCanvas&&!Z.comparison&&"0"!=this.getResource("DEFAULT_SMOOTHPAN"));null===Z.smoothPanEasing&&(Z.smoothPanEasing=parseInt(this.getResource("DEFAULT_SMOOTHPANEASING"),10));null===Z.smoothPanGlide&&(Z.smoothPanGlide=
parseInt(this.getResource("DEFAULT_SMOOTHPANGLIDE"),10));null===Z.smoothZoom&&(Z.smoothZoom="0"!=this.getResource("DEFAULT_SMOOTHZOOM"));null===Z.smoothZoomEasing&&(Z.smoothZoomEasing=parseInt(this.getResource("DEFAULT_SMOOTHZOOMEASING"),10));null===Z.keys&&(Z.keys="0"!=this.getResource("z146"));null===Z.canvas&&(Z.canvas="0"!=this.getResource("z88"));null===Z.baseZIndex&&(Z.baseZIndex=parseInt(this.getResource("DEFAULT_BASEZINDEX"),10));null===Z.debug&&(Z.debug=parseInt(this.getResource("z104"),
10));null===Z.toolbarVisible&&(Z.toolbarVisible=parseInt(this.getResource("z223"),10));null===Z.toolbarBackgroundVisible&&(Z.toolbarBackgroundVisible=parseInt(this.getResource("DEFAULT_TOOLBARBACKGROUNDVISIBLE"),10));null===Z.toolbarAutoShowHide&&(Z.toolbarAutoShowHide=0!=Z.toolbarVisible&&1!=Z.toolbarVisible&&6!=Z.toolbarVisible&&7!=Z.toolbarVisible&&8!=Z.toolbarVisible);null===Z.toolbarPosition&&(Z.toolbarPosition=parseFloat(this.getResource("z222")));null===Z.logoVisible&&(Z.logoVisible="0"!=this.getResource("z150"));
null===Z.logoCustomPath&&(Z.logoCustomPath=this.getResource("z149"));null===Z.minimizeVisible&&(Z.minimizeVisible="0"!=this.getResource("z162"));null===Z.sliderZoomVisible&&(Z.sliderZoomVisible="0"!=this.getResource("DEFAULT_SLIDERZOOMVISIBLE"));null===Z.mouseWheel&&(Z.mouseWheel=parseInt(this.getResource("DEFAULT_MOUSEWHEEL"),10));null===Z.zoomButtonsVisible&&(Z.zoomButtonsVisible="0"!=this.getResource("DEFAULT_ZOOMBUTTONSVISIBLE"));null===Z.panButtonsVisible&&(Z.panButtonsVisible="0"!=this.getResource("z174"));
null===Z.resetVisible&&(Z.resetVisible="0"!=this.getResource("DEFAULT_RESETVISIBLE"));null===Z.tooltipsVisible&&(Z.tooltipsVisible="0"!=this.getResource("z224"));null===Z.helpVisible&&(Z.helpVisible=parseInt(this.getResource("z128"),10));null===Z.helpW&&(Z.helpW=parseInt(this.getResource("z422"),10));null===Z.helpH&&(Z.helpH=parseInt(this.getResource("z421"),10));null===Z.progressVisible&&(Z.progressVisible="0"!=this.getResource("z184"));null===Z.messagesVisible&&(Z.messagesVisible="0"!=this.getResource("DEFAULT_MESSAGESVISIBLE"));
null===Z.fullViewVisible&&(Z.fullViewVisible="0"!=this.getResource("z121"));null===Z.fullScreenVisible&&(Z.fullScreenVisible="0"!=this.getResource("z119"));null===Z.fullPageVisible&&(Z.fullPageVisible="0"!=this.getResource("z118"));null===Z.initialFullPage&&(Z.initialFullPage="0"!=this.getResource("z141"));null===Z.bookmarksGet&&(Z.bookmarksGet="0"!=this.getResource("DEFAULT_BOOKMARKSGET"));null===Z.bookmarksSet&&(Z.bookmarksSet="0"!=this.getResource("DEFAULT_BOOKMARKSSET"));!0!==Z.measureVisible&&
(Z.measureVisible="0"!=this.getResource("z157"));null===Z.rotationVisible&&(Z.rotationVisible="0"!=this.getResource("z190"));null===Z.rotationFree&&(Z.rotationFree="0"!=this.getResource("DEFAULT_ROTATIONFREE"));null===Z.initialR&&(Z.initialR=this.getResource("DEFAULT_INITIALR"));null!==Z.screensaverSpeed||isNaN(parseFloat(this.getResource("DEFAULT_SCREENSAVERSPEED")))||(Z.screensaverSpeed=parseFloat(this.getResource("DEFAULT_SCREENSAVERSPEED")));null!==Z.maskScale||isNaN(parseFloat(this.getResource("DEFAULT_MASKSCALE")))||
(Z.maskScale=parseFloat(this.getResource("DEFAULT_MASKSCALE")));null!==Z.maskFadeSpeed||isNaN(parseFloat(this.getResource("DEFAULT_MASKFADESPEED")))||(Z.maskFadeSpeed=parseFloat(this.getResource("DEFAULT_MASKFADESPEED")));null===Z.maskClearOnUserAction&&(Z.maskClearOnUserAction="0"!=this.getResource("DEFAULT_MASKCLEARONUSERACTION"));null===Z.units&&(Z.units=this.getResource("z231"));null===Z.sourceMagnification&&(Z.sourceMagnification=parseInt(this.getResource("z212"),10));null===Z.virtualPointerVisible&&
(Z.virtualPointerVisible="0"!=this.getResource("z233"));null===Z.virtualPointerPath&&(Z.virtualPointerPath=this.getResource("z232"));null===Z.crosshairsVisible&&(Z.crosshairsVisible="0"!=this.getResource("z103"));null===Z.zoomRectangle&&(Z.zoomRectangle="0"!=this.getResource("DEFAULT_ZOOMRECTANGLE"));null===Z.rulerVisible&&(Z.rulerVisible=parseInt(this.getResource("z196"),10));null===Z.rulerListType&&(Z.rulerListType=this.getResource("z193"));null===Z.rulerW&&(Z.rulerW=parseInt(this.getResource("z197"),
10));null===Z.rulerH&&(Z.rulerH=parseInt(this.getResource("z191"),10));null===Z.rulerL&&(Z.rulerL=parseInt(this.getResource("z192"),10));null===Z.rulerT&&(Z.rulerT=parseInt(this.getResource("z195"),10));isNaN(parseFloat(this.getResource("z210")))||(Z.slideTransitionSpeed=parseFloat(this.getResource("z210")));null===Z.slideButtonsVisible&&(Z.slideButtonsVisible="0"!=this.getResource("DEFAULT_SLIDEBUTTONSVISIBLE"));null===Z.coordinatesVisible&&(Z.coordinatesVisible="0"!=this.getResource("z100"));null===
Z.geoCoordinatesVisible&&(Z.geoCoordinatesVisible="0"!=this.getResource("DEFAULT_GEOCOORDINATESVISIBLE"));null===Z.preloadVisible&&(Z.preloadVisible="0"!=this.getResource("DEFAULT_PRELOADVISIBLE"));null===Z.focal&&(Z.focal=parseInt(this.getResource("z114"),10));null===Z.quality&&(Z.quality=parseInt(this.getResource("z188"),10));null===Z.magnifierVisible&&(Z.magnifierVisible="0"!=this.getResource("DEFAULT_MAGNIFIERVISIBLE"));null===Z.magnifierW&&(Z.magnifierW=parseInt(this.getResource("DEFAULT_MAGNIFIERWIDTH"),
10));null===Z.magnifierH&&(Z.magnifierH=parseInt(this.getResource("DEFAULT_MAGNIFIERHEIGHT"),10));null===Z.magnifierL&&(Z.magnifierL=parseInt(this.getResource("DEFAULT_MAGNIFIERLEFT"),10));null===Z.magnifierT&&(Z.magnifierT=parseInt(this.getResource("DEFAULT_MAGNIFIERTOP"),10));null===Z.narrativeFolderPath&&(Z.narrativeFolderPath=Z.Utils.getResource("DEFAULT_NARRATIVEFOLDERPATH"));null===Z.narrativeImageFolderPath&&(Z.narrativeImageFolderPath=Z.Utils.getResource("DEFAULT_NARRATIVEIMAGEFOLDERPATH"));
null===Z.narrativeMediaFolderPath&&(Z.narrativeMediaFolderPath=Z.Utils.getResource("DEFAULT_NARRATIVEMEDIAFOLDERPATH"));null===Z.narrativeAnnotationFolderPath&&(Z.narrativeAnnotationFolderPath=Z.Utils.getResource("DEFAULT_NARRATIVEANNOTATIONFOLDERPATH"));null===Z.saveImageFull&&(Z.saveImageFull="0"!=this.getResource("DEFAULT_SAVEIMAGEFULL"));null===Z.saveImageFilename&&(Z.saveImageFilename=this.getResource("DEFAULT_SAVEIMAGEFILENAME"));null===Z.saveImageFormat&&(Z.saveImageFormat=this.getResource("DEFAULT_SAVEIMAGEFORMAT"));
null===Z.saveImageCompression&&(Z.saveImageCompression=parseFloat(this.getResource("DEFAULT_SAVEIMAGECOMPRESSION")));c=c=b=b=null;document.body&&(b=document.body.style,b=b.backgroundColor);var e=document.getElementById(Z.pageContainerID);e&&(c=Z.Utils.getElementStyle(e),c=c.backgroundColor);null===Z.saveImageBackColor&&(Z.saveImageBackColor=Z.Utils.stringValidate(c)&&"transparent"!=c?c:Z.Utils.stringValidate(b)&&"transparent"!=b?b:Z.Utils.getResource("DEFAULT_SAVEIMAGEBACKCOLOR"));null===Z.imageFilters&&
(Z.imageFilters="0"!=this.getResource("DEFAULT_IMAGEFILTERS"));null===Z.initialImageFilters&&(Z.initialImageFilters="0"!=this.getResource("z142"));null===Z.brightnessVisible&&(Z.brightnessVisible="0"!=this.getResource("DEFAULT_BRIGHTNESSVISIBLE"));null===Z.contrastVisible&&(Z.contrastVisible="0"!=this.getResource("DEFAULT_CONTRASTVISIBLE"));null===Z.sharpnessVisible&&(Z.sharpnessVisible="0"!=this.getResource("DEFAULT_SHARPNESSVISIBLE"));null===Z.blurrinessVisible&&(Z.blurrinessVisible="0"!=this.getResource("DEFAULT_BLURRINESSVISIBLE"));
null===Z.colorRedVisible&&(Z.colorRedVisible="0"!=this.getResource("DEFAULT_COLORREDVISIBLE"));null===Z.colorGreenVisible&&(Z.colorGreenVisible="0"!=this.getResource("DEFAULT_COLORGREENVISIBLE"));null===Z.colorBlueVisible&&(Z.colorBlueVisible="0"!=this.getResource("DEFAULT_COLORBLUEVISIBLE"));null===Z.colorRedRangeVisible&&(Z.colorRedRangeVisible="0"!=this.getResource("DEFAULT_COLORREDRANGEVISIBLE"));null===Z.colorGreenRangeVisible&&(Z.colorGreenRangeVisible="0"!=this.getResource("DEFAULT_COLORGREENRANGEVISIBLE"));
null===Z.colorBlueRangeVisible&&(Z.colorBlueRangeVisible="0"!=this.getResource("DEFAULT_COLORBLUERANGEVISIBLE"));null===Z.gammaVisible&&(Z.gammaVisible="0"!=this.getResource("DEFAULT_GAMMAVISIBLE"));null===Z.gammaRedVisible&&(Z.gammaRedVisible="0"!=this.getResource("DEFAULT_GAMMAREDVISIBLE"));null===Z.gammaGreenVisible&&(Z.gammaGreenVisible="0"!=this.getResource("DEFAULT_GAMMAGREENVISIBLE"));null===Z.gammaBlueVisible&&(Z.gammaBlueVisible="0"!=this.getResource("DEFAULT_GAMMABLUEVISIBLE"));null===Z.hueVisible&&
(Z.hueVisible="0"!=this.getResource("DEFAULT_HUEVISIBLE"));null===Z.saturationVisible&&(Z.saturationVisible="0"!=this.getResource("DEFAULT_SATURATIONVISIBLE"));null===Z.lightnessVisible&&(Z.lightnessVisible="0"!=this.getResource("DEFAULT_LIGHTNESSVISIBLE"));null===Z.whiteBalanceVisible&&(Z.whiteBalanceVisible="0"!=this.getResource("DEFAULT_WHITEBALANCEVISIBLE"));null===Z.normalizeVisible&&(Z.normalizeVisible="0"!=this.getResource("DEFAULT_NORMALIZEVISIBLE"));null===Z.equalizeVisible&&(Z.equalizeVisible=
"0"!=this.getResource("DEFAULT_EQUALIZEVISIBLE"));null===Z.noiseVisible&&(Z.noiseVisible="0"!=this.getResource("DEFAULT_NOISEVISIBLE"));null===Z.grayscaleVisible&&(Z.grayscaleVisible="0"!=this.getResource("DEFAULT_GRAYSCALEVISIBLE"));null===Z.thresholdVisible&&(Z.thresholdVisible="0"!=this.getResource("DEFAULT_THRESHOLDVISIBLE"));null===Z.inversionVisible&&(Z.inversionVisible="0"!=this.getResource("DEFAULT_INVERSIONVISIBLE"));null===Z.edgesVisible&&(Z.edgesVisible="0"!=this.getResource("DEFAULT_EDGESVISIBLE"));
null===Z.sepiaVisible&&(Z.sepiaVisible="0"!=this.getResource("DEFAULT_SEPIAVISIBLE"));null===Z.fieldOfViewVisible&&(Z.fieldOfViewVisible="0"!=this.getResource("DEFAULT_FIELDOFVIEWVISIBLE"));null===Z.textVisible&&(Z.textVisible="0"!=this.getResource("z217"));null===Z.shapeVisible&&(Z.shapeVisible="0"!=this.getResource("DEFAULT_SHAPEVISIBLE"));null===Z.freehandVisible&&(Z.freehandVisible="0"!=this.getResource("z116"));null===Z.polygonVisible&&(Z.polygonVisible="0"!=this.getResource("z181"));null===
Z.annotationPanelVisible&&(Z.annotationPanelVisible=parseInt(this.getResource("DEFAULT_ANNOTATIONPANELVISIBLE"),10));null===Z.labelShapesInternal&&(Z.labelShapesInternal="1"==this.getResource("DEFAULT_LABELSHAPESINTERNAL"));null===Z.annotationsAddMultiple&&(Z.annotationsAddMultiple="0"!=this.getResource("DEFAULT_ANNOTATIONSADDMULTIPLE"));null===Z.annotationsAutoSave&&(Z.annotationsAutoSave="0"!=this.getResource("DEFAULT_ANNOTATIONSAUTOSAVE"));null===Z.annotationsAutoSaveImage&&(Z.annotationsAutoSaveImage=
"0"!=this.getResource("DEFAULT_ANNOTATIONSAUTOSAVEIMAGE"));null===Z.saveButtonVisible&&(Z.saveButtonVisible="0"!=this.getResource("DEFAULT_ANNOTATIONSAVEBUTTONVISIBLE"));null===Z.labelClickSelect&&(Z.labelClickSelect="0"!=this.getResource("DEFAULT_LABELCLICKSELECT"));null===Z.labelHighlight&&(Z.labelHighlight="0"!=this.getResource("DEFAULT_LABELHIGHLIGHT"));null===Z.userPanelVisible&&(Z.userPanelVisible=this.getResource("DEFAULT_USERPANELVISIBLE"));null===Z.userNamePrompt&&(Z.userNamePrompt=Z.Utils.getResource("UI_USERNAMEPROMPT"));
null===Z.userNamePromptRetry&&(Z.userNamePromptRetry=Z.Utils.getResource("UI_USERNAMEPROMPTRETRY"));null===Z.trackingPanelVisible&&(Z.trackingPanelVisible=parseInt(this.getResource("DEFAULT_TRACKINGPANELVISIBLE"),10));null===Z.initialTrackingOverlayVisible&&(Z.initialTrackingOverlayVisible=parseInt(this.getResource("DEFAULT_INITIALTRACKINGOVERLAYVISIBLE"),10));null===Z.sliderImageSetVisible&&(Z.sliderImageSetVisible="0"!=this.getResource("DEFAULT_IMAGESETSLIDERVISIBLE"));if("object"===typeof a&&null!==
a){b=this.getResource("z287");Z.annotationPathProvided="undefined"!==typeof a.zHotspotPath||"undefined"!==typeof a.zAnnotationPath||"undefined"!==typeof a.zAnnotationXMLText||"undefined"!==typeof a.zAnnotationJSONObject||"undefined"!==typeof a.zNarrativePath;Z.saveHandlerProvided="undefined"!==typeof a.zSaveHandlerPath||"undefined"!==typeof a.zNoPost&&"1"==a.zNoPost;Z.fileHandlerProvided=Z.saveHandlerProvided||"undefined"!==typeof a.zFileHandlerPath;Z.saveImageHandlerProvided="undefined"!==typeof a.zFileHandlerPath||
"undefined"!==typeof a.zSaveImageHandlerPath;Z.narrativePathProvided="undefined"!==typeof a.zNarrativePath;Z.imageSetPathProvided="undefined"!==typeof a.zAnimationPath||"undefined"!==typeof a.zSlidestackPath;Z.mouseWheelParmeterProvided="undefined"!==typeof a.zMouseWheel;Z.trackingPathProvided="undefined"!==typeof a.zTrackingPath||"undefined"!==typeof a.zTrackingXMLText||"undefined"!==typeof a.zTrackingJSONObject;Z.userPathProvided="undefined"!==typeof a.zUserPath||"undefined"!==typeof a.zUserXMLText||
"undefined"!==typeof a.zUserJSONObject;Z.slidePathProvided=Z.imagePath&&-1!=Z.imagePath.indexOf("zSlidePath")||"undefined"!==typeof a.zSlidePath;var c=Z.slidePathProvided||Z.comparison||Z.overlays||Z.slideshow||Z.imageSetPathProvided||Z.animation||Z.slidestack,f;for(f in a)if(!("function"===typeof a[f]&&"zOnAnnotationReady"!==f&&"zOnReady"!==f||c&&("each"==f||"eachSlice"==f||"all"==f||"any"==f||"collect"==f||"detect"==f||"findAll"==f||"select"==f||"grep"==f||"include"==f||"member"==f||"inGroupsOf"==
f||"inject"==f||"invoke"==f||"max"==f||"min"==f||"partition"==f||"pluck"==f||"reject"==f||"sortBy"==f||"toArray"==f||"zip"==f||"size"==f||"inspect"==f||"_reverse"==f||"_each"==f||"clear"==f||"first"==f||"last"==f||"compact"==f||"flatten"==f||"without"==f||"uniq"==f||"intersect"==f||"clone"==f)||-1!=f.indexOf("this.indexOf")))if("undefined"===typeof Z[Z.Utils.stringLowerCaseFirstLetter(f.substr(1))])c?console.log(b+" "+f):alert(b+" "+f);else if(pValue=a[f],Z.expressParamsEnabled||"zNavigatorVisible"==
f)switch(f){case "zOnAnnotationReady":"function"===typeof pValue&&Z.setCallback("annotationPanelInitializedViewer",pValue);break;case "zOnReady":"function"===typeof pValue&&Z.setCallback("readyViewer",pValue);break;case "zInitialX":isNaN(parseFloat(pValue))||(Z.initialX=parseFloat(pValue));break;case "zInitialY":isNaN(parseFloat(pValue))||(Z.initialY=parseFloat(pValue));break;case "zInitialZoom":"fit"==pValue&&(pValue="-1");"fill"==pValue&&(pValue="0");isNaN(parseFloat(pValue))||(Z.initialZ=parseFloat(pValue),
Z.initialZ&&0<Z.initialZ&&100>=Z.initialZ&&(Z.initialZ/=100));break;case "zMinZoom":"fit"==pValue&&(pValue="-1");"fill"==pValue&&(pValue="0");isNaN(parseFloat(pValue))||(Z.minZ=parseFloat(pValue),Z.minZ&&0<Z.minZ&&100>=Z.minZ&&(Z.minZ/=100));break;case "zMaxZoom":isNaN(parseFloat(pValue))||(Z.maxZ=parseFloat(pValue),Z.maxZ&&-1!=Z.maxZ&&(Z.maxZ/=100));break;case "zNavigatorVisible":Z.navigatorVisible=parseInt(pValue,10);break;case "zNavigatorRectangleColor":Z.navigatorRectangleColor=pValue;break;case "zToolbarInternal":Z.toolbarInternal=
pValue;break;case "zToolbarVisible":Z.toolbarVisible=parseInt(pValue,10);Z.toolbarAutoShowHide=0!=Z.toolbarVisible&&1!=Z.toolbarVisible&&6!=Z.toolbarVisible&&7!=Z.toolbarVisible&&8!=Z.toolbarVisible;break;case "zToolbarBackgroundVisible":"0"==pValue&&(Z.toolbarBackgroundVisible=!1);break;case "zLogoVisible":"0"==pValue&&(Z.logoVisible=!1);break;case "zMinimizeVisible":"0"==pValue&&(Z.minimizeVisible=!1);break;case "zSliderVisible":"0"==pValue&&(Z.sliderZoomVisible=!1);break;case "zZoomButtonsVisible":"0"==
pValue&&(Z.zoomButtonsVisible=!1);break;case "zPanButtonsVisible":"0"==pValue&&(Z.panButtonsVisible=!1);break;case "zResetVisible":"0"==pValue&&(Z.resetVisible=!1);break;case "zFullViewVisible":"1"==pValue?(Z.fullScreenVisible=!0,Z.fullPageVisible=!1):"0"==pValue&&(Z.fullScreenVisible=!1,Z.fullPageVisible=!1);break;case "zFullScreenVisible":"0"==pValue&&(Z.fullScreenVisible=!1,Z.fullPageVisible=!1);break;case "zFullPageVisible":"1"==pValue&&(Z.fullScreenVisible=!1,Z.fullPageVisible=!0);break;case "zInitialFullPage":"1"==
pValue&&(Z.initialFullPage=!0);break;case "zFullPageInitial":alert(Z.Utils.getResource("z275")+" zFullPageInitial is now zInitialFullPage");break;case "zSkinPath":Z.skinPath=pValue;break;case "zTooltipsVisible":"0"==pValue&&(Z.tooltipsVisible=!1);break;case "zHelpVisible":Z.helpVisible=parseInt(pValue,10);break;case "zHelpPath":Z.helpPath=pValue;Z.helpCustom=!0;break;case "zHelpWidth":isNaN(parseInt(pValue,10))||(Z.helpW=parseInt(pValue,10));break;case "zHelpHeight":isNaN(parseInt(pValue,10))||(Z.helpH=
parseInt(pValue,10));break;case "zHelpLeft":isNaN(parseInt(pValue,10))||(Z.helpL=parseInt(pValue,10));break;case "zHelpTop":isNaN(parseInt(pValue,10))||(Z.helpT=parseInt(pValue,10));break;case "zProgressVisible":"0"==pValue&&(Z.progressVisible=!1);break;case "zMessagesVisible":"0"==pValue&&(Z.messagesVisible=!1);break;case "zTileSource":"dzi"==pValue.toLowerCase()&&(Z.tileSource="DZIFolder");break;case "zUsingDirectoryExtensions":"1"==pValue&&(Z.usingDirectoryExtensions=!0)}else alert(d+" "+f)}Z.Utils.validateImagePath()},
resetParametersXYZ:function(a){isNaN(parseFloat(this.getResource("z143")))||(Z.initialX=parseFloat(this.getResource("z143")));isNaN(parseFloat(this.getResource("z144")))||(Z.initialY=parseFloat(this.getResource("z144")));isNaN(parseFloat(this.getResource("z145")))||(Z.initialZ=parseFloat(this.getResource("z145")));isNaN(parseFloat(this.getResource("z163")))||(Z.minZ=parseFloat(this.getResource("z163")));isNaN(parseFloat(this.getResource("z153")))||(Z.maxZ=parseFloat(this.getResource("z153")));if(this.stringValidate(a))for(var b=
0,c=a.length;b<c;b++){var d=a[b],e=d.indexOf("=");if(0<e){var f=d.substring(0,e),d=d.substring(e+1);if(this.stringValidate(d))switch(f){case "zInitialX":isNaN(parseFloat(d))||(Z.initialX=parseFloat(d));break;case "zInitialY":isNaN(parseFloat(d))||(Z.initialY=parseFloat(d));break;case "zInitialZoom":"fit"==d&&(d="-1");"fill"==d&&(d="0");isNaN(parseFloat(d))||(Z.initialZ=parseFloat(d),Z.initialZ&&1<Z.initialZ&&(Z.initialZ/=100));break;case "zMinZoom":"fit"==d&&(d="-1");"fill"==d&&(d="0");isNaN(parseFloat(d))||
(Z.minZ=parseFloat(d),Z.minZ&&1<Z.minZ&&(Z.minZ/=100));break;case "zMaxZoom":isNaN(parseFloat(d))||(Z.maxZ=parseFloat(d),Z.maxZ&&1<Z.maxZ&&(Z.maxZ/=100))}}}},readCookie:function(a){a+="=";for(var b=document.cookie.split(";"),c=0,d=b.length;c<d;c++){for(var e=b[c];" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(a))return e.substring(a.length,e.length)}return null},validateImagePath:function(a){a="undefined"!==typeof a&&Z.Utils.stringValidate(a)?a:Z.imagePath;if(null!==a){var b=this.getResource("z213");
if(-1==a.toLowerCase().indexOf(".zif")||Z.requestTiles)if(Z.usingDirectoryExtensions||-1==a.toLowerCase().indexOf(".jpg")&&-1==a.toLowerCase().indexOf(".png"))if(-1==a.toLowerCase().indexOf(".pff")||Z.requestTiles)if(Z.Utils.stringValidate(Z.iiifServer)){Z.tileSource="IIIFImageServer";a="undefined"!=typeof Z.iiifScheme&&Z.Utils.stringValidate(Z.iiifScheme)?Z.iiifScheme+"://":"https://";var b="undefined"!=typeof Z.iiifServer&&Z.Utils.stringValidate(Z.iiifServer)?Z.iiifServer+"/":null,c="undefined"!=
typeof Z.iiifPrefix&&Z.Utils.stringValidate(Z.iiifPrefix)?Z.iiifPrefix+"/":null,d="undefined"!=typeof Z.iiifIdentifier&&Z.Utils.stringValidate(Z.iiifIdentifier)?Z.iiifIdentifier:null;Z.imagePath=a&&b&&d?a+b+c+d:Z.Utils.getResource("ERROR_SETTINGIIIFIMAGEPATH")}else"DZIFolder"==Z.tileSource||-1!=a.toLowerCase().indexOf(".dzi")?(Z.tileSource="DZIFolder",b=a.toLowerCase(),c=a.lastIndexOf("/"),-1==c?(Z.dziImageSubfolder=a,Z.dziImagePropertiesFilename=Z.dziImageSubfolder+".dzi"):(a.substring(0,c).lastIndexOf("/"),
d=b.substring(c+1,b.length).indexOf(".dzi"),-1!=d?Z.dziImagePropertiesFilename=a.substring(c+1,b.length):(Z.dziImagePropertiesFilename=b.substring(c+1,b.length),d=Z.dziImagePropertiesFilename.toLowerCase().indexOf(".xml")),Z.dziImageSubfolder=Z.dziImagePropertiesFilename.substring(0,d)+"_files",Z.imagePath=a.substring(0,c))):Z.Utils.stringValidate(Z.tileHandlerPath)?Z.Utils.stringValidate(Z.tileHandlerPath)&&(Z.specialStorageEnabled?(Z.tileSource="ImageServer",a=Z.tileHandlerPath,Z.tileHandlerPathFull=
a):alert(b)):Z.tileSource="ZoomifyImageFolder";else Z.imageFilename=a.substring(a.toLowerCase().lastIndexOf("/")+1),Z.specialStorageEnabled||Z.singleFileSupported?(Z.tileSource="ZoomifyPFFFile",Z.Utils.validateResponseArrayFunctionality(),Z.localUse&&Z.localFilesSupported&&null===Z.localFile&&(Z.setCallback("imageFileSelected",Z.createViewer),Z.Utils.validateLocalViewing()),Z.specialStorageEnabled&&null!==Z.tileHandlerPath&&(a=Z.tileHandlerPath,Z.tileHandlerPathFull=a)):Z.singleFileSupported||null!==
Z.tileHandlerPath?Z.specialStorageEnabled||alert(b):alert(this.getResource("ALERT_PFFREQUIRESNEWERBROWSER"));else Z.tileSource="unconverted";else Z.imageFilename=a.substring(a.toLowerCase().lastIndexOf("/")+1),Z.singleFileSupported?(Z.tileSource="ZoomifyZIFFile",Z.Utils.validateResponseArrayFunctionality(),Z.localUse&&Z.localFilesSupported&&null===Z.localFile&&(Z.setCallback("imageFileSelected",Z.createViewer),Z.Utils.validateLocalViewing())):alert(this.getResource("z16"))}else if(Z.imageSet||Z.slideshow)Z.tileSourceMultiple=
!0},validateLocalViewing:function(){var a=Z.Utils.getContainerSize(Z.pageContainer,Z.ViewerDisplay);Z.FileAccessDisplay=Z.Utils.createContainerElement("div","FileAccessDisplay","inline-block","relative","auto","308px","180px",(a.x-308)/2+"px",(a.y-180)/2+"px","solid","1px","lightGrey","0px","0px","normal",null,!0);Z.pageContainer.appendChild(Z.FileAccessDisplay);a=Z.Utils.getResource("ALERT_VALIDATELOCALZIFVIEWING-TITLE");a=Z.Utils.createTextElement("titleBox",a,"268px","28px","10px","15px","10px",
"none","0px",!0,"verdana","13px","none",null,1,"hidden","hidden",null);Z.FileAccessDisplay.appendChild(a);a.firstChild.style.textAlign="center";a.firstChild.style.fontWeight="bold";a=Z.Utils.getResource("ALERT_VALIDATELOCALZIFVIEWING-MESSAGE")+Z.imageFilename;a=Z.Utils.createTextElement("messageBox",a,"268px","55px","10px","43px","10px","none","0px",!0,"verdana","13px","none",null,1,"hidden","hidden",null);Z.FileAccessDisplay.appendChild(a);a.firstChild.style.textAlign="center";var a=Z.Utils.createContainerElement("div",
"inputCont","inline-block","relative","auto","240px","30px","34px","138px","none","0px","lightGrey","0px","0px","normal",null,!0),b=document.createElement("input");b.setAttribute("type","file");a.appendChild(b);Z.FileAccessDisplay.appendChild(a);Z.Utils.addEventListener(b,"change",Z.Utils.handleFileSelect)},handleFileSelect:function(a){Z.localFile=a.target.files[0];Z.useLocalFile=!0;Z.FileAccessDisplay.style.display="none";Z.Utils.validateCallback("imageFileSelected")},clearImageParameters:function(){Z.imagePath=
null;Z.imagePath2=null;Z.imageMetadataXML=null;Z.parameters=null;Z.xmlParametersPath=null;Z.xmlParametersParsing=null;Z.initialX=null;Z.initialY=null;Z.initialZ=null;Z.minZ=null;Z.maxZ=null;Z.zoomAndPanInProgressID=null;Z.geoCoordinatesPath=null;Z.geoCoordinatesVisible=null;Z.geoCoordinatesFolder=null;Z.tour=!1;Z.tourPath=null;Z.tourPlaying=null;Z.tourStop=!1;Z.hotspots=!1;Z.hotspotPath=null;Z.hotspotFolder=null;Z.narrative||(Z.annotations=!1,Z.annotationPath=null,Z.annotationPanelVisible=null,Z.clickURLEntryVisible=
null,Z.annotationFolder=null,Z.annotationJSONObject=null,Z.annotationXMLText=null,Z.labelShapesInternal=null,Z.annotationsAddMultiple=null,Z.annotationsAutoSave=null,Z.annotationsAutoSaveImage=null);Z.initialR=null;Z.unitsPerImage=null;Z.pixelsPerUnit=null;Z.sourceMagnification=null;Z.imageProperties=null;Z.annotationPathProvided=!1;Z.slidePathProvided=!1;Z.tileSource=null;Z.pffJPEGHeadersSeparate=!1;Z.focal=null;Z.quality=null;Z.narrative||Z.tracking||(Z.markupMode=null,Z.editMode=null,Z.editAdmin=
!1,Z.editing=null,Z.labelMode="view",Z.editModePrior=Z.editMode);Z.sliderFocus="zoom";Z.animation=!1;Z.animationPath=null;Z.animationCount=0;Z.animationAxis=null;Z.animator=null;Z.animationFlip=null;Z.slidestack=!1;Z.slidestackPath=null;Z.mouseWheelParmeterProvided=null;Z.mouseWheel=null;Z.imageSetHotspotPath=null;Z.hotspotFileShared=!1;Z.imageSetAnnotationPath=null;Z.annotationFileShared=!1;Z.imageW=null;Z.imageH=null;Z.imageD=null;Z.imageCtrX=null;Z.imageCtrY=null;Z.imageX=0;Z.imageY=0;Z.imageZ=
0;Z.imageR=0;Z.fitZ=null;Z.fillZ=null;Z.zooming="stop";Z.panningX="stop";Z.panningY="stop";Z.rotating="stop";Z.postingXML=!1;Z.postingHTML=!1;Z.postingImage=!1;Z.postingFile=!1;Z.iiifInfoJSONObject=null;Z.iiifIdentifier=null;Z.iiifRegion=null;Z.iiifSize=null;Z.iiifRotation=null;Z.iiifQuality=null;Z.iiifFormat=null;maxTileB=maxTileR=maxTier=0},getResource:function(a){var b="";switch(a){case "z110":b="Enable Express parameters";break;case "z109":b="Changing This Violates License Agreement";break;case "z108":b=
"Support for this parameter is enabled only in the Zoomify Image Viewer included in the Zoomify HTML5 Express, Pro, and Enterprise editions: ";break;case "z187":b="Changing This Violates License Agreement";break;case "z186":b="Changing This Violates License Agreement";break;case "z185":b="Support for this parameter is enabled only in the Zoomify Image Viewer included in the Zoomify HTML5 Pro and Enterprise editions: ";break;case "z215":b="Enable special storage support";break;case "z214":b="Changing this violates License Agreement";
break;case "z213":b="Support for Zoomify Image File (PFF) storage and other special storage options is enabled only in the Zoomify Image Viewer included in the Zoomify HTML5 Enterprise edition.";break;case "z107":b="Changing this violates License Agreement";break;case "z106":b="Changing this violates License Agreement";break;case "z105":b="Support for this parameter is enabled only in the Zoomify Image Viewer included in the Zoomify HTML5 Enterprise edition: ";break;case "DEFAULT_PARAMETERLISTTEXT":b=
"zAnimationAxis,zAnimationFlip,zAnimationPath,zAnimator,zAnnotationJSONObject,zAnnotationPanelVisible,zAnnotationPath,zAnnotationSort,zAnnotationXMLAperioLoad,zAnnotationXMLAperioPost,zAnnotationXMLText,zAnnotationsAddMultiple,zAnnotationsAutoSave,zAutoResize,zBaseZIndex,zBlurrinessVisible,zBookmarksGet,zBookmarksSet,zBrightnessVisible,zCanvas,zCaptionBackColor,zCaptionBackVisible,zCaptionBoxes,zCaptionOffset,zCaptionPosition,zCaptionTextColor,zCaptionTextVisible,zClickPan,zClickURLEntryVisible,zClickZoom,zColorBlueRangeVisible,zColorBlueVisible,zColorGreenRangeVisible,zColorGreenVisible,zColorRedRangeVisible,zColorRedVisible,zComparisonPath,zConstrainPan,zContrastVisible,zCoordinatesVisible,zCopyrightPath,zCrosshairsVisible,zDebug,zDoubleClickDelay,zDoubleClickZoom,zEdgesVisible,zEditMode,zEqualizeVisible,zFadeInSpeed,zFieldOfViewVisible,zFileHandlerPath,zFocal,zFreehandVisible,zFullPageVisible,zFullScreenVisible,zFullViewVisible,zGalleryHeight,zGalleryLeft,zGalleryPosition,zGalleryTop,zGalleryVisible,zGalleryWidth,zGammaBlueVisible,zGammaGreenVisible,zGammaRedVisible,zGammaVisible,zGeoCoordinatesPath,zGrayscaleVisible,zHelpHeight,zHelpLeft,zHelpPath,zHelpTop,zHelpVisible,zHelpWidth,zHideOverlayBackfill,zHotspotListTitle,zHotspotPath,zHotspotsDrawOnlyInView,zHueVisible,zIIIFFormat,zIIIFIdentifier,zIIIFPrefix,zIIIFQuality,zIIIFRegion,zIIIFRotation,zIIIFScheme,zIIIFServer,zIIIFSize,zImageFiltersVisible,zImageH,zImageListPath,zImageProperties,zImageSetSliderVisible,zImageW,zInitialFullPage,zInitialImageFilters,zInitialRotation,zInitialSync,zInitialTrackingOverlayVisible,zInitialX,zInitialY,zInitialZoom,zInteractive,zInversionVisible,zKeys,zLabelClickSelect,zLabelFillColor,zLabelFillVisible,zLabelHighlight,zLabelLineColor,zLabelLineVisible,zLabelShapesInternal,zLabelsClickDrag,zLightnessVisible,zLogoCustomPath,zLogoLinkURL,zLogoVisible,zMagnification,zMagnifierHeight,zMagnifierLeft,zMagnifierTop,zMagnifierVisible,zMagnifierWidth,zMarkupMode,zMaskBorder,zMaskClearOnUserAction,zMaskFadeSpeed,zMaskScale,zMaskVisible,zMaxZoom,zMeasureVisible,zMessagesVisible,zMinZoom,zMinimizeVisible,zMousePan,zMouseWheel,zNarrativeAnnotationFolderPath,zNarrativeImageFolderPath,zNarrativeMediaFolderPath,zNarrativeMode,zNarrativePath,zNavigatorFit,zNavigatorHeight,zNavigatorLeft,zNavigatorRectangleColor,zNavigatorTop,zNavigatorVisible,zNavigatorWidth,zNoPost,zNoPostDefaults,zNoiseVisible,zNormalizeVisible,zOnAnnotationReady,zOnReady,zOverlayJSONObject,zOverlayPath,zPanBuffer,zPanButtonsVisible,zPanSpeed,zPixelsPerUnit,zPolygonVisible,zPreloadVisible,zProgressVisible,zQuality,zRequestTiles,zResetVisible,zRotationVisible,zRulerHeight,zRulerLeft,zRulerListType,zRulerTop,zRulerVisible,zRulerWidth,zSaturationVisible,zSaveButtonVisible,zSaveHandlerPath,zSaveImageBackColor,zSaveImageCompression,zSaveImageFilename,zSaveImageFormat,zSaveImageFull,zSaveImageHandlerPath,zScreensaver,zScreensaverSpeed,zSepiaVisible,zServerIP,zServerPort,zShapeVisible,zSharpnessVisible,zSimplePath,zSkinPath,zSlideButtonsVisible,zSlideListTitle,zSlidePath,zSliderVisible,zSlidestackPath,zSmoothPan,zSmoothPanEasing,zSmoothPanGlide,zSmoothZoom,zSmoothZoomEasing,zSourceMagnification,zSyncVisible,zTextVisible,zThresholdVisible,zTileH,zTileHandlerPath,zTileSource,zTileW,zTilesPNG,zToolbarBackgroundVisible,zToolbarInternal,zToolbarPosition,zToolbarVisible,zTooltipsVisible,zTourListTitle,zTourPath,zTrackingAuto,zTrackingEditMode,zTrackingPanelVisible,zTrackingPath,zUnits,zUnitsPerImage,zUnsavedEditsTest,zUserLogin,zUserNamePrompt,zUserPanelVisible,zUserPath,zUsingDirectoryExtensions,zVirtualPointerPath,zVirtualPointerVisible,zWatermarkPath,zWhiteBalanceVisible,zXMLParametersPath,zZoomButtonsVisible,zZoomRectangle,zZoomSpeed";
break;case "z125":b="0";break;case "z124":b="8192";break;case "z123":b="1060";break;case "z90":b="ZoomifyZIFFile"==Z.tileSource?"1024":"256";break;case "z221":b="IIIFImageServer"!=Z.tileSource?"256":"512";break;case "z219":b="IIIFImageServer"!=Z.tileSource?"256":"512";break;case "z140":b="300";break;case "z139":b="60000";break;case "DEFAULT_IMAGELOADQUEUEDELAY":b="100";break;case "z218":b="1.15";break;case "z220":b="300";break;case "z81":b="6";break;case "z78":b="3";break;case "z80":b="5";break;case "z77":b=
"3";break;case "z79":b="3";break;case "z76":b="2";break;case "z75":b="0";break;case "z173":b=Z.mobileDevice?"1":"1.5";break;case "z173UNCONVERTED":b=Z.mobileDevice?Z.rotationVisible?"2":"1":"10";break;case "DEFAULT_z310SIZEMAXBROWSER":b="10000";break;case "DEFAULT_z310SIZEMAXFIREFOX":b="4000";break;case "DEFAULT_z310SIZEMAXMOBILE":b="3000";break;case "DEFAULT_z310SIZEMAXIMAGESET":b="1000";break;case "z74":reTxt=Z.mobileDevice?"1":"2";break;case "z88":b="1";break;case "DEFAULT_BASEZINDEX":b="2000";
break;case "DEFAULT_VALIDATEVIEWRETRYLIMIT":b="2";break;case "DEFAULT_VALIDATEVIEWRETRYDELAY":b="1000";break;case "z104":b="0";break;case "DEFAULT_MOUSECLICKTHRESHOLDVIEWPORT":b=4;break;case "DEFAULT_MOUSECLICKTHRESHOLDTIMEVIEWPORT":b=500;break;case "DEFAULT_MOUSECLICKTHRESHOLDHOTSPOT":b=4;break;case "DEFAULT_TOUCHTAPTHRESHOLDVIEWPORT":b=Z.mobileDevice?6:4;break;case "DEFAULT_TOUCHTAPTHRESHOLDTIMEVIEWPORT":b=500;break;case "DEFAULT_MOUSECLICKTHRESHOLDNAVIGATOR":b=4;break;case "DEFAULT_TOUCHTAPTHRESHOLDNAVIGATOR":b=
Z.mobileDevice?6:3;break;case "z175":b="5";break;case "z176":b="10";break;case "z241":b="5";break;case "z242":b="0.02";break;case "z238":b="30";break;case "z240":b="20";break;case "z239":b="800";break;case "z93TIERSKIPTHRESHOLD":b="0.2";break;case "z122":b="10";break;case "DEFAULT_PINCHTESTDURATION":b="10";break;case "DEFAULT_AUTORESIZESKIPDURATION":b="10";break;case "DEFAULT_MOUSEWHEEL":b="1";break;case "DEFAULT_MOUSEWHEELANIMATION":b="1";break;case "DEFAULT_MOUSEWHEELSLIDESTACK":b="1";break;case "z165":b=
"300";break;case "z111":b="5";break;case "z112":b="0.067";break;case "z146":b="1";break;case "z164":b="1";break;case "z92":b="1";break;case "z93":b="1";break;case "DEFAULT_DOUBLECLICKZOOM":b="1";break;case "DEFAULT_DOUBLECLICKDELAY":b="250";break;case "z95":b="1";break;case "z95LIMIT":b="2";break;case "z95STRICT":b="0";break;case "DEFAULT_SMOOTHPAN":b="1";break;case "DEFAULT_SMOOTHPANEASING":b="2";break;case "DEFAULT_SMOOTHPANGLIDE":b="2";break;case "DEFAULT_SMOOTHZOOM":b="1";break;case "DEFAULT_SMOOTHZOOMEASING":b=
"2";break;case "z143":b=null;break;case "z144":b=null;break;case "z145":b=null;break;case "z163":b=null;break;case "z153":b="1";break;case "z83":b="#FBFAFA";break;case "z83NOALPHA":b="#FBFAFA";break;case "z83LIGHT":b="#FEFEFE";break;case "z82":b="0.75";break;case "z82MORE":b="0.9";break;case "DEFAULT_BACKGROUNDSMALLDALPHA":b="0.75";break;case "z87":b="#C0C0C0";break;case "z200":b="skinFiles.xml";break;case "z201":b="Assets/Skins/Default";break;case "z199":b="0";break;case "z171":b="2";break;case "z172":b=
"150";break;case "z167":b="100";break;case "z168":b="-1";break;case "z170":b="-1";break;case "z166":b=null;break;case "z169":b="#0000FF";break;case "DEFAULT_NAVIGATORBORDERCOLOR":b="#FFFFFF";break;case "z223":b="4";break;case "DEFAULT_TOOLBARBACKGROUNDVISIBLE":b="1";break;case "DEFAULT_TOOLBARBACKGROUNDVISIBLEADJUST":b="10";break;case "DEFAULT_TOOLBARHEIGHT":b="30";break;case "z222":b="1";break;case "z224":b="1";break;case "z128":b="1";break;case "z150":b="1";break;case "z149":b=null;break;case "z162":b=
"1";break;case "DEFAULT_SLIDERZOOMVISIBLE":b="1";break;case "z205ZOOM":b="10";break;case "DEFAULT_ZOOMBUTTONSVISIBLE":b="1";break;case "z174":b="1";break;case "DEFAULT_RESETVISIBLE":b="1";break;case "z121":b="1";break;case "z119":b="1";break;case "z120":b="white";break;case "z118":b="0";break;case "z141":b="0";break;case "DEFAULT_BOOKMARKSGET":b="0";break;case "DEFAULT_BOOKMARKSSET":b="0";break;case "DEFAULT_ZOOMRECTANGLE":a=Z.comparison||null!==Z.imagePath&&-1!=Z.imagePath.indexOf("zComparisonPath")||
"undefined"!==typeof Z.parameters&&null!==Z.parameters&&"undefined"!==typeof Z.parameters.zComparisonPath&&("undefined"===typeof Z.parameters.zZoomRectangle||0!=Z.parameters.zZoomRectangle);b=Z.mobileDevice||a||!Z.proParamsEnabled&&!Z.enterpriseParamsEnabled?"0":"1";break;case "z157":b="undefined"===typeof Z.parameters||null===Z.parameters||"undefined"!==typeof Z.parameters.zMeasureVisible&&"0"==Z.parameters.zMeasureVisible||("undefined"===typeof Z.parameters.zMarkupMode||"1"!=Z.parameters.zMarkupMode&&
"2"!=Z.parameters.zMarkupMode)&&("undefined"===typeof Z.parameters.zEditMode||"1"!=Z.parameters.zEditMode&&"2"!=Z.parameters.zEditMode)?"0":"1";break;case "DEFAULT_FULLVIEWEXITEXTERNALBUTTONCOLOR":b="\t#F8F8F8";break;case "DEFAULT_INITIALR":b="0";break;case "z190":b="0";break;case "z184":b="1";break;case "z182":b="500";break;case "z183":b=" ";break;case "z183COLOR":b="#000000";break;case "DEFAULT_MESSAGESVISIBLE":b="1";break;case "z233":b="0";break;case "z103":b="0";break;case "DEFAULT_PRELOADVISIBLE":b=
"0";break;case "DEFAULT_TOOLBARLABELFONTSIZE":b="11";break;case "z159":b="lightgray";break;case "z158":b="white";break;case "DEFAULT_MESSAGEDURATIONLONG":b="5000";break;case "DEFAULT_MESSAGEDURATIONSTANDARD":b="3000";break;case "DEFAULT_MESSAGEDURATIONSHORT":b="1500";break;case "DEFAULT_MESSAGEDURATIONVERYSHORT":b="750";break;case "DEFAULT_TRACEDISPLAYTEXTFONTSIZE":b="11";break;case "DEFAULT_TRACEDISPLAYTEXTPADDINGSMALL":b="2";break;case "z229":b="#D3D3D3";break;case "z228":b="#FFFFFF";break;case "z114":b=
"1";break;case "z188":b="55";break;case "DEFAULT_IMAGESETXMLFILE":b=Z.animation?"animation.xml":Z.overlay?"overlays.xml":"slidestack.xml";break;case "ALERT_VALIDATELOCALZIFVIEWING-TITLE":b="Local Viewing Security";break;case "ALERT_VALIDATELOCALZIFVIEWING-MESSAGE":b="Use button below to verify file to view:\n\n";break;case "z16":b="Viewing Zoomify Images stored in the ZIF format requires a newer browser version. Please consider upgrading to the current release of your browser.";break;case "ALERT_PFFREQUIRESNEWERBROWSER":b=
"Viewing Zoomify Images stored in the PFF format requires a newer browser version. Please consider upgrading to the current release of your browser.";break;case "z8":b="\nClick the '?' button for help.";break;case "ERROR_ERROR":b="error";break;case "z287":b="Parameter unrecognized or deprecated - see the Parameters List documentation: ";break;case "z275":b="Parameter deprecated - please replace: ";break;case "z288":b="Use Firefox for local viewing or see READ ME FIRST\nfile for optional settings for other browsers.";
break;case "z290":b="Browsers allow ZIF file viewing only from a web server.\nPlease use Zoomify Image folders for local viewing.";break;case "z289":b="Browsers allow PFF file viewing only from a web server.\nPlease use Zoomify Image folders for local viewing.";break;case "z249":b="Image failed to load: possible invalid path, missing image, or network error.";break;case "z280":b="Sorry!  Part of this view is not refreshing.  The network may be slow, or the website may be missing a file:  ";break;
case "ERROR_VALIDATEVIEW":b="Sorry!  Part of this view is not refreshing. The network\nmay be slow, or the website may be missing a file.  ";break;case "z280-ZIF":b="Sorry!  Part of this view is not refreshing.  The network may be slow, or the ZIF file may be faulty:  ";break;case "z256-ZIFBYTERANGE":b="Error loading image: ZIF file data request failed. Request content type: ";break;case "z256-ZIFBYTES":b="Error loading image: ZIF file invalid.";break;case "z256-PFFBYTES":b="Error loading image: PFF file invalid.";
break;case "z295":b="Browser does not support XMLHttpRequest.";break;case "z256-IMAGEXML":b="Error loading image: please make sure image path in web page matches image folder location on webserver.";break;case "z256-PFFIMAGEHEADER":b="Error loading image: image header request invalid.";break;case "z256-PFFIMAGEOFFSET":b="Error loading image: image offset request invalid.";break;case "z256-PARAMETERSXML":b="Error loading parameters XML: please make sure the zXMLParametersPath value is correct.";break;
case "z256-TOOLBARSKINSXML":b="Error loading toolbar - skin files not found: please verify that the folders 'Assets/Skins/Default' are in same folder as the web page displaying the Viewer, or add zSkinPath parameter to web page. The zSkinPath parameter may be required if using a content management system such as Drupal, Joomla, or WordPress.";break;case "z256":b="Error making network request:\npossible invalid path or network error.";break;case "z272":b="Error related to network security: ";break;
case "z273":b="Error related to network status: ";break;case "z273RANGEREQUESTSZIF":b="ZIF file not found at the path provided. A MIME type may be needed on the web server. Please see the READ ME FIRST file in the Zoomify product or contact Support. Error: ";break;case "z273RANGEREQUESTSPFF":b="PFF file not found at the path provided. A MIME type may be needed on the web server. Please see the READ ME FIRST file in the Zoomify product or contact Support. Error: ";break;case "z244":b=" converting XML text to XML doc (DOMParser): ";
break;case "z243":b=" converting XML doc to XML text (DOMParser): ";break;case "z294":b="Browser does not support XML DOM.";break;case "z293":b="XML Doc invalid.";break;case "z296":b="XML invalid.";break;case "z255":b="Image XML invalid.";break;case "z252":b="Image properties XML invalid.";break;case "z250":b="Image properties invalid.";break;case "z251":b="Image properties parameter invalid.";break;case "z254":b="Image tile count does not match value in image XML. If the count is invalid display problems can result.";
break;case "z245":b=" while executing callback: ";break;case "z253":b="\nImage tile request not fulfilled within time period expected";break;case "ERROR_UNCONVERTEDIMAGEPATHINVALID":b="Unconverted JPEG or PNG image failed to load: possible invalid path, missing image, or network error.";break;case "ERROR_TRANSLATINGCANVASFORUNCONVERTEDIMAGE":b="\nTranslation of canvas failed";break;case "ERROR_SCALINGCANVASFORUNCONVERTEDIMAGE":b="\nScaling of canvas failed";break;case "ERROR_SETTINGTRANSFORMONCANVASFORUNCONVERTEDIMAGE":b=
"\nTransform on canvas failed";break;case "z271":b="Navigator image failed to load: possible invalid path, missing image, or network error.";break;case "z278":b="Skin XML invalid.";break;case "z279":b="The skin XML file has one or more faulty name lines.";break;case "z283":b="Unknown element style - no known method to identify.";break;case "z284":b="Unknown mouse position - no known method to calculate.";break;case "z285":b="Unknown mouse scroll - no known method to calculate.";break;case "z286":b=
"Unknown window size - no known method to calculate.";break;case "z360ZOOMIFY":b="Open Zoomify Website";break;case "z360GENERIC":b="Launch Website";break;case "z363":a=Z.hotspots?"\nAlt-Click: Toggle Hotspot Visibility":Z.annotations?"\nAlt-Click: Toggle Label Visibility":"";b="Minimize Toolbar"+a;break;case "z341":a=Z.hotspots?"\nAlt-Click: Toggle Hotspot Visibility":Z.annotations?"\nAlt-Click: Toggle Label Visibility":"";b="Expand Toolbar"+a;break;case "z400":b="Zoom Out";break;case "z385ZOOM":b=
"Zoom In And Out";break;case "z399":b="Zoom In";break;case "z370":b="Pan Left";break;case "z372":b="Pan Up";break;case "z369":b="Pan Down";break;case "z371":b="Pan Right";break;case "z378":b="Reset Initial View\nAlt-Click: Prior View";break;case "z391":b="Enter Full View";break;case "z391EXIT":b="Exit Full View";break;case "z391EXITEXTERNAL":b="Exit Full View";break;case "z342":b="Show Help";break;case "z342MARKUP":b="Show Markup Help";break;case "z342ANNOTATION":b="Show Annotation Help";break;case "TIP_IMAGESETPRIOR":b=
Z.animation?"Prior Image":"Prior Slide";break;case "z385IMAGESET":b=Z.animation?"Change Image":"Change Slide";break;case "TIP_IMAGESETNEXT":b=Z.animation?"Next Image":"Next Slide";break;case "TIP_PRELOAD":b=Z.imageSet?Z.animation?"Preload Current View For All Images":"Preload Current View For All Slides":"Preload All Zoom Levels For Current View";break;case "z342OK":b="Close Help Display";break;case "z362":b="Accept And Close Message";break;case "z361":b="Decline And Close Message";break;case "z427ZOOMIFY":b=
"http://www.zoomify.com";break;case "z427":b="http://www.zoomify.com";break;case "z427TARGET":b="_blank";break;case "UI_TOOLBARINTERNALBACKGROUNDALPHA":b="0.75";break;case "UI_TOOLBARINTERNALBACKGROUNDCOLOR":b="lightgray";break;case "UI_TOOLBARINTERNALBUTTONUPCOLOR":b="white";break;case "UI_TOOLBARINTERNALBUTTONOVERCOLOR":b="lightgray";break;case "UI_TOOLBARINTERNALBUTTONDOWNCOLOR":b="darkgray";break;case "UI_TOOLBARINTERNALBUTTONZOOMINTEXT":b="+";break;case "UI_TOOLBARINTERNALBUTTONRESETTEXT":b=
"Z";break;case "UI_TOOLBARINTERNALBUTTONZOOMOUTTEXT":b="-";break;case "z439":b="Navigator Bird's Eye View";break;case "z420":b="X";break;case "z422":b="430";break;case "z421":b="300";break;case "z423":b="OK";break;case "UI_HELPSCREENCOLOR":b="lightgray";break;case "UI_HELPBUTTONCOLOR":b="white";break;case "z437":b="430";break;case "z436":b="90";break;case "z435":b="Cancel";break;case "z438":b="OK";break;case "UI_TRACEDISPLAYTITLE":b="Trace Values\n\n";break;case "z445":b="This panel is enabled using the HTML parameter 'zDebug=1' (basic) or 'zDebug=2' (adds tile tracing). It can be called in JavaScript as follows:\n\n   Z.Utils.trace('value to display');  \n\nThe buttons below display or modify important state values.  Web designers new to JavaScript will also benefit from the console, trace, profiling, and other debugging features of leading browsers.";
break;case "UI_TRACEDISPLAYTILESTATUSTEXT":b="Required Cached Requested Loaded Displayed Waiting";break;case "UI_TRACEDISPLAYELAPSEDTIMETEXT":b="Seconds";break;case "UI_TRACEDISPLAYTILESPERSECONDTEXT":b="Loads / Second";break;case "z446":b="Show Globals";break;case "z449":b="Toggle Display";break;case "z447":b="Toggle Backfill";break;case "z448":b="Toggle Constrain Pan";break;case "z32":b="<p align=%22center%22><font face=%22Arial,Helvetica,sans-serif%22><strong>Viewer Help</strong></font></p><p align=%22justify%22><font face=%22Arial,Helvetica,sans-serif%22>To explore this image, simply <strong>click</strong> the image to zoom in, <strong>double-click</strong> to zoom out, and <strong>click-drag</strong> to pan.<br><br>Shortcuts:<br>&nbsp;&nbsp;&nbsp;<strong>Alt-click-drag</strong> to create a <i>zoom-rectangle</i>.<br>&nbsp;&nbsp;&nbsp;<strong>Alt-click</strong> to zoom fully in.<br>&nbsp;&nbsp;&nbsp;<strong>Alt-double-click</strong> to zoom fully out.<br>&nbsp;&nbsp;&nbsp;<strong>Alt-click-Reset</strong> button to return to the prior view.<br>&nbsp;&nbsp;&nbsp;(Alt is Option on Macintosh).<br><br>The Navigator thumbnail overview can also be clicked or click-dragged to pan.<br><br>Use the Toolbar for exact navigation - if using a mouse, hold it over any button to see a helpful tip.<br><br>Keyboard shortcuts:<br>&nbsp;&nbsp;&nbsp;<strong>A</strong> or <strong>Shift</strong> to zoom in.<br>&nbsp;&nbsp;&nbsp;<strong>Z</strong> or <strong>Ctrl</strong> to zoom out.<br>&nbsp;&nbsp;&nbsp;<strong>Arrows</strong> change image in slideshow/animation.<br>&nbsp;&nbsp;&nbsp;<strong>Space Bar</strong> to toggle fullscreen view.<br>&nbsp;&nbsp;&nbsp;<strong>Escape</strong> to reset initial view or exits fullscreen.<br>&nbsp;&nbsp;&nbsp;<strong>Alt-L</strong> to hide/show hotspots or labels.<br>&nbsp;&nbsp;&nbsp;<strong>Alt-click-Minimize</strong> button - same as Alt-L.<br>&nbsp;&nbsp;&nbsp;<strong>Page Up/Down</strong> change image in a slidestack.<br>&nbsp;&nbsp;&nbsp;<strong>&lt;</strong> or <strong>&gt;</strong> to rotate image if rotation buttons visible.</font></p>";
break;case "z30":b="<p align=%22center%22><font face=%22Arial,Helvetica,sans-serif%22><strong>\\/ \\/ \\/</strong></font></p>";break;case "z29":b="<p align=%22center%22><font face=%22Arial,Helvetica,sans-serif%22><strong>Annotation Help</strong></font></p><p align=%22justify%22><font face=%22Arial,Helvetica,sans-serif%22>The Annotation Panel provides an intuitive display of <i>Points of Interest</i> in a zoomable image, along with associated <i>Labels</i> and <i>Notes</i>, if any.<br><br>A Point Of Interest (POI) is a place in the image that is named and listed so that it can be navigated to easily.<br><br>A Label is a visual element in the image: a freehand drawing, text caption, rectangle or other polygon, or a measurement.<br><br>A Note is text associated with a Point Of Interest. Notes can hold a virtually unlimited number of characters (spaces included). A vertical scrollbar automatically appears when a note requires more lines than fit in the note area.</font></p>";
break;case "CONTENT_RULERUNITSCHOICELISTTITLE":b="Units...";break;case "CONTENT_RULERUNITSCHOICELISTVALUES":b="Pixels,Ym,Zm,Em,Pm,Tm,Gm,Mm,km,hm,dam,m,dm,cm,mm,um,nm,pm,fm,am,zm,ym";break;case "CONTENT_RULERLISTTYPELISTTITLE":b="List Type...";break;case "CONTENT_RULERLISTTYPELISTVALUES":b="None,Magnification,Percentage";break;case "CONTENT_RULERSOURCEMAGNIFICATIONLISTTITLE":b="Source Magnification...";break;case "CONTENT_RULERSOURCEMAGNIFICATIONLISTTEXT":b="1.25x,2.5x,5x,10x,20x,40x,60x,100x";break;
case "CONTENT_RULERSOURCEMAGNIFICATIONLISTVALUES":b="1.25,2.5,5,10,20,40,60,100";break;case "z34":b="New Hotspot ";break;case "z33":b="Caption for hotspot ";break;case "z37":b="New Label ";break;case "z35":b="Caption for label ";break;case "CONTENT_LABELCOMMENT":b="Comment for label ";break;case "z45":b="Polygon ";break;case "z38":b="Tooltip for label ";break;case "z36":b="";break;case "z25":b=Z.captionTextColor?Z.captionTextColor:"#FFFFFF";break;case "z22":b=Z.captionBackColor?Z.captionBackColor:
"#000000";break;case "CONTENT_LABELLINECOLOR":b=Z.labelLineColor?Z.labelLineColor:"#FFFFFF";break;case "CONTENT_LABELFILLCOLOR":b=Z.labelFillColor?Z.labelFillColor:"#FFFFFF";break;case "z26":b=Z.captionTextVisible?"1":"0";break;case "z23":b=Z.captionBackVisible?"1":"0";break;case "CONTENT_LABELLINEVISIBLE":b=Z.labelLineVisible?"1":"0";break;case "CONTENT_LABELFILLVISIBLE":b=Z.labelFillVisible?"1":"0";break;case "z24":b=Z.captionPosition?Z.captionPosition:"8";break;case "CONTENT_EDITABLE":b="1";break;
case "CONTENT_LINESTYLE":b="solid";break;default:b="Unexpected resource request"}return b},clearComponent:function(a){switch(a){case Z.Toolbar:Z.Toolbar=null;Z.Utils.clearDisplay(Z.ToolbarDisplay);Z.toolbarVisible=null;Z.toolbarBackgroundVisible=null;Z.skinPath=null;Z.sliderZoomVisible=null;Z.logoVisible=null;Z.minimizeVisible=null;Z.zoomButtonsVisible=null;Z.sliderVisible=null;Z.panButtonsVisible=null;Z.resetVisible=null;Z.fullScreenVisible=null;Z.tooltipsVisible=null;Z.helpVisible=null;Z.progressVisible=
null;break;case Z.Navigator:Z.navigatorVisible=null;Z.navigatorW=null;Z.navigatorH=null;Z.navigatorL=null;Z.navigatorT=null;Z.navigatorFit=null;Z.navigatorRectangleColor=null;break;case Z.Gallery:Z.Utils.clearDisplay(Z.GalleryDisplay);Z.Gallery=null;Z.galleryVisible=null;Z.galleryAutoShowHide=null;Z.galleryW=null;Z.galleryH=null;Z.galleryM=null;Z.galleryL=null;Z.galleryT=null;Z.galleryPosition=null;Z.galleryRectangleColor=null;break;case Z.Ruler:Z.Utils.clearDisplay(Z.RulerDisplay),Z.Ruler=null,Z.rulerVisible=
null,Z.rulerListType=null,Z.rulerW=null,Z.rulerH=null,Z.rulerL=null,Z.rulerT=null}},clearDisplay:function(a){if(a)if(Z.useCanvas&&"CANVAS"==a.tagName)Z.Utils.clearCanvas(a);else for(;a.hasChildNodes();)a.removeChild(a.lastChild)},clearCanvas:function(a){a=a.getContext("2d");a.save();try{a.setTransform(1,0,0,1,0,0)}catch(b){Z.Utils.showMessage(Z.Utils.getResource("ERROR_SETTINGTRANSFORMONCANVASFORUNCONVERTEDIMAGE")),console.log("In function clearCanvas setting transform on canvas:  "+b)}a.clearRect(0,
0,a.canvas.width,a.canvas.height);a.restore()},colorCanvas:function(a,b){var c=a.getContext("2d");c.save();c.setTransform(1,0,0,1,0,0);c.fillStyle=b;c.fillRect(0,0,c.canvas.width,c.canvas.height);c.restore()},deleteDiv:function(a){if(a=document.getElementById(a)){for(;a.hasChildNodes();)a.removeChild(a.lastChild);a.parentNode.removeChild(a)}},createCallback:function(a,b){for(var c=[],d=2,e=arguments.length;d<e;d++)c[c.length]=arguments[d];return function(){for(var d=c.concat([]),e=0,u=arguments.length;e<
u;e++)d[d.length]=arguments[e];return b.apply(a,d)}},verifyCallback:function(a){var b=!1;if("undefined"!==typeof Z.callbacks)for(var c=Z.callbacks.slice(0),d=0,e=c.length;d<e;d++){var f=c[d];f&&f.callbackEvent==a&&"object"===typeof f&&"function"===typeof f.callbackFunction&&(b=!0)}return b},getCallbackFunction:function(a){var b=null;if("undefined"!==typeof Z.callbacks)for(var c=Z.callbacks.slice(0),d=0,e=c.length;d<e;d++){var f=c[d];f&&f.callbackEvent==a&&"object"===typeof f&&"function"===typeof f.callbackFunction&&
(b=f.callbackFunction)}return b},validateCallback:function(a){"undefined"===typeof Z.callbacks&&(Z.callbacks=[]);var b=Z.callbacks.slice(0);Z.Utils.functionCallWithDelay(function(){Z.Utils.validateCallbackDelayed(a,b)},10)},validateCallbackDelayed:function(a,b){for(var c=0,d=b.length;c<d;c++){var e=b[c];if(e&&e.callbackName==a&&"object"===typeof e&&"function"===typeof e.callbackFunction)switch(a){case "viewChanging":e.callbackFunction();break;case "viewPanningGetCurrentCoordinates":var f=Z.Viewport.getCoordinates();
e.callbackFunction(f);break;case "viewZoomingGetCurrentZoom":f=Z.Viewport.getZoom();e.callbackFunction(f);break;case "viewChangingGetCurrentCoordinatesFull":f=Z.Viewport.getCoordinatesFull();e.callbackFunction(f);break;case "viewUpdateCompleteGetLabelIDs":f=Z.Viewport.getLabelIDsInCurrentView(!1,!0,!0);e.callbackFunction(f);break;case "viewUpdateCompleteGetLabelInternalIDs":f=Z.Viewport.getLabelIDsInCurrentView(!0,!0,!0);e.callbackFunction(f);break;case "labelSavedGetJSONObject":if(f=Z.Viewport.getCurrentLabel())f=
f.internalID,f=Z.Viewport.getLabelJSONObject(f,!0),e.callbackFunction(f);break;case "labelCreatedGetInternalID":Z.Viewport&&Z.Viewport.getStatus("XMLParsedViewport")&&(f=Z.Viewport.getCurrentLabel())&&(f=f.internalID,e.callbackFunction(f));break;case "labelDrawnGetIDs":Z.Viewport&&(f=Z.Viewport.getCurrentLabel())&&e.callbackFunction(f.id,f.internalID);break;case "labelSelectedInViewportGetIDs":Z.Viewport&&(f=Z.Viewport.getCurrentLabel())&&e.callbackFunction(f.id,f.internalID);break;case "currentLabelChangedGetID":Z.Viewport&&
(f=Z.Viewport.getCurrentLabel())&&e.callbackFunction(f.id,f.internalID);break;default:e.callbackFunction()}}Z.Utils.arrayClear(b)},getContainerSize:function(a,b){var c=Z.Utils.getElementStyle(a),d=parseFloat(c.width),e=parseFloat(c.height);Z.Utils.stringValidate(c.width)&&-1!=c.width.indexOf("%")&&(d=parseFloat(Z.Utils.getElementStyleProperty(a,"width")));Z.Utils.stringValidate(c.height)&&-1!=c.height.indexOf("%")&&(e=parseFloat(Z.Utils.getElementStyleProperty(a,"height")));isNaN(d)&&(d=b.clientWidth);
isNaN(e)&&(e=b.clientHeight);if(0==d||0==e)winDimensions=Z.Utils.getWindowSize(),0==d&&(a.parentNode.style.width=winDimensions.x+"px",d=a.clientWidth),0==e&&(a.parentNode.style.height=winDimensions.y+"px",e=a.clientHeight);if(isNaN(d)||0==d)d=800;if(isNaN(e)||0==e)e=400;return new Z.Utils.Point(d,e)},createContainerElement:function(a,b,c,d,e,f,m,u,t,B,C,x,p,R,ma,ea,K,L){var n=document.createElement(a);this.stringValidate(b)&&(n.id=b);b=n.style;b.display=this.stringValidate(c)?c:"inline-block";b.position=
this.stringValidate(d)?d:"static";b.overflow=this.stringValidate(e)?e:"hidden";"canvas"==a?(this.stringValidate(f)&&n.setAttribute("width",f),this.stringValidate(m)&&n.setAttribute("height",m)):(this.stringValidate(f)&&(b.width=f),this.stringValidate(m)&&(b.height=m));this.stringValidate(u)&&(b.left=u);this.stringValidate(t)&&(b.top=t);b.borderStyle=this.stringValidate(B)?B:"none";b.borderWidth=this.stringValidate(C)?C:"0px";b.borderColor=this.stringValidate(L)?L:"#696969";b.background=this.stringValidate(x)?
x:"transparent";b.margin=this.stringValidate(p)?p:"0px";b.padding=this.stringValidate(R)?R:"0px";b.whiteSpace=this.stringValidate(ma)?ma:"normal";this.stringValidate(ea)&&(b.cursor=ea);"undefined"!==K&&K&&(Z.Utils.addEventListener(n,"touchstart",Z.Utils.preventDefault),Z.Utils.addEventListener(n,"mousedown",Z.Utils.preventDefault),Z.Utils.addEventListener(n,"contextmenu",Z.Utils.preventDefault));return n},createCenteredElement:function(a,b){var c=this.createContainerElement("div"),d=[];d[d.length]=
'<div style="#position:relative; display:table; height:100%; width:100%; border:none; margin:0px; padding:0px; overflow:hidden; text-align:left;">';d[d.length]='<div style="#position:absolute; display:table-cell; #top:50%; width:100%; border:none; margin:0px; padding:0px; vertical-align:middle;">';d[d.length]='<div id="'+b+'"; style="#position:relative; width:100%; #top:-50%; border:none; margin:0px; padding:0px; text-align:center;"></div></div></div>';c.innerHTML=d.join("");for(var d=c=c.firstChild,
e=c.getElementsByTagName("div");0<e.length;)d=e[0],e=d.getElementsByTagName("div");d.appendChild(a);return c},createTextElement:function(a,b,c,d,e,f,m,u,t,B,C,x,p,R,ma,ea,K,L){c=Z.Utils.createContainerElement("div","textBoxFor-"+a,"inline-block","absolute","hidden",c,d,e,f,u,t,"white","0px",m,"normal");d=document.createElement("textarea");c.appendChild(d);e=d.style;d.id=a;d.value=b;d.readOnly=B;e.width="100%";e.height="100%";e.margin="0";e.border="0";this.stringValidate(C)&&(e.fontFamily=C);this.stringValidate(x)&&
(e.fontSize=x);this.stringValidate(p)&&(e.resize=p);this.stringValidate(R)&&(d.columns=R);this.stringValidate(ma)&&(d.rows=ma);this.stringValidate(ea)&&(e.overflowX=ea);this.stringValidate(K)&&(e.overflowY=K);this.stringValidate(L)&&(d.wrap="soft","off"==L&&(e.whiteSpace="nowrap"));return c},createSelectElement:function(a,b,c,d,e,f,m,u,t,B,C){var x=document.createElement("select");x.id=a;Z.Utils.stringValidate(b)&&"none"!=b&&(x.options[0]=new Option(b,null));a=0;for(b=c.length;a<b;a++)x.options[x.options.length]=
new Option(c[a].text,c[a].value);Z.Utils.addEventListener(x,"undefined"!==typeof B&&null!==B?B:"change",t);x.size=C;c=x.style;c.width=d+"px";c.position="absolute";c.left=e+"px";c.top=f+"px";c.fontSize=null==m?"11px":m+"px";c.fontFamily="verdana";c.visibility=u;return x},updateSelectElement:function(a,b,c){if(a){var d=-1!=a.selectedIndex?a.selectedIndex:0;a.innerHTML="";for(var e=0,f=b.length;e<f;e++)a.options[a.options.length]=new Option(b[e].text,b[e].value.toString());"undefined"!==typeof c&&null!==
c&&(b=Z.Utils.arrayIndexOfObjectValue(b,"value",c),-1!=b&&(d=b));b=a.options.length-1;a.selectedIndex=d<=b?d:b}},createInputElement:function(a,b,c,d,e,f){var m=document.createElement("input");m.id=a;m.type="file";m.accept=d;m.multiple=e;m.style.visibility=c;Z.Utils.addEventListener(m,"change",function(){Z.Narrative.uploadFiles(b,this.files,f)});return m},getChildElementByID:function(a,b){for(var c=null,d=0,e=a.childNodes.length;d<e&&(c=a.childNodes[d],c.id!=b)&&(c=Z.Utils.getChildElementByID(c,b),
null===c);d++);return c},getElementPosition:function(a){for(var b=0,c=0,d="fixed"==this.getElementStyle(a).position,e=this.getOffsetParent(a,d);e;)b+=a.offsetLeft,c+=a.offsetTop,d&&(a=this.getPageScroll(),b+=a.x,c+=a.y),a=e,d="fixed"==this.getElementStyle(a).position,e=this.getOffsetParent(a,d);return new this.Point(b,c)},getOffsetParent:function(a,b){return b&&a!=document.body?document.body:a.offsetParent},getElementSize:function(a){return new this.Point(a.clientWidth,a.clientHeight)},getElementStyle:function(a){if(a.currentStyle)return a.currentStyle;
if(window.getComputedStyle)return window.getComputedStyle(a,"");this.showMessage(this.getResource("z283"))},getElementStyleProperty:function(a,b){if(window.getComputedStyle)return window.getComputedStyle(a,null).getPropertyValue(b);if(a.currentStyle)return a.currentStyle[b];this.showMessage(this.getResource("z283"))},getElementStylePropertyZIndex:function(a){var b=0;window.document.defaultView.getComputedStyle?b=window.document.defaultView.getComputedStyle(a,null).getPropertyValue("z-index"):a.currentStyle?
b=a.currentStyle["z-index"]:this.showMessage(this.getResource("z283"));return b},isElementFluid:function(a){var b=null,c=a.cloneNode(!1),d=!1,e=!1,f=null,m=null,u=0,t=0,B=Z.Utils.getElementStyle(a);B&&(u=B.width,t=B.height,b=-1!=u.indexOf("px")&&-1!=t.indexOf("px"));if(Z.browser!=Z.browsers.IE||9<=Z.browserVersion&&!b)window.getComputedStyle?value=window.getComputedStyle(c,null).width:c.currentStyle&&(value=c.currentStyle.width),"undefined"!==typeof value&&null!==value&&""!==value&&(d=-1!=value.toString().indexOf("%")||
"auto"==value),d||(window.getComputedStyle?value=window.getComputedStyle(c,null).height:c.currentStyle&&(value=c.currentStyle.height),"undefined"!==typeof value&&null!==value&&""!=value&&(e=-1!=value.toString().indexOf("%")||"auto"==value)),d||e||(f=Z.Utils.isElementFluidNew(a)),d||e||(m=0!=parseFloat(u)%1||0!=parseFloat(t)%1);return d||e||f||m},isElementFluidNew:function(a){var b=a.cloneNode(!1),c,d,e,f,m;e=d=!1;b.style.margin="0";b.style.padding="0";b.style.maxWidth="none";b.style.minWidth="none";
c=document.createElement("testContainer");c.style.display="block";c.style.width="800px";c.style.padding="0";c.style.margin="0";c.appendChild(b);a.parentNode.insertBefore(c,a);d=b.offsetWidth;c.style.width="900px";b.offsetWidth==d?(a.parentNode.removeChild(c),d=!1):(f=Math.floor(.125*d),m=Math.floor(100/900*b.offsetWidth),a.parentNode.removeChild(c),d=f==m?!0:!1);d||(b.style.margin="0",b.style.padding="0",b.style.maxHeight="none",b.style.minHeight="none",c=document.createElement("testContainer"),c.style.display=
"block",c.style.height="800px",c.style.padding="0",c.style.margin="0",c.appendChild(b),a.parentNode.insertBefore(c,a),e=b.offsetHeight,c.style.height="900px",b.offsetHeight==e?(a.parentNode.removeChild(c),e=!1):(f=Math.floor(.125*e),m=Math.floor(100/900*b.offsetHeight),a.parentNode.removeChild(c),e=f==m?!0:!1));return d||e},getEventTargetCoords:function(a){return getElementPosition(Z.Utils.target(a))},getFirstTouch:function(a){var b=null,c=a.touches;a=a.changedTouches;"undefined"!==typeof c?b=c[0]:
"undefined"!==typeof a&&(b=a[0]);return b},getSecondTouch:function(a){var b=null,c=a.touches;a=a.changedTouches;"undefined"!==typeof c?b=c[1]:"undefined"!==typeof a&&(b=a[1]);return b},getMousePosition:function(a){var b=0,c=0;"DOMMouseScroll"==a.type&&Z.browser==Z.browsers.FIREFOX&&3>Z.browserVersion?(b=a.screenX,c=a.screenY):"number"===typeof a.pageX?(b=a.pageX,c=a.pageY):"number"===typeof a.clientX?(b=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,c=a.clientY+document.body.scrollTop+
document.documentElement.scrollTop):console.log(this.getResource("z284"));return new this.Point(b,c)},getMouseScroll:function(a){var b=0;"number"===typeof a.wheelDelta?b=a.wheelDelta:"number"===typeof a.detail?b=-1*a.detail:this.showMessage(this.getResource("z285"));return b?b/Math.abs(b):0},getPageScroll:function(){var a=0,b=0,c=document.documentElement||{},d=document.body||{};if("number"===typeof window.pageXOffset)a=window.pageXOffset,b=window.pageYOffset;else if(d.scrollLeft||d.scrollTop)a=d.scrollLeft,
b=d.scrollTop;else if(c.scrollLeft||c.scrollTop)a=c.scrollLeft,b=c.scrollTop;return new this.Point(a,b)},getScreenSize:function(){return new this.Point(screen.width,screen.height)},getWindowSize:function(){var a=0,b=0,c=document.documentElement||{},d=document.body||{};"number"===typeof window.innerWidth?(a=window.innerWidth,b=window.innerHeight):c.clientWidth||c.clientHeight?(a=c.clientWidth,b=c.clientHeight):d.clientWidth||d.clientHeight?(a=d.clientWidth,b=d.clientHeight):this.showMessage(this.getResource("z286"));
return new this.Point(a,b)},Button:function(a,b,c,d,e,f,m,u,t,B,C,x,p,R,ma,ea,K,L,n,A){a=Z.Utils.createContainerElement("span",a,"inline-block","absolute","hidden",m,u,t,B,R,ma,ea,K,L,n,A);if(Z.Utils.stringValidate(b)){var l=document.createTextNode(b);a.appendChild(Z.Utils.createCenteredElement(l));Z.Utils.setTextNodeStyle(l,"black","verdana","13px","none","normal","normal","normal","normal","1em","center","none")}else{c=Z.Utils.stringRemoveTrailingSlash(c);var v=Z.Utils.createGraphicElement(c+"/"+
d),aa=Z.Utils.createGraphicElement(c+"/"+e),G=Z.Utils.createGraphicElement(c+"/"+f);v.style.width=aa.style.width=G.style.width=m;v.style.height=aa.style.height=G.style.height=u;v.style.position=aa.style.position=G.style.position="absolute";Z.browser==Z.browsers.FIREFOX&&3>Z.browserVersion&&(v.style.top=aa.style.top=G.style.top="");aa.style.visibility=G.style.visibility="hidden";v.alt=aa.alt=G.alt="";"undefined"!==typeof p&&Z.Utils.stringValidate(p)&&(v.alt=Z.Utils.getResource(p));a.appendChild(v);
a.appendChild(aa);a.appendChild(G)}Z.Utils.addEventListener(a,"mousedown",Z.Utils.preventDefault);Z.Utils.addEventListener(a,"mouseover",Z.Utils.stopPropagation);Z.Utils.addEventListener(a,"mousedown",Z.Utils.stopPropagation);Z.Utils.addEventListener(a,"mouseup",Z.Utils.stopPropagation);Z.Utils.addEventListener(a,"mouseout",Z.Utils.stopPropagation);"undefined"!==typeof imageUp&&(Z.Utils.addEventListener(v,"contextmenu",Z.Utils.preventDefault),Z.Utils.addEventListener(aa,"contextmenu",Z.Utils.preventDefault),
Z.Utils.addEventListener(G,"contextmenu",Z.Utils.preventDefault));Z.Utils.addEventListener(a,"touchstart",Z.Utils.preventDefault);Z.Utils.addEventListener(a,"touchend",Z.Utils.preventDefault);Z.Utils.addEventListener(a,"touchcancel",Z.Utils.preventDefault);Z.Utils.stringValidate(b)||(Z.Utils.disableTextInteraction(l),Z.Utils.addEventListener(a,"contextmenu",Z.Utils.preventDefault));Z.tooltipsVisible&&Z.Utils.stringValidate(p)&&(a.title=Z.Utils.getResource(p));Z.Utils.setButtonHandler(a,C,x);this.elmt=
a},buttonSize:function(a,b,c){var d=a.style;d.width=b+"px";d.height=c+"px";c=a.firstChild;d=a.childNodes[1];a=a.childNodes[2];c&&d&&a&&(c.style.width=d.style.width=a.style.width=b+"px",c.style.height=d.style.height=a.style.height=b+"px")},setButtonDefaults:function(a){Z.Toolbar&&(Z.Utils.clearButtonSettings(a),Z.Utils.setButtonState(a,"up"),Z.Utils.setButtonHandler(a,"mouseover",Z.Toolbar.z457))},clearButtonSettings:function(a){var b=a.firstChild,c=a.childNodes[1],d=a.childNodes[2];b&&c&&d&&(b.style.visibility=
c.style.visibility=d.style.visibility="hidden",Z.Utils.removeEventListener(b,"mouseover",Z.Toolbar.z457),Z.Utils.removeEventListener(c,"mousedown",Z.Toolbar.z457),Z.Utils.removeEventListener(c,"mouseout",Z.Toolbar.z457),Z.Utils.removeEventListener(d,"mouseup",Z.Toolbar.z457),Z.Utils.removeEventListener(a,"touchstart",Z.Toolbar.z457),Z.Utils.removeEventListener(a,"touchend",Z.Toolbar.z457),Z.Utils.removeEventListener(a,"touchcancel",Z.Toolbar.z457));Z.Utils.removeEventListener(a,"mouseover",Z.Toolbar.z457);
Z.Utils.removeEventListener(a,"mousedown",Z.Toolbar.z457);Z.Utils.removeEventListener(a,"mouseout",Z.Toolbar.z457);Z.Utils.removeEventListener(a,"mouseup",Z.Toolbar.z457)},setButtonState:function(a,b){var c="up"==b?a.firstChild:"down"==b?a.childNodes[1]:a.childNodes[2];c&&(c.style.visibility="visible")},setButtonHandler:function(a,b,c){c="undefined"!==c?c:Z.Toolbar.z457;var d="undefined"!==b?b:"mouseover";if("mouseover"==b&&"undefined"!==typeof a.firstChild)a=a.firstChild;else if("mousedown"!=b||
"undefined"===typeof a.childNodes[1])"mouseup"==b&&"undefined"!==typeof a.childNodes[2]?a=a.childNodes[2]:"mouseout"==b&&"undefined"!==typeof a.childNodes[1]&&(a=a.childNodes[1]);Z.Utils.addEventListener(a,"mousedown"==b?"touchstart":"touchend",c);Z.Utils.addEventListener(a,d,c)},Checkbox:function(a,b,c,d,e,f,m,u,t){var B=Z.Utils.createContainerElement("div","containerFor-"+a,"inline-block","absolute","hidden",c,d,e,f,"none","0px","transparent","0px","0px","normal"),C=document.createElement("input");
B.appendChild(C);C.type="checkbox";C.id=a;C.value=b;C.width=c;C.height=d;a=B.style;a.width=c+"px";a.height=d+"px";a.left=e+"px";a.top=f+"px";Z.Utils.addEventListener(C,m,u);Z.Utils.addEventListener(C,"touchstart",u);Z.tooltipsVisible&&Z.Utils.stringValidate(t)&&(C.title=Z.Utils.getResource(t));return B},Graphic:function(a,b,c,d,e,f,m,u){b=Z.Utils.stringRemoveTrailingSlash(b);b=Z.Utils.createGraphicElement(c?b+"/"+c:b);c=b.style;c.width=d;c.height=e;"undefined"!==typeof u&&Z.Utils.stringValidate(u)?
b.alt=Z.Utils.getResource(u):b.alt="";c=Z.Utils.createContainerElement("span",a,"inline-block","absolute","hidden",d,e,f,m,"none","0px","transparent","0px","0px","normal");c.appendChild(b);this.elmt=c;Z.Utils.addEventListener(b,"mousedown",Z.Utils.preventDefault);Z.Utils.addEventListener(b,"touchstart",Z.Utils.preventDefault);Z.Utils.addEventListener(b,"contextmenu",Z.Utils.preventDefault)},createGraphicElement:function(a){var b=this.createContainerElement("img"),c=null;Z.browser==Z.browsers.IE&&
7>Z.browserVersion?(c=this.createContainerElement("span",null,"inline-block"),b.onload=function(){c.style.width=c.style.width||b.width+"px";c.style.height=c.style.height||b.height+"px";b=b.onload=null},c.style.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+a+'", sizingMethod="scale")'):(c=b,c.src=a);return c},graphicSize:function(a,b,c){var d=a.style;d.width=b+"px";d.height=c+"px";a=a.firstChild.style;a.width=b+"px";a.height=c+"px"},Radiobutton:function(a,b,c,d,e,f,m,u,t,B){var C=
Z.Utils.createContainerElement("div","containerFor-"+a,"inline-block","absolute","hidden",d,e,f,m,"none","0px","transparent","0px","0px","normal"),x=document.createElement("input");C.appendChild(x);x.type="radio";x.id=a;x.name=b;x.value=c;x.width=d;x.height=e;a=C.style;a.width=d+"px";a.height=e+"px";a.left=f+"px";a.top=m+"px";null!==u&&null!==t&&(Z.Utils.addEventListener(x,u,t),Z.Utils.addEventListener(x,"radioEvnt",t));Z.tooltipsVisible&&Z.Utils.stringValidate(B)&&(x.title=Z.Utils.getResource(B));
return C},Point:function(a,b){this.x="number"===typeof a?a:0;this.y="number"===typeof b?b:0},Point3D:function(a,b,c){this.x="number"===typeof a?a:0;this.y="number"===typeof b?b:0;this.z="number"===typeof c?c:0},Coordinates:function(a,b,c,d){this.x="number"===typeof a?a:0;this.y="number"===typeof b?b:0;this.z="number"===typeof c?c:0;this.r="number"===typeof d?d:0},CoordinatesDisplayStyle:function(a,b,c,d,e,f,m,u,t,B,C){this.cLeft=a;this.cTop=b;this.vWidth=c;this.vHeight=d;this.vLeft=e;this.vTop=f;
this.bWidth=m;this.bHeight=u;this.bLeft=t;this.bTop=B;this.cRotation=C},Pair:function(a,b){this.a=a;this.b=b},Trio:function(a,b,c){this.a=a;this.b=b;this.c=c},Range:function(a,b){this.start="number"===typeof a?a:0;this.end="number"===typeof b?b:0},RangeScale:function(a,b){this.min="number"===typeof a?a:0;this.max="number"===typeof b?b:0},swapZIndices:function(a,b){var c=Z.Utils.getElementStylePropertyZIndex(a),d=Z.Utils.getElementStylePropertyZIndex(b);if("auto"==c||"auto"==d)c=(Z.baseZIndex-101).toString(),
d=(Z.baseZIndex-100).toString();a.style.zIndex=d;b.style.zIndex=c},stringValidate:function(a){return"undefined"!==typeof a&&null!==a&&""!==a&&"null"!==a},stringEscapeSpaces:function(a){var b=RegExp("_","g");a=a.replace(b,"__");b=RegExp(" ","g");return a=a.replace(b,"_")},stringUnescapeSpaces:function(a){var b=RegExp("__","g");a=a.replace(b,"_");b=RegExp("_","g");return a=a.replace(b," ")},stringGetInitials:function(a){var b="";a&&(b=a.replace(/[^a-zA-Z- ]/g,"").match(/\b\w/g).join("").toUpperCase());
return b},stringGetRelativePath:function(a,b){var c=a;a&&b&&(c="/"==a.slice(0,1)?0:a.split("/").length-1,c=Z.Utils.stringMultiply("../",c)+b);return c},stringLowerCaseFirstLetter:function(a){return a.charAt(0).toLowerCase()+a.slice(1)},stringUpperCaseFirstLetter:function(a){return a.charAt(0).toUpperCase()+a.slice(1)},stringMultiply:function(a,b){var c=Math.ceil(Math.log(b)/Math.LN2),d=a;do d+=d;while(0<--c);return d.slice(0,a.length*b)},stringPadFront:function(a,b,c){return a=Z.Utils.stringMultiply(c,
b-a.length)+a},stringRemoveLeadingZeros:function(a){var b="";"undefined"!==typeof a&&null!==a&&(b=1<a.length&&"0"==a.slice(0,1)&&"."!=a.slice(1,2)?a.slice(1,a.length):a);return b},stringRemoveDuplicateDots:function(a){var b="";if("undefined"!==typeof a&&null!==a){var c=a.indexOf("."),b=a.replace(/\./g,"");-1!=c&&(b=b.slice(0,c)+"."+b.slice(c))}return b},stringValidateTrailingSlashCharacter:function(a){"undefined"===typeof a&&null===a||"/"==a[a.length-1]||(a+="/");return a},stringRemoveTrailingSlash:function(a){return"undefined"===
typeof a||null===a?"":"/"==a.slice(-1,a.length)?a.slice(0,a.length-1):a},stringRemoveTrailingSpace:function(a){return"undefined"===typeof a||null===a?"":" "==a.slice(-1,a.length)?a.slice(0,a.length-1):a},stringRemoveNestedSpace:function(a,b){var c=a;if("undefined"!==typeof a&&Z.Utils.stringValidate(a)){var d=a.indexOf(b);" "==a.substring(d-1,d)&&(c=a.slice(0,d-1)+a.slice(d))}return c},stringRemoveNestedString:function(a,b){var c=a;if("undefined"!==typeof a&&Z.Utils.stringValidate(a))var c=a.indexOf(b),
d=c+b.length,c=a.slice(0,c)+stringClean.slice(d);return c},stringValidateURLScheme:function(a){if("undefined"!==typeof a&&null!==a){var b=a.slice(0,7);"http://"!=b&&"https://"!=b&&(a="http://"+a)}return a},stringRemoveFileExtension:function(a){var b=a.length;"."==a.slice(b-4,b-3)&&(a=a.slice(0,b-4));return a},stringRemoveTabAndLineWrapCharacters:function(a){a=a.replace(/\n/g,"");a=a.replace(/\r/g,"");return a=a.replace(/\t/g,"")},stringUnescapeAmpersandCharacters:function(a){a=a.replace(/\n/g,"");
a=a.replace(/&#38;/g,"&");a=a.replace(/&#038;/g,"&");return a=a.replace(/&amp;/g,"&")},setHTMLTextDefaultCaptionStyle:function(a,b,c,d,e,f,m,u,t,B,C,x,p){a=a.style;-1==b.indexOf("color=")&&(a.color=c);-1==b.indexOf("font-family=")&&(a.fontFamily=d);-1==b.indexOf("font-size=")&&(a.fontSize=e);-1==b.indexOf("font-size-adjust=")&&(a.fontSizeAdjust=f);-1==b.indexOf("font-style=")&&(a.fontStyle=m);-1==b.indexOf("font-stretch=")&&(a.fontStretch=u);-1==b.indexOf("font-variant=")&&(a.fontVariant=t);-1==b.indexOf("font-weight=")&&
(a.fontWeight=B);-1==b.indexOf("line-height=")&&(a.lineHeight=C);-1==b.indexOf("text-align=")&&(a.textAlign=x);-1==b.indexOf("text-decoration=")&&(a.textDecoration=p)},setHTMLTextStyle:function(a,b,c,d,e,f,m,u,t,B,C,x){a=a.style;a.color=b;a.fontFamily=c;a.fontSize=d;a.fontSizeAdjust=e;a.fontStyle=f;a.fontStretch=m;a.fontVariant=u;a.fontWeight=t;a.lineHeight=B;a.textAlign=C;a.textDecoration=x},setTextAreaStyle:function(a,b,c,d,e,f,m,u,t,B,C,x,p){a=a.firstChild.style;a.color=b;a.fontFamily=c;a.fontSize=
d;a.fontSizeAdjust=e;a.fontStyle=f;a.fontStretch=m;a.fontVariant=u;a.fontWeight=t;a.lineHeight=B;a.textAlign=C;a.textDecoration=x;a.padding=p},setTextNodeStyle:function(a,b,c,d,e,f,m,u,t,B,C,x){a=a.parentNode.style;a.color=b;a.fontFamily=c;a.fontSize=d;a.fontSizeAdjust=e;a.fontStyle=f;a.fontStretch=m;a.fontVariant=u;a.fontWeight=t;a.lineHeight=B;a.textAlign=C;a.textDecoration=x},stringValidateNumberValue:function(a){var b="";"undefined"!==typeof a&&Z.Utils.stringValidate(a)&&(b=a.replace(/(?!^-)[^0-9.]/g,
""),b=Z.Utils.stringRemoveLeadingZeros(b),b=Z.Utils.stringRemoveDuplicateDots(b));return b},stringValidateColorValue:function(a){Z.Utils.stringValidate(a)||(a="#000000");0!=a.indexOf("#")&&(a="#"+a);return a},hexToRGB:function(a){a=a.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(a,c,d,e){return c+c+d+d+e+e});return(a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a))?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null},htmlGetSelection:function(){var a="";if("undefined"!=typeof window.getSelection){var b=
window.getSelection();if(b.rangeCount){for(var a=document.createElement("div"),c=0,d=b.rangeCount;c<d;++c)a.appendChild(b.getRangeAt(c).cloneContents());a=a.innerHTML}}else"undefined"!=typeof document.selection&&"Text"==document.selection.type&&(a=document.selection.createRange().htmlText);return a},htmlHighlightSelection:function(a){Z.Utils.htmlReplaceSelection(Z.Utils.getResource("DEFAULT_NARRATIVEHIGHLIGHTSTART")+a+Z.Utils.getResource("DEFAULT_NARRATIVEHIGHLIGHTEND"))},htmlClearHighlight:function(a){a&&
(a=a.replace(Z.Utils.getResource("DEFAULT_NARRATIVEHIGHLIGHTSTART"),"").replace(Z.Utils.getResource("DEFAULT_NARRATIVEHIGHLIGHTEND"),""));return a},htmlCreateURLLink:function(a,b,c,d){a&&(c=Z.Utils.stringRemoveTrailingSpace(c),d=Z.Utils.stringValidateURLScheme(d),d='<a href="'+d+'" target="_blank" >'+c+"</a>",a=a.substring(0,b)+d+a.substring(b+c.length));return a},htmlClearLinkFromSelection:function(){var a=Z.Utils.htmlGetSelection();if(Z.Utils.stringValidate(a)){var b=null;-1!=a.indexOf(".zif');\">")?
b=a.indexOf("zif');\">")+8:-1!=a.indexOf('_blank">')?b=a.indexOf('_blank">')+8:-1!=a.indexOf('clearLabelHighlightsAll(true)">')&&(b=a.indexOf('clearLabelHighlightsAll(true)">')+23);if(b){var c=a.indexOf("</a>");Z.Utils.htmlReplaceSelection(a.substring(b,c))}}},htmlReplaceSelection:function(a){if(a){var b;if(window.getSelection&&window.getSelection().getRangeAt){b=window.getSelection().getRangeAt(0);b.deleteContents();var c=document.createElement("div");c.innerHTML=a;a=document.createDocumentFragment();
for(var d;d=c.firstChild;)a.appendChild(d);b.insertNode(a)}else document.selection&&document.selection.createRange&&(b=document.selection.createRange(),b.pasteHTML(a))}},htmlClearSelection:function(){document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges()},htmlGetSelectionParagraphNode:function(){var a=null,b=window.getSelection?window.getSelection():document.selection?document.selection.createRange():null;if(b){for(b=b.anchorNode;null!=b&&"p"!=b.localName&&
"P"!=b.localName;)b=b.parentNode;b&&(a=b)}return a},htmlGetSelectionParagraphText:function(){var a="";Z.Utils.htmlGetSelectionParagraphNode()&&(a=parent.innerText||parent.textContent);return a},xmlConvertTextToDoc:function(a){var b=null;if(window.ActiveXObject)try{b=new ActiveXObject("Microsoft.XMLDOM"),b.async=!1,b.loadXML(a)}catch(c){this.showMessage(c.name+this.getResource("z244")+c.message)}else if(window.DOMParser)try{b=(new DOMParser).parseFromString(a,"text/xml")}catch(c){this.showMessage(c.name+
this.getResource("z244")+c.message)}else this.showMessage(this.getResource("z294"));return b},xmlConvertDocToText:function(a){var b=null;if(window.ActiveXObject)try{b=a.xml}catch(c){this.showMessage(c.name+this.getResource("z243")+c.message)}else if(window.DOMParser)try{b=(new XMLSerializer).serializeToString(a)}catch(c){this.showMessage(c.name+this.getResource("z243")+c.message)}else this.showMessage(this.getResource("z294"));return b},xmlEscapeMinimal:function(a){var b=null;"undefined"!==typeof a&&
null!==a&&(b=a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/\r?\n/g,"%0A"));return b},xmlUnescapeMinimal:function(a){var b=null;"undefined"!==typeof a&&null!==a&&(b=a.replace(/%0A/g,"\n").replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&"));return b},xmlEscapeMore:function(a){var b=null;"undefined"!==typeof a&&null!==a&&(b=a.replace(/&/g,"&amp;").replace(/;/g,"&semi;").replace(/</g,
"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/\r?\n/g,"%0A").replace(/,/g,"&comma;").replace(/:/g,"&colon;"));return b},xmlUnescapeMore:function(a){var b=null;"undefined"!==typeof a&&null!==a&&(b=a.replace(/&colon;/g,":").replace(/&comma;/g,",").replace(/%0A/g,"\n").replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&semi;/g,";").replace(/&amp;/g,"&"));return b},xmlEscapingConvertURIToHTML:function(a){var b=null;"undefined"!==
typeof a&&null!==a&&(b=a.replace(/%0A/g,"\n").replace(/%40/g,"&#64;").replace(/%23/g,"&#35;").replace(/%24/g,"&#36;").replace(/%25/g,"&#37;").replace(/%5E/g,"&#94;").replace(/%26/g,"&#38;").replace(/%3D/g,"&#61;").replace(/%2B/g,"&#43;").replace(/%3A/g,"&#58;").replace(/%3B/g,"&#59;").replace(/%22/g,"&#34;").replace(/%5C/g,"&#92;").replace(/%2F/g,"&#47;").replace(/%3F/g,"&#63;").replace(/%3C/g,"&#60;").replace(/%3E/g,"&#62;").replace(/%5B/g,"&#91;").replace(/%5D/g,"&#93;").replace(/%7B/g,"&#123;").replace(/%7D/g,
"&#125;").replace(/%60/g,"&#96;").replace(/%27/g,"&#39;"));return b},xmlEscapingConvertHTMLToURI:function(a){var b=null;"undefined"!==typeof a&&null!==a&&(b=a.replace(/\n/g,"%0A").replace(/&apos;/g,"%27").replace(/&quot;/g,"%22").replace(/&gt;/g,"%3E").replace(/&lt;/g,"%3C").replace(/&amp;/g,"%26").replace(/&#64;/g,"%40").replace(/&#35;/g,"%23").replace(/&#36;/g,"%24").replace(/&#37;/g,"%25").replace(/&#94;/g,"%5E").replace(/&#38;/g,"%26").replace(/&#61;/g,"%3D").replace(/&#43;/g,"%2B").replace(/&#58;/g,
"%3A").replace(/&#59;/g,"%3B").replace(/&#34;/g,"%22").replace(/&#92;/g,"%5C").replace(/&#47;/g,"%2F").replace(/&#63;/g,"%3F").replace(/&#60;/g,"%3C").replace(/&#62;/g,"%3E").replace(/&#91;/g,"%5B").replace(/&#93;/g,"%5D").replace(/&#123;/g,"%7B").replace(/&#125;/g,"%7D").replace(/&#96;/g,"%60").replace(/&#39;/g,"%27"));return b},jsonConvertObjectToDataProvider:function(a){for(var b=[],c=0,d=a.length;c<d;c++){var e=a[c],e=e.substring(e.indexOf("../../")+6,e.length),f=e.substring(e.lastIndexOf("/")+
1,e.lastIndexOf("."));b[b.length]={text:f,value:e,poiID:"0"}}return b},jsonConvertObjectToXMLText:function(a){var b=function(a,c){var d="";if(a instanceof Array)for(var u=0,t=a.length;u<t;u++)d+=b(a[u],c)+"\n";else if("object"===typeof a){u=!1;d+="<"+c;for(t in a)"object"!==typeof a[t]?d+=" "+t+'="'+a[t].toString()+'"':u=!0;d+=">";if(u)for(t in a)"#text"==t?d+=a[t]:"object"===typeof a[t]&&(d+=b(a[t],t));d+="</"+c+">"}else d+="<"+c+">"+a.toString()+"</"+c+">";return d},c="",d;for(d in a)c+=b(a[d],
d);return c.replace(/&/g,"&amp;").replace(/\t|\n/g,"")},jsonConvertXMLTextToJSONText:function(a){var b={convertToObject:function(a){var d={};if(1==a.nodeType){if(a.attributes.length)for(var e=0,f=a.attributes.length;e<f;e++)d[a.attributes[e].nodeName]=(a.attributes[e].nodeValue||"").toString();if(a.firstChild){for(var e=0,f=!1,m=a.firstChild;m;m=m.nextSibling)1==m.nodeType?f=!0:3==m.nodeType&&m.nodeValue.match(/[^ \f\n\r\t\v]/)&&e++;if(f)if(2>e)for(b.reduceWhitespace(a),m=a.firstChild;m;m=m.nextSibling)3==
m.nodeType?d["#text"]=b.escapeMinimal(m.nodeValue):d[m.nodeName]?d[m.nodeName]instanceof Array?d[m.nodeName][d[m.nodeName].length]=b.convertToObject(m):d[m.nodeName]=[d[m.nodeName],b.convertToObject(m)]:d[m.nodeName]=b.convertToObject(m);else a.attributes.length?d["#text"]=b.escapeMinimal(b.innerXML(a)):d=b.escapeMinimal(b.innerXML(a));else e&&(a.attributes.length?d["#text"]=b.escapeMinimal(b.innerXML(a)):d=b.escapeMinimal(b.innerXML(a)))}a.attributes.length||a.firstChild||(d=null)}else 9==a.nodeType?
d=b.convertToObject(a.documentElement):alert("This node type not supported : "+a.nodeType);return d},convertToJSONText:function(a,d){var e=d?'"'+d+'"':"";if(a instanceof Array){for(var f=0,m=a.length;f<m;f++)a[f]=b.convertToJSONText(a[f],"","\t");e+=(d?":[":"[")+(1<a.length?"\n\t"+a.join(",\n\t")+"\n":a.join(""))+"]"}else if(null==a)e+=(d&&":")+"null";else if("object"===typeof a){f=[];for(m in a)f[f.length]=b.convertToJSONText(a[m],m,"\t");e+=(d?":{":"{")+(1<f.length?"\n\t"+f.join(",\n\t")+"\n":f.join(""))+
"}"}else e="string"==typeof a?e+((d&&":")+'"'+a.toString()+'"'):e+((d&&":")+a.toString());return e},reduceWhitespace:function(a){a.normalize();for(var d=a.firstChild;d;)if(3==d.nodeType)if(d.nodeValue.match(/[^ \f\n\r\t\v]/))d=d.nextSibling;else{var e=d.nextSibling;a.removeChild(d);d=e}else 1==d.nodeType&&b.reduceWhitespace(d),d=d.nextSibling;return a},escapeMinimal:function(a){return a.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},innerXML:function(a){var b=
"";if("innerHTML"in a)b=a.innerHTML;else{var e=function(a){var b="";if(1==a.nodeType){for(var b=b+("<"+a.nodeName),c=0,d=a.attributes.length;c<d;c++)b+=" "+a.attributes[c].nodeName+"='"+(a.attributes[c].nodeValue||"").toString()+"'";if(a.firstChild){b+=">";for(c=a.firstChild;c;c=c.nextSibling)b+=e(c);b+="</"+a.nodeName+">"}else b+="/>"}else 3==a.nodeType&&(b+=a.nodeValue);return b};for(a=a.firstChild;a;a=a.nextSibling)b+=e(a)}return b}};9==a.nodeType&&(xml=xml.documentElement);return jsonTextOut=
"{\n  "+b.convertToJSONText(b.convertToObject(b.reduceWhitespace(a)),a.nodeName,"\t").replace(/\t/g,"  ")+"\n}"},arrayClear:function(a){if(a)for(;0<a.length;)a.pop()},arrayClearObjectValue:function(a,b){for(var c=0,d=a.length;c<d;c++)a[c][b]=null},arrayClone:function(a,b,c){c=[];switch(a){case "pois":a=0;for(var d=b.length;a<d;a++)c[c.length]={text:b[a].text,value:b[a].value,id:b[a].id,x:b[a].x,y:b[a].y,z:b[a].z,user:b[a].user,date:b[a].date,editable:b[a].editable};break;case "labels":a=0;for(d=b.length;a<
d;a++)c[c.length]={text:b[a].text,value:b[a].value,poiID:b[a].poiID,editable:b[a].editable};break;case "hotspots":a=0;for(d=b.length;a<d;a++)c[c.length]={id:b[a].id,name:b[a].name,mediaType:b[a].mediaType,media:b[a].media,audio:b[a].audio,x:b[a].x,y:b[a].y,z:b[a].z,xScale:b[a].xScale,yScale:b[a].yScale,radius:b[a].radius,zMin:b[a].zMin,zMax:b[a].zMax,clickURL:b[a].clickURL,urlTarget:b[a].urlTarget,rollover:b[a].rollover,caption:b[a].caption,tooltip:b[a].tooltip,textColor:b[a].textColor,backColor:b[a].backColor,
lineColor:b[a].lineColor,fillColor:b[a].fillColor,textVisible:b[a].textVisible,backVisible:b[a].backVisible,lineVisible:b[a].lineVisible,fillVisible:b[a].fillVisible,captionPosition:b[a].captionPosition,saved:b[a].saved,visibility:b[a].visibility,internalID:b[a].internalID,poiID:b[a].poiID,captionHTML:b[a].captionHTML,tooltipHTML:b[a].tooltipHTML,polyClosed:b[a].polyClosed,polygonPts:b[a].polygonPts,showFor:b[a].showFor,transition:b[a].transition,changeFor:b[a].changeFor,rotation:b[a].rotation,editable:b[a].editable,
popup:b[a].popup,popupOffsetX:b[a].popupOffsetX,popupOffsetY:b[a].popupOffsetY,comment:b[a].comment,user:b[a].user,date:b[a].date,w:b[a].w,h:b[a].h,image:b[a].image,lineStyle:b[a].lineStyle};break;case "polygon":a=0;for(d=b.length;a<d;a++)c[c.length]={x:b[a].x,y:b[a].y};break;case "notes":a=0;for(d=b.length;a<d;a++)c[c.length]={text:b[a].text,value:b[a].value,noteText:b[a].noteText,poiID:b[a].poiID,id:b[a].id,user:b[a].user,date:b[a].date,editable:b[a].editable};break;case "magnifications":for(a=
0,d=b.length;a<d;a++)c[c.length]={text:b[a].text,value:b[a].value}}return c},arrayImageLoadingValidate:function(a){var b=!1;if(a&&0<a.length)for(var b=!0,c=0,d=a.length;c<d;c++)if(null===a[c]||0==a[c].image.width||0==a[c].image.height)b=!1;return b},arrayIndexOf:function(a,b,c){c?0>c&&(c=Math.max(0,a.length+c)):c=0;for(var d=a.length;c<d;c++)if(a[c]===b)return c;return-1},arrayIndexOfObjectValue:function(a,b,c,d){if("undefined"!==typeof a){d?0>d&&(d=Math.max(0,a.length+d)):d=0;for(var e=a.length;d<
e;d++)if(a[d][b]===c)return d}return-1},arrayIndexOfObjectTwoValues:function(a,b,c,d,e,f){if("undefined"!==typeof a){d?0>d&&(d=Math.max(0,a.length+d)):d=0;for(var m=a.length;d<m;d++)if(a[d][b]===c&&a[d][e].toString()===f.toString())return d}return-1},arrayIndexOfSubstring:function(a,b,c){c?0>c&&(c=Math.max(0,a.length+c)):c=0;for(var d=a.length;c<d;c++)if(-1!=a[c].indexOf(b))return c;return-1},arrayIndexOfObjectValueSubstring:function(a,b,c,d,e){d?0>d&&(d=Math.max(0,a.length+d)):d=0;for(var f=a.length;d<
f;d++)if(e){if(-1!=a[d][b].toLowerCase().indexOf(c))return d}else if(-1!=a[d][b].indexOf(c))return d;return-1},arrayIntersect:function(a,b){for(var c,d,e,f=[],m=0,u=a.length;m<u;m++){c=a[m];e=!1;for(var t=0,B=b.length;t<B&&c>=(d=b[t]);t++)if(d==c){e=!0;break}e&&(f[f.length]=a[m])}return f},arrayMap:function(a,b){var c=[];if(Z.arrayMapSupported)c=a.map(b);else for(var d=0,e=a.length;d<e;d++)c[d]=b(a[d]);return c},arraySplice:function(a,b,c){if(Z.arraySpliceSupported)if(3<arguments.length)for(var d=
3,e=arguments.length;d<e;d++)a.splice(b,c,arguments[d]);else a.splice(b,c);else{0>c&&(c=0);var f=[];if(3<arguments.length)for(d=3,e=arguments.length;d<e;d++)f[f.length]=arguments[d];for(var d=Z.Utils.arraySubarray(a,0,b),m=Z.Utils.arraySubarrayLen(a,b,c),e=Z.Utils.arraySubarray(a,b+c),f=d.concat(f,e),d=a.length=0,e=f.length;d<e;d++)a[a.length]=f[d];a=m}return a},arraySubarraySimple:function(a,b){return this.slice(a,b)},arraySortNumericAscending:function(a,b,c){a.sort(function(a,b){return a-b});return a},
arraySortNumericDescending:function(a,b,c){a.sort(function(a,b){return b-a});return a},arraySortByObjectValue:function(a,b,c,d){a.sort(function(a,c){return a[b]>c[b]});return a},arraySubarray:function(a,b,c){0>b&&(b=0);if(!c||c>a.length)c=a.length;if(b==c)return[];for(var d=[];b<c;b++)d[d.length]=a[b];return d},arraySubarrayLen:function(a,b,c){if(b>=a.length||c&&0>=c)return[];0>b&&(b=Math.abs(b)>a.length?0:a.length+b);if(!c||c+b>a.length)c=a.length-b;for(var d=[],e=b;e<b+c;e++)d[d.length]=a[e];return d},
arraySubtract:function(a,b){for(var c=a.slice(0),d=0,e=c.length;d<e;d++){for(var f=c[d],m=!1,u=0,t=b.length;u<t&&f>=(elmt2=b[u]);u++)if(elmt2==f){m=!0;break}m&&(c=Z.Utils.arraySplice(c,d--,1))}return c},arrayToArrayOfStrings:function(a){for(var b=[],c=0,d=a.length;c<d;c++)b[c]="undefined"!==typeof a[c]&&"undefined"!=a[c]&&null!==a[c]?a[c].toString():"";return b},arrayUnique:function(a){for(var b=1;b<a.length;)a[b-1]==a[b]?a=Z.Utils.arraySplice(a,b,1):b++;return a},arrayUniqueByObjectValue:function(a,
b){if("undefined"!==typeof a)for(var c=1;c<a.length;)a[c-1][b]==a[c][b]?a=Z.Utils.arraySplice(a,c,1):c++;return a},dataSlice:function(a,b,c){var d=c-b;c=new ArrayBuffer(c-b);c=new Uint8Array(c);for(var e=0;e<d;e++)c[e]=a[b+e];return c},convertZoomPercentToMagnification:function(a,b,c){a=a*b/100;c&&(a=1.5>a?1.25:2>a?1.5:2.5>a?2:4>a?2.5:5>a?4:10>a?5:16>a?10:20>a?16:25>a?20:32>a?25:40>a?32:50>a?40:60>a?50:100>a?60:150>a?100:250>a?150:250);return a},calculatePointsDistance:function(a,b,c,d){return Math.sqrt((a-=
c)*a+(b-=d)*b)},convertPixelsToUnits:function(a,b,c){var d=1;"undefined"!==typeof b&&null!==b&&0!=b?d=b:"undefined"!==typeof c&&null!==c&&0!=c&&(d=Z.imageW/c);return a/d},polygonArea:function(a,b,c,d){if("undefined"===typeof d||null===d)d=4;a=a.slice(0);b?a[a.length]={x:a[0].x,y:a[0].y}:"undefined"!==typeof c&&null!==c&&(a[a.length]={x:c.x,y:c.y});for(var e=c=b=0,f=a.length-1;e<f;e++)b+=a[e].x*a[e+1].y,c+=a[e].y*a[e+1].x;a=Z.Utils.convertPixelsToUnits((b-c)/2,Z.pixelsPerUnit,Z.unitsPerImage);a=Z.Utils.convertPixelsToUnits(a,
Z.pixelsPerUnit,Z.unitsPerImage);return a=Z.Utils.roundToFixed(Math.abs(a),d)},polygonCenter:function(a,b,c,d){var e=0,f=0;if("undefined"!==typeof a&&null!==a&&0<a.length)if(f=a.slice(0),d)if(2==a.length)e=f[0],f=f[1];else{f[f.length]=[f[0][0],f[0][1]];e=f[0];c=e[0];a=e[1];d=e[0];b=e[1];for(var m=1,u=f.length;m<u;m++)e=f[m],c=Math.min(c,e[0]),a=Math.min(a,e[1]),d=Math.max(d,e[0]),b=Math.max(b,e[1]);e=c+(d-c)/2;f=a+(b-a)/2}else{b?f[f.length]={x:f[0].x,y:f[0].y}:"undefined"!==typeof c&&null!==c&&(f[f.length]=
{x:c.x,y:c.y});e=f[0];c=e.x;a=e.y;d=e.x;b=e.y;m=1;for(u=f.length;m<u;m++)e=f[m],c=Math.min(c,e.x),a=Math.min(a,e.y),d=Math.max(d,e.x),b=Math.max(b,e.y);e=c+(d-c)/2;f=a+(b-a)/2}return new Z.Utils.Point(e,f)},PolygonDimensions:function(a,b){var c=0,d=0;if("undefined"!==typeof a&&null!==a&&0<a.length){c=a.slice(0);"undefined"!==typeof b&&null!==b&&(c[c.length]={x:b.x+.1*(c[c.length-1].x-b.x),y:b.y+.1*(c[c.length-1].y-b.y)});for(var e=c[0].x,d=c[0].y,f=c[0].x,m=c[0].y,u=1,t=c.length;u<t;u++)c[u].x<e&&
(e=c[u].x),c[u].x>f&&(f=c[u].x),c[u].y<d&&(d=c[u].y),c[u].y>m&&(m=c[u].y);c=f-e;d=m-d}this.w=c;this.h=d},polygonPerimeter:function(a,b,c,d){if("undefined"===typeof d||null===d)d=5;a=a.slice(0);b?a[a.length]={x:a[0].x,y:a[0].y}:"undefined"!==typeof c&&null!==c&&(a[a.length]={x:c.x,y:c.y});c=b=0;for(var e=a.length-1;c<e;c++)b+=Z.Utils.calculatePointsDistance(a[c].x,a[c].y,a[c+1].x,a[c+1].y);b=Z.Utils.convertPixelsToUnits(b,Z.pixelsPerUnit,Z.unitsPerImage);return b=Z.Utils.roundToFixed(Math.abs(b),d)},
fullScreenView:function(a,b,c){if("undefined"===typeof c||null===c)c=!1;if(b){b=document.documentElement;var d=null;b.requestFullScreen?(a.requestFullScreen(),d="fullscreenchange"):b.mozRequestFullScreen?(a.mozRequestFullScreen(),d="mozfullscreenchange"):b.webkitRequestFullScreen?(a.webkitRequestFullScreen(),d="webkitfullscreenchange"):b.msRequestFullscreen&&(a.msRequestFullscreen(),d="MSFullscreenChange");d&&Z.Utils.addEventListener(document,d,Z.Viewport.fullScreenEscapeHandler)}else document.cancelFullScreen?
(c||document.cancelFullScreen(),d="fullscreenchange"):document.mozCancelFullScreen?(c||document.mozCancelFullScreen(),d="mozfullscreenchange"):document.webkitCancelFullScreen?(c||document.webkitCancelFullScreen(),d="webkitfullscreenchange"):document.msExitFullscreen&&(c||document.msExitFullscreen(),d="MSFullscreenChange"),d&&Z.Utils.removeEventListener(document,d,Z.Viewport.fullScreenEscapeHandler)},rotatePoint:function(a,b,c){var d=Math.PI/180*-c;c=a*Math.cos(d)-b*Math.sin(d);a=a*Math.sin(d)+b*Math.cos(d);
return new Z.Utils.Point(c,a)},rotatePointOffCenter:function(a,b,c,d,e){e=e*Math.PI/180;c-=a;var f=d-b;d=c*Math.cos(e)-f*Math.sin(e);e=c*Math.sin(e)+f*Math.cos(e);return new Z.Utils.Point(d+a,e+b)},rotateElement:function(a,b,c){if(b!=Z.imageR||c)b="rotate("+b.toString()+"deg)",a.transform=b,a.msTransform=b,a.mozTransform=b,a.webkitTransform=b,a.oTransform=b},getElementRotation:function(a){a=window.getComputedStyle(a,null);var b=(a.getPropertyValue("-webkit-transform")||a.getPropertyValue("-moz-transform")||
a.getPropertyValue("-ms-transform")||a.getPropertyValue("-o-transform")||a.getPropertyValue("transform")||"error failure").split("(")[1],b=b.split(")")[0],b=b.split(",");a=b[0];b=b[1];a=Math.sqrt(a*a+b*b);return Math.round(Math.asin(b/a)*(180/Math.PI))},getPositionRotated:function(a,b,c,d,e){if("undefined"===typeof e||null===e)e=Z.imageR;0>e&&(e+=360);e=e*Math.PI/180;a-=c;var f=b-d;b=a*Math.cos(e)-f*Math.sin(e);e=a*Math.sin(e)+f*Math.cos(e);c=Math.round(b+c);d=Math.round(e+d);return new Z.Utils.Point(c,
d)},getDisplayPositionRotated:function(a,b){if("undefined"===typeof b||null===b)b=Z.imageR;0>b&&(b+=360);var c=parseFloat(a.left),d=parseFloat(a.top),e=parseFloat(a.width),f=parseFloat(a.height);return Z.Utils.getPositionRotated(c,d,c+e/2,d+f/2,b)},translateElement:function(a,b,c){b="translate("+b.toString()+"px,"+c.toString()+"px)";a.transform=b;a.msTransform=b;a.mozTransform=b;a.webkitTransform=b;a.oTransform=b},scaleElement:function(a,b){var c="scale("+b.toString()+")";a.transform=c;a.msTransform=
c;a.mozTransform=c;a.webkitTransform=c;a.oTransform=c},updateRotationForLegacyMedia:function(a){var b=0;switch(a){case "arrowDownLeft":b+=45;break;case "arrowLeft":b+=90;break;case "arrowUpLeft":b+=135;break;case "arrowUp":b+=180;break;case "arrowUpRight":b+=225;break;case "arrowRight":b+=270;break;case "arrowDownRight":b+=315;break;case "lineHorizontal":b+=90}return b},intValue:function(a,b,c){var d=null;return d=c?(a[b+3]+(a[b+2]<<8)|a[b+1]<<16)+16777216*a[b]:(a[b]+(a[b+1]<<8)|a[b+2]<<16)+16777216*
a[b+3]},longValue:function(a,b,c){var d=null;if(c){d=0;c=1;for(var e=0;8>e;e++)d+=a[b+7-e]*c,c*=256}else d=(a[b]+(a[b+1]<<8)|a[b+2]<<16)+16777216*a[b+3],0!=a[b+4]&&(d+=4294967296*a[b+4]);return d},shortValue:function(a,b){return a[b]+(a[b+1]<<8)},createUint8Array:function(a,b){return Z.uInt8ArraySupported?new Uint8Array(a,b):new Z.Utils.TypedArray(a,b)},TypedArray:function(a){var b;if("number"===typeof a){b=Array(a);for(var c=0;c<a;++c)b[c]=0}else b=a.slice(0);b.subarray=Z.Utils.arraySubarraySimple;
b.buffer=b;b.byteLength=b.length;b.set=Z.Utils.setSimple;"object"===typeof a&&a.buffer&&(b.buffer=a.buffer);return b},setSimple:function(a,b){2>arguments.length&&(b=0);for(var c=0,d=a.length;c<d;++c,++b)this[b]=a[c]&255},encodeBase64:function(a){var b,c,d,e,f=0,m=0,u="",u=[];if(!a)return a;do b=a[f++],c=a[f++],d=a[f++],e=b<<16|c<<8|d,b=e>>18&63,c=e>>12&63,d=e>>6&63,e&=63,u[m++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c)+
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e);while(f<a.length);u=u.join("");a=a.length%3;return(a?u.slice(0,a-3):u)+"===".slice(a||3)},validateResponseArrayFunctionality:function(){"ZoomifyZIFFile"!=Z.tileSource&&("ZoomifyPFFFile"!=Z.tileSource||null!==Z.tileHandlerPathFull)||Z.responseArraySupported||Z.responseArrayPrototyped||(Z.Utils.defineObjectProperty(XMLHttpRequest.prototype,"response",
{get:function(){return(new VBArray(this.responseBody)).toArray()}}),Z.responseArrayPrototyped=!0)},setObjectProperty:function(a,b,c){-1!=Z.definedObjectPropertiesArr.indexOf(b)?a[b]=c.value:(Z.Utils.defineObjectProperty(a,b,c),Z.definedObjectPropertiesArr[Z.definedObjectPropertiesArr.length]=b)},defineObjectProperty:function(a,b,c){Z.definePropertySupported?Object.defineProperty(a,b,c):(delete a[b],"get"in c&&a.__defineGetter__(b,c.get),"set"in c&&a.__defineSetter__(b,c.set),"value"in c&&(a.__defineSetter__(b,
function(a){this.__defineGetter__(b,function(){return a});return a}),a[b]=c.value))},createImageElementFromBytes:function(a,b){function c(a){d.onload=null;d.onabort=null;d.onerror=null;e&&window.clearTimeout(e);window.setTimeout(function(){b(d)},1)}var d=new Image,e=null,f=parseFloat(this.getResource("z139")),m=function(){c(!1)};d.onload=function(){c(!0)};d.onabort=m;d.onerror=m;e=window.setTimeout(function(){console.log(Z.Utils.getResource("z253"));c(!1)},f);d.src=a},getCurrentUTCDateAsString:function(){var a=
new Date,b=a.getUTCFullYear(),c=(10>a.getUTCMonth()+1?"0":"")+(a.getUTCMonth()+1),d=(10>a.getUTCDate()?"0":"")+a.getUTCDate(),e=(10>a.getUTCHours()?"0":"")+a.getUTCHours(),f=(10>a.getUTCMinutes()?"0":"")+a.getUTCMinutes(),a=(10>a.getUTCSeconds()?"0":"")+a.getUTCSeconds();return b+c+d+"-"+e+f+a},cacheProofPath:function(a){a+="?t"+(new Date).getTime().toString()+"n"+Z.cacheProofCounter.toString();Z.cacheProofCounter+=1;return a},easing:function(a,b,c,d,e){if("undefined"===typeof e||null===e)e=Z.smoothZoomEasing;
var f=b;if(Z.smoothZoom&&1<e)switch(e){case 2:c/=d;c--;f=(b-a)*(c*c*c*c*c+1)+a;break;case 3:f=(b-a)*(-Math.pow(2,-10*c/d)+1)+a;break;case 4:b-=a,f=1>(c/=d/2)?b/2*c*c*c*c*c+a:b/2*((c-=2)*c*c*c*c+2)+a}return f},functionCallWithDelay:function(a,b){window.setTimeout(a,b)},nodeIsInViewer:function(a){for(var b=!1;0==b;)if(a)a.id?"ViewerDisplay"==a.id?b=!0:a=a.parentNode:a=a.parentNode;else break;return b},pointIsInViewer:function(a){var b=!1,c=document.getElementById(Z.pageContainerID);if(c){var d=parseFloat(Z.Utils.getElementStyleProperty(c,
"width")),e=parseFloat(Z.Utils.getElementStyleProperty(c,"height")),f=Z.Utils.getElementPosition(c);isNaN(d)||isNaN(e)||isNaN(f.x)||isNaN(f.y)||(c=f.x,f=f.y,a.x>c&&a.x<c+d&&a.y>f&&a.y<f+e&&(b=!0))}return b},roundToFixed:function(a,b){var c=Math.round(a).toString().length,c=b-c,c=Math.pow(10,0>c?0:c);return a=Math.round(a*c)/c},getRandomInt:function(a,b){return Math.floor(Math.random()*(b-a+1))+a},getSign:function(a){return a?0>a?-1:1:0},drawCrosshairs:function(a,b,c,d){if("undefined"===typeof a||
null===a)a=Z.ViewerDisplay;if("undefined"===typeof b||null===b)b=Z.viewportCurrent.getViewW();if("undefined"===typeof c||null===c)c=Z.viewportCurrent.getViewH();if("undefined"===typeof d||null===d)d="#696969";var e=document.getElementById("viewportCenterLineHorizontal"),f=document.getElementById("viewportCenterLineVertical");(f||e)&&Z.Utils.hideCrosshairs();e=Z.Utils.createContainerElement("div","viewportCenterLineHorizontal","inline-block","absolute","visible",b+"px","1px","0px",c/2+"px","solid",
"1px","transparent","0px","0px","normal",null,!0,d);f=Z.Utils.createContainerElement("div","viewportCenterLineVertical","inline-block","absolute","visible","1px",c+"px",b/2+"px","0px","solid","1px","transparent","0px","0px","normal",null,!0,d);a.appendChild(e);a.appendChild(f)},hideCrosshairs:function(a){if("undefined"===typeof a||null===a)a=Z.ViewerDisplay;var b=document.getElementById("viewportCenterLineHorizontal"),c=document.getElementById("viewportCenterLineVertical");b&&a.removeChild(c);c&&
a.removeChild(b)},configureHelpDisplay:function(){var a=Z.helpW,b=Z.helpH;a>=Z.viewerW&&(a=Z.viewerW-80);b>=Z.viewerH&&(b=Z.viewerH-80);var c=Z.helpL?Z.helpL:(Z.viewerW-a)/2,d=Z.helpT?Z.helpT:(Z.viewerH-b)/2,e=this.getResource("UI_HELPSCREENCOLOR"),f=this.getResource("UI_HELPBUTTONCOLOR");Z.HelpDisplay=this.createContainerElement("div","HelpDisplay","inline-block","absolute","hidden",a+"px",b+"px",c+"px",d+"px","solid","1px",e,"0px","0px","normal",null,!0);Z.ViewerDisplay.appendChild(Z.HelpDisplay);
c=Z.Utils.createContainerElement("div","helpTextBox","inline-block","absolute","auto",a-50+"px",b-74+"px","4px","4px","solid","1px","white","0px","20px",null);c.style.overflowY=Z.mobileDevice?"scroll":"auto";Z.HelpDisplay.appendChild(c);Z.help=document.getElementById("helpTextBox");Z.HelpDisplay.style.zIndex=(Z.baseZIndex+38).toString();b=b-18-5;a-=66;c=this.getResource("z423");f=new Z.Utils.Button("buttonHelpOk",c,null,null,null,null,"56px","18px",a+"px",b+"px","mousedown",this.helpOkButtonHandler,
"z342OK","solid","1px",f,"0px","0px");Z.HelpDisplay.appendChild(f.elmt);Z.HelpDisplay.style.display="none"},helpOkButtonHandler:function(a){Z.Utils.hideHelp();return!0},showHelp:function(a){Z.HelpDisplay||Z.Utils.configureHelpDisplay();Z.help&&(Z.help.innerHTML=Z.helpCustom?Z.helpContent:unescape(a),Z.HelpDisplay.style.display="inline-block"!=Z.HelpDisplay.style.display?"inline-block":"none",document.getElementById("buttonHelpOk").style.display="inline-block")},hideHelp:function(){Z.HelpDisplay.style.display=
"none"},configureMessageDisplay:function(){var a=parseInt(this.getResource("z437"),10),b=parseInt(this.getResource("z436"),10),c=Z.Utils.getMessageDisplayCoords("6",a,Z.viewerW,Z.viewerH),d=this.getResource("z159"),e=this.getResource("z158");Z.MessageDisplay=this.createContainerElement("div","MessageDisplay","inline-block","absolute","auto",a+"px",b+"px",c.x+"px",c.y+"px","solid","1px",d,"0px","0px","normal",null,!0);Z.ViewerDisplay.appendChild(Z.MessageDisplay);Z.MessageDisplay.style.zIndex=(Z.baseZIndex+
40).toString();c=Z.Utils.createTextElement("messageBox","",a-18+"px",b-40+"px","4px","4px","4px","solid","1px",!0,"verdana","12px","none",null,1,"auto","auto",null);Z.MessageDisplay.appendChild(c);Z.messages=document.getElementById("messageBox");b=b-18-5;a-=66;c=this.getResource("z438");e=new Z.Utils.Button("buttonMessageOk",c,null,null,null,null,"56px","18px",a+"px",b+"px","mousedown",this.messageOkButtonHandler,"z362","solid","1px",e,"0px","0px");Z.MessageDisplay.appendChild(e.elmt)},getMessageDisplayCoords:function(a,
b,c,d){switch(a){case "1":d=a=40;break;case "2":a=c/2-b/2;d=40;break;case "3":a=c-b-80;d=40;break;case "4":a=c-b-40;d=0<Z.toolbarVisible&&8!=Z.toolbarVisible?d-120:d-80;break;case "5":a=c/2-b/2;d=0<Z.toolbarVisible&&8!=Z.toolbarVisible?d-120:d-80;break;case "6":a=40;d=0<Z.toolbarVisible&&8!=Z.toolbarVisible?d-120:d-80;break;default:a=c-b,d=40}return new Z.Utils.Point(a,d)},messageOkButtonHandler:function(a){Z.Utils.hideMessage();Z.Viewport&&Z.coordinatesVisible&&Z.Viewport.setCoordinatesDisplayVisibility(!1);
return!0},messageCancelButtonHandler:function(a){Z.Utils.hideMessage();return!1},showMessage:function(a,b,c,d,e,f){if(Z.messagesVisible){Z.MessageDisplay||Z.Utils.configureMessageDisplay();if("undefined"===typeof f||null===f)f="6";var m=parseInt(this.getResource("z437"),10);f=Z.Utils.getMessageDisplayCoords(f,m,Z.viewerW,Z.viewerH);Z.MessageDisplay.style.left=f.x+"px";Z.MessageDisplay.style.top=f.y+"px";Z.MessageDisplay.messageTimer&&Z.Utils.hideMessageTimerHandler();f=!0;e&&(-1!=Z.Utils.arrayIndexOf(Z.messageDisplayList,
a)?f=!1:Z.messageDisplayList[Z.messageDisplayList.length]=a);if(f&&(Z.messages&&(Z.messages.value=a),Z.MessageDisplay.style.display="inline-block","undefined"!==typeof d&&null!==d&&(a=document.getElementById("textBoxFor-messageBox"))&&(a.firstChild.style.textAlign=d),d=document.getElementById("buttonMessageOk"),a=parseInt(this.getResource("z436"),10),"undefined"!==typeof b&&null!==b&&b?(d.style.display="inline-block",Z.MessageDisplay.style.height=a+"px"):(d.style.display="none",Z.MessageDisplay.style.height=
a-22+"px"),"undefined"!==typeof c&&null!==c&&!isNaN(c))){"undefined"!==typeof Z.MessageDisplay.messageTimer&&null!==Z.MessageDisplay.messageTimer&&window.clearTimeout(Z.MessageDisplay.messageTimer);if("undefined"===typeof c||null===c)c=3E3;Z.MessageDisplay.messageTimer=window.setTimeout(Z.Utils.hideMessageTimerHandler,c)}}},getMessage:function(){var a="";Z.messages&&Z.Utils.stringValidate(Z.messages.value)&&(a=Z.messages.value);return a},hideMessage:function(){Z.MessageDisplay&&(Z.MessageDisplay.style.display=
"none")},hideMessageTimerHandler:function(){Z.MessageDisplay.messageTimer&&(window.clearTimeout(Z.MessageDisplay.messageTimer),Z.MessageDisplay.messageTimer=null);Z.Utils.hideMessage()},uploadProgress:function(a){var b=Z.saveImageMessage;a.lengthComputable?(a=Math.round(100*a.loaded/a.total),b+=a.toString()+"%"):b+=Z.Utils.getResource("ERROR_IMAGESAVEUNABLETOCOMPUTEPROGRESS");Z.Utils.showMessage(b,!1,"none","center")},trace:function(a,b,c){b=b?"\n":"";c=c?"\n\n":"\n";Z.TraceDisplay||Z.Utils.configureTraceDisplay();
Z.traces&&(Z.traces.value+=b+a+c,2==Z.debug&&(Z.traces.scrollTop=Z.traces.scrollHeight))},traceTileStatus:function(a,b,c,d,e,f){if(!(m&&u&&t&&B&&C&&x))var m=document.getElementById("tilesRequiredTextElement"),u=document.getElementById("tilesCachedTextElement"),t=document.getElementById("tilesRequestedTextElement"),B=document.getElementById("tilesLoadedTextElement"),C=document.getElementById("tilesDisplayedTextElement"),x=document.getElementById("tilesWaitingTextElement");m&&u&&t&&B&&C&&x&&("undefined"!==
typeof a&&null!==a&&(m.value=a.toString()),"undefined"!==typeof b&&null!==b&&(u.value=b.toString()),"undefined"!==typeof c&&null!==c&&(t.value=c.toString()),"undefined"!==typeof d&&null!==d&&(B.value=d.toString()),"undefined"!==typeof e&&null!==e&&(C.value=e.toString()),"undefined"!==typeof f&&null!==f&&(x.value=f.toString()))},traceTileSpeed:function(a,b){if(!c||!d)var c=document.getElementById("tilesTimeElapsedTextElement"),d=document.getElementById("tilesPerSecondTextElement");c&&d&&("undefined"!==
typeof a&&null!==a&&(c.value=a.toString()),"undefined"!==typeof b&&null!==b&&(d.value=Math.round(b).toString()))}};
